var Box2D={};
(function(b,c){function a(){}!(Object.prototype.defineProperty instanceof Function)&&(Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function)&&(Object.defineProperty=function(a,b,c){c.get instanceof Function&&a.__defineGetter__(b,c.get);c.set instanceof Function&&a.__defineSetter__(b,c.set)});b.inherit=function(b,c){a.prototype=c.prototype;b.prototype=new a;b.prototype.constructor=b};b.generateCallback=function(a,b){return function(){b.apply(a,arguments)}};
b.NVector=function(a){a===c&&(a=0);for(var b=Array(a||0),d=0;d<a;++d)b[d]=0;return b};b.is=function(a,b){return null===a?!1:b instanceof Function&&a instanceof b||a.constructor.__implements!=c&&a.constructor.__implements[b]?!0:!1};b.parseUInt=function(a){return Math.abs(parseInt(a))}})(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;"undefined"===typeof Box2D&&(Box2D={});"undefined"===typeof Box2D.Collision&&(Box2D.Collision={});
"undefined"===typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={});"undefined"===typeof Box2D.Common&&(Box2D.Common={});"undefined"===typeof Box2D.Common.Math&&(Box2D.Common.Math={});"undefined"===typeof Box2D.Dynamics&&(Box2D.Dynamics={});"undefined"===typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={});"undefined"===typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={});"undefined"===typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={});
(function(){function b(){b.b2AABB.apply(this,arguments)}function c(){c.b2Bound.apply(this,arguments)}function a(){a.b2BoundValues.apply(this,arguments);this.constructor===a&&this.b2BoundValues.apply(this,arguments)}function f(){f.b2Collision.apply(this,arguments)}function e(){e.b2ContactID.apply(this,arguments);this.constructor===e&&this.b2ContactID.apply(this,arguments)}function d(){d.b2ContactPoint.apply(this,arguments)}function g(){g.b2Distance.apply(this,arguments)}function h(){h.b2DistanceInput.apply(this,
arguments)}function k(){k.b2DistanceOutput.apply(this,arguments)}function l(){l.b2DistanceProxy.apply(this,arguments)}function r(){r.b2DynamicTree.apply(this,arguments);this.constructor===r&&this.b2DynamicTree.apply(this,arguments)}function s(){s.b2DynamicTreeBroadPhase.apply(this,arguments)}function x(){x.b2DynamicTreeNode.apply(this,arguments)}function v(){v.b2DynamicTreePair.apply(this,arguments)}function w(){w.b2Manifold.apply(this,arguments);this.constructor===w&&this.b2Manifold.apply(this,arguments)}
function F(){F.b2ManifoldPoint.apply(this,arguments);this.constructor===F&&this.b2ManifoldPoint.apply(this,arguments)}function m(){m.b2Point.apply(this,arguments)}function E(){E.b2RayCastInput.apply(this,arguments);this.constructor===E&&this.b2RayCastInput.apply(this,arguments)}function A(){A.b2RayCastOutput.apply(this,arguments)}function z(){z.b2Segment.apply(this,arguments)}function D(){D.b2SeparationFunction.apply(this,arguments)}function H(){H.b2Simplex.apply(this,arguments);this.constructor===
H&&this.b2Simplex.apply(this,arguments)}function C(){C.b2SimplexCache.apply(this,arguments)}function M(){M.b2SimplexVertex.apply(this,arguments)}function G(){G.b2TimeOfImpact.apply(this,arguments)}function I(){I.b2TOIInput.apply(this,arguments)}function N(){N.b2WorldManifold.apply(this,arguments);this.constructor===N&&this.b2WorldManifold.apply(this,arguments)}function L(){L.ClipVertex.apply(this,arguments)}function q(){q.Features.apply(this,arguments)}function t(){t.b2CircleShape.apply(this,arguments);
this.constructor===t&&this.b2CircleShape.apply(this,arguments)}function B(){B.b2EdgeChainDef.apply(this,arguments);this.constructor===B&&this.b2EdgeChainDef.apply(this,arguments)}function y(){y.b2EdgeShape.apply(this,arguments);this.constructor===y&&this.b2EdgeShape.apply(this,arguments)}function K(){K.b2MassData.apply(this,arguments)}function P(){P.b2PolygonShape.apply(this,arguments);this.constructor===P&&this.b2PolygonShape.apply(this,arguments)}function O(){O.b2Shape.apply(this,arguments);this.constructor===
O&&this.b2Shape.apply(this,arguments)}function u(){u.b2Color.apply(this,arguments);this.constructor===u&&this.b2Color.apply(this,arguments)}function p(){p.b2Settings.apply(this,arguments)}function J(){J.b2Mat22.apply(this,arguments);this.constructor===J&&this.b2Mat22.apply(this,arguments)}function Q(){Q.b2Mat33.apply(this,arguments);this.constructor===Q&&this.b2Mat33.apply(this,arguments)}function Ba(){Ba.b2Math.apply(this,arguments)}function Ca(){Ca.b2Sweep.apply(this,arguments)}function R(){R.b2Transform.apply(this,
arguments);this.constructor===R&&this.b2Transform.apply(this,arguments)}function S(){S.b2Vec2.apply(this,arguments);this.constructor===S&&this.b2Vec2.apply(this,arguments)}function T(){T.b2Vec3.apply(this,arguments);this.constructor===T&&this.b2Vec3.apply(this,arguments)}function U(){U.b2Body.apply(this,arguments);this.constructor===U&&this.b2Body.apply(this,arguments)}function V(){V.b2BodyDef.apply(this,arguments);this.constructor===V&&this.b2BodyDef.apply(this,arguments)}function Da(){Da.b2ContactFilter.apply(this,
arguments)}function Ea(){Ea.b2ContactImpulse.apply(this,arguments)}function Fa(){Fa.b2ContactListener.apply(this,arguments)}function W(){W.b2ContactManager.apply(this,arguments);this.constructor===W&&this.b2ContactManager.apply(this,arguments)}function X(){X.b2DebugDraw.apply(this,arguments);this.constructor===X&&this.b2DebugDraw.apply(this,arguments)}function Ga(){Ga.b2DestructionListener.apply(this,arguments)}function Ha(){Ha.b2FilterData.apply(this,arguments)}function Y(){Y.b2Fixture.apply(this,
arguments);this.constructor===Y&&this.b2Fixture.apply(this,arguments)}function Z(){Z.b2FixtureDef.apply(this,arguments);this.constructor===Z&&this.b2FixtureDef.apply(this,arguments)}function $(){$.b2Island.apply(this,arguments);this.constructor===$&&this.b2Island.apply(this,arguments)}function Ia(){Ia.b2TimeStep.apply(this,arguments)}function aa(){aa.b2World.apply(this,arguments);this.constructor===aa&&this.b2World.apply(this,arguments)}function Ja(){Ja.b2CircleContact.apply(this,arguments)}function ba(){ba.b2Contact.apply(this,
arguments);this.constructor===ba&&this.b2Contact.apply(this,arguments)}function ca(){ca.b2ContactConstraint.apply(this,arguments);this.constructor===ca&&this.b2ContactConstraint.apply(this,arguments)}function Ka(){Ka.b2ContactConstraintPoint.apply(this,arguments)}function La(){La.b2ContactEdge.apply(this,arguments)}function da(){da.b2ContactFactory.apply(this,arguments);this.constructor===da&&this.b2ContactFactory.apply(this,arguments)}function Ma(){Ma.b2ContactRegister.apply(this,arguments)}function Na(){Na.b2ContactResult.apply(this,
arguments)}function ea(){ea.b2ContactSolver.apply(this,arguments);this.constructor===ea&&this.b2ContactSolver.apply(this,arguments)}function Oa(){Oa.b2EdgeAndCircleContact.apply(this,arguments)}function fa(){fa.b2NullContact.apply(this,arguments);this.constructor===fa&&this.b2NullContact.apply(this,arguments)}function Pa(){Pa.b2PolyAndCircleContact.apply(this,arguments)}function Qa(){Qa.b2PolyAndEdgeContact.apply(this,arguments)}function Ra(){Ra.b2PolygonContact.apply(this,arguments)}function ga(){ga.b2PositionSolverManifold.apply(this,
arguments);this.constructor===ga&&this.b2PositionSolverManifold.apply(this,arguments)}function Sa(){Sa.b2BuoyancyController.apply(this,arguments)}function Ta(){Ta.b2ConstantAccelController.apply(this,arguments)}function Ua(){Ua.b2ConstantForceController.apply(this,arguments)}function Va(){Va.b2Controller.apply(this,arguments)}function Wa(){Wa.b2ControllerEdge.apply(this,arguments)}function Xa(){Xa.b2GravityController.apply(this,arguments)}function Ya(){Ya.b2TensorDampingController.apply(this,arguments)}
function ha(){ha.b2DistanceJoint.apply(this,arguments);this.constructor===ha&&this.b2DistanceJoint.apply(this,arguments)}function ia(){ia.b2DistanceJointDef.apply(this,arguments);this.constructor===ia&&this.b2DistanceJointDef.apply(this,arguments)}function ja(){ja.b2FrictionJoint.apply(this,arguments);this.constructor===ja&&this.b2FrictionJoint.apply(this,arguments)}function ka(){ka.b2FrictionJointDef.apply(this,arguments);this.constructor===ka&&this.b2FrictionJointDef.apply(this,arguments)}function la(){la.b2GearJoint.apply(this,
arguments);this.constructor===la&&this.b2GearJoint.apply(this,arguments)}function ma(){ma.b2GearJointDef.apply(this,arguments);this.constructor===ma&&this.b2GearJointDef.apply(this,arguments)}function Za(){Za.b2Jacobian.apply(this,arguments)}function na(){na.b2Joint.apply(this,arguments);this.constructor===na&&this.b2Joint.apply(this,arguments)}function oa(){oa.b2JointDef.apply(this,arguments);this.constructor===oa&&this.b2JointDef.apply(this,arguments)}function $a(){$a.b2JointEdge.apply(this,arguments)}
function pa(){pa.b2LineJoint.apply(this,arguments);this.constructor===pa&&this.b2LineJoint.apply(this,arguments)}function qa(){qa.b2LineJointDef.apply(this,arguments);this.constructor===qa&&this.b2LineJointDef.apply(this,arguments)}function ra(){ra.b2MouseJoint.apply(this,arguments);this.constructor===ra&&this.b2MouseJoint.apply(this,arguments)}function sa(){sa.b2MouseJointDef.apply(this,arguments);this.constructor===sa&&this.b2MouseJointDef.apply(this,arguments)}function ta(){ta.b2PrismaticJoint.apply(this,
arguments);this.constructor===ta&&this.b2PrismaticJoint.apply(this,arguments)}function ua(){ua.b2PrismaticJointDef.apply(this,arguments);this.constructor===ua&&this.b2PrismaticJointDef.apply(this,arguments)}function va(){va.b2PulleyJoint.apply(this,arguments);this.constructor===va&&this.b2PulleyJoint.apply(this,arguments)}function wa(){wa.b2PulleyJointDef.apply(this,arguments);this.constructor===wa&&this.b2PulleyJointDef.apply(this,arguments)}function xa(){xa.b2RevoluteJoint.apply(this,arguments);
this.constructor===xa&&this.b2RevoluteJoint.apply(this,arguments)}function ya(){ya.b2RevoluteJointDef.apply(this,arguments);this.constructor===ya&&this.b2RevoluteJointDef.apply(this,arguments)}function za(){za.b2WeldJoint.apply(this,arguments);this.constructor===za&&this.b2WeldJoint.apply(this,arguments)}function Aa(){Aa.b2WeldJointDef.apply(this,arguments);this.constructor===Aa&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";Box2D.Collision.b2AABB=
b;Box2D.Collision.b2Bound=c;Box2D.Collision.b2BoundValues=a;Box2D.Collision.b2Collision=f;Box2D.Collision.b2ContactID=e;Box2D.Collision.b2ContactPoint=d;Box2D.Collision.b2Distance=g;Box2D.Collision.b2DistanceInput=h;Box2D.Collision.b2DistanceOutput=k;Box2D.Collision.b2DistanceProxy=l;Box2D.Collision.b2DynamicTree=r;Box2D.Collision.b2DynamicTreeBroadPhase=s;Box2D.Collision.b2DynamicTreeNode=x;Box2D.Collision.b2DynamicTreePair=v;Box2D.Collision.b2Manifold=w;Box2D.Collision.b2ManifoldPoint=F;Box2D.Collision.b2Point=
m;Box2D.Collision.b2RayCastInput=E;Box2D.Collision.b2RayCastOutput=A;Box2D.Collision.b2Segment=z;Box2D.Collision.b2SeparationFunction=D;Box2D.Collision.b2Simplex=H;Box2D.Collision.b2SimplexCache=C;Box2D.Collision.b2SimplexVertex=M;Box2D.Collision.b2TimeOfImpact=G;Box2D.Collision.b2TOIInput=I;Box2D.Collision.b2WorldManifold=N;Box2D.Collision.ClipVertex=L;Box2D.Collision.Features=q;Box2D.Collision.Shapes.b2CircleShape=t;Box2D.Collision.Shapes.b2EdgeChainDef=B;Box2D.Collision.Shapes.b2EdgeShape=y;Box2D.Collision.Shapes.b2MassData=
K;Box2D.Collision.Shapes.b2PolygonShape=P;Box2D.Collision.Shapes.b2Shape=O;Box2D.Common.b2internal="Box2D.Common.b2internal";Box2D.Common.b2Color=u;Box2D.Common.b2Settings=p;Box2D.Common.Math.b2Mat22=J;Box2D.Common.Math.b2Mat33=Q;Box2D.Common.Math.b2Math=Ba;Box2D.Common.Math.b2Sweep=Ca;Box2D.Common.Math.b2Transform=R;Box2D.Common.Math.b2Vec2=S;Box2D.Common.Math.b2Vec3=T;Box2D.Dynamics.b2Body=U;Box2D.Dynamics.b2BodyDef=V;Box2D.Dynamics.b2ContactFilter=Da;Box2D.Dynamics.b2ContactImpulse=Ea;Box2D.Dynamics.b2ContactListener=
Fa;Box2D.Dynamics.b2ContactManager=W;Box2D.Dynamics.b2DebugDraw=X;Box2D.Dynamics.b2DestructionListener=Ga;Box2D.Dynamics.b2FilterData=Ha;Box2D.Dynamics.b2Fixture=Y;Box2D.Dynamics.b2FixtureDef=Z;Box2D.Dynamics.b2Island=$;Box2D.Dynamics.b2TimeStep=Ia;Box2D.Dynamics.b2World=aa;Box2D.Dynamics.Contacts.b2CircleContact=Ja;Box2D.Dynamics.Contacts.b2Contact=ba;Box2D.Dynamics.Contacts.b2ContactConstraint=ca;Box2D.Dynamics.Contacts.b2ContactConstraintPoint=Ka;Box2D.Dynamics.Contacts.b2ContactEdge=La;Box2D.Dynamics.Contacts.b2ContactFactory=
da;Box2D.Dynamics.Contacts.b2ContactRegister=Ma;Box2D.Dynamics.Contacts.b2ContactResult=Na;Box2D.Dynamics.Contacts.b2ContactSolver=ea;Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=Oa;Box2D.Dynamics.Contacts.b2NullContact=fa;Box2D.Dynamics.Contacts.b2PolyAndCircleContact=Pa;Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=Qa;Box2D.Dynamics.Contacts.b2PolygonContact=Ra;Box2D.Dynamics.Contacts.b2PositionSolverManifold=ga;Box2D.Dynamics.Controllers.b2BuoyancyController=Sa;Box2D.Dynamics.Controllers.b2ConstantAccelController=
Ta;Box2D.Dynamics.Controllers.b2ConstantForceController=Ua;Box2D.Dynamics.Controllers.b2Controller=Va;Box2D.Dynamics.Controllers.b2ControllerEdge=Wa;Box2D.Dynamics.Controllers.b2GravityController=Xa;Box2D.Dynamics.Controllers.b2TensorDampingController=Ya;Box2D.Dynamics.Joints.b2DistanceJoint=ha;Box2D.Dynamics.Joints.b2DistanceJointDef=ia;Box2D.Dynamics.Joints.b2FrictionJoint=ja;Box2D.Dynamics.Joints.b2FrictionJointDef=ka;Box2D.Dynamics.Joints.b2GearJoint=la;Box2D.Dynamics.Joints.b2GearJointDef=ma;
Box2D.Dynamics.Joints.b2Jacobian=Za;Box2D.Dynamics.Joints.b2Joint=na;Box2D.Dynamics.Joints.b2JointDef=oa;Box2D.Dynamics.Joints.b2JointEdge=$a;Box2D.Dynamics.Joints.b2LineJoint=pa;Box2D.Dynamics.Joints.b2LineJointDef=qa;Box2D.Dynamics.Joints.b2MouseJoint=ra;Box2D.Dynamics.Joints.b2MouseJointDef=sa;Box2D.Dynamics.Joints.b2PrismaticJoint=ta;Box2D.Dynamics.Joints.b2PrismaticJointDef=ua;Box2D.Dynamics.Joints.b2PulleyJoint=va;Box2D.Dynamics.Joints.b2PulleyJointDef=wa;Box2D.Dynamics.Joints.b2RevoluteJoint=
xa;Box2D.Dynamics.Joints.b2RevoluteJointDef=ya;Box2D.Dynamics.Joints.b2WeldJoint=za;Box2D.Dynamics.Joints.b2WeldJointDef=Aa})();Box2D.postDefs=[];
(function(){var b=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Collision.Shapes.b2PolygonShape,a=Box2D.Collision.Shapes.b2Shape,f=Box2D.Common.b2Settings,e=Box2D.Common.Math.b2Math,d=Box2D.Common.Math.b2Sweep,g=Box2D.Common.Math.b2Transform,h=Box2D.Common.Math.b2Vec2,k=Box2D.Collision.b2AABB,l=Box2D.Collision.b2Bound,r=Box2D.Collision.b2BoundValues,s=Box2D.Collision.b2Collision,x=Box2D.Collision.b2ContactID,v=Box2D.Collision.b2ContactPoint,w=Box2D.Collision.b2Distance,F=Box2D.Collision.b2DistanceInput,
m=Box2D.Collision.b2DistanceOutput,E=Box2D.Collision.b2DistanceProxy,A=Box2D.Collision.b2DynamicTree,z=Box2D.Collision.b2DynamicTreeBroadPhase,D=Box2D.Collision.b2DynamicTreeNode,H=Box2D.Collision.b2DynamicTreePair,C=Box2D.Collision.b2Manifold,M=Box2D.Collision.b2ManifoldPoint,G=Box2D.Collision.b2Point,I=Box2D.Collision.b2RayCastInput,N=Box2D.Collision.b2RayCastOutput,L=Box2D.Collision.b2Segment,q=Box2D.Collision.b2SeparationFunction,t=Box2D.Collision.b2Simplex,B=Box2D.Collision.b2SimplexCache,y=
Box2D.Collision.b2SimplexVertex,K=Box2D.Collision.b2TimeOfImpact,P=Box2D.Collision.b2TOIInput,O=Box2D.Collision.b2WorldManifold,u=Box2D.Collision.ClipVertex,p=Box2D.Collision.Features,J=Box2D.Collision.IBroadPhase;k.b2AABB=function(){this.lowerBound=new h;this.upperBound=new h};k.prototype.IsValid=function(){var a=this.upperBound.y-this.lowerBound.y;return 0<=this.upperBound.x-this.lowerBound.x&&0<=a&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};k.prototype.GetCenter=function(){return new h((this.lowerBound.x+
this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)};k.prototype.GetExtents=function(){return new h((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)};k.prototype.Contains=function(a){return this.lowerBound.x<=a.lowerBound.x&&this.lowerBound.y<=a.lowerBound.y&&a.upperBound.x<=this.upperBound.x&&a.upperBound.y<=this.upperBound.y};k.prototype.RayCast=function(a,b){var c=-Number.MAX_VALUE,f=Number.MAX_VALUE,e=b.p1.x,u=b.p1.y,d=b.p2.x-b.p1.x,q=b.p2.y-b.p1.y,p=
Math.abs(q),h=a.normal,t=0,y=0,g=0;if(Math.abs(d)<Number.MIN_VALUE){if(e<this.lowerBound.x||this.upperBound.x<e)return!1}else if(t=1/d,y=(this.lowerBound.x-e)*t,t*=this.upperBound.x-e,g=-1,y>t&&(g=y,y=t,t=g,g=1),y>c&&(h.x=g,h.y=0,c=y),f=Math.min(f,t),c>f)return!1;if(p<Number.MIN_VALUE){if(u<this.lowerBound.y||this.upperBound.y<u)return!1}else if(t=1/q,y=(this.lowerBound.y-u)*t,t*=this.upperBound.y-u,g=-1,y>t&&(g=y,y=t,t=g,g=1),y>c&&(h.y=g,h.x=0,c=y),f=Math.min(f,t),c>f)return!1;a.fraction=c;return!0};
k.prototype.TestOverlap=function(a){var b=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||0<b||0<this.lowerBound.x-a.upperBound.x||0<c?!1:!0};k.Combine=function(a,b){var c=new k;c.Combine(a,b);return c};k.prototype.Combine=function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=Math.max(a.upperBound.x,b.upperBound.x);this.upperBound.y=Math.max(a.upperBound.y,
b.upperBound.y)};l.b2Bound=function(){};l.prototype.IsLower=function(){return 0==(this.value&1)};l.prototype.IsUpper=function(){return 1==(this.value&1)};l.prototype.Swap=function(a){var b=this.value,c=this.proxy,f=this.stabbingCount;this.value=a.value;this.proxy=a.proxy;this.stabbingCount=a.stabbingCount;a.value=b;a.proxy=c;a.stabbingCount=f};r.b2BoundValues=function(){};r.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number;this.lowerValues[0]=0;this.lowerValues[1]=0;this.upperValues=
new Vector_a2j_Number;this.upperValues[0]=0;this.upperValues[1]=0};s.b2Collision=function(){};s.ClipSegmentToLine=function(a,b,c,f){void 0===f&&(f=0);var e,u=0;e=b[0];var d=e.v;e=b[1];var q=e.v,p=c.x*d.x+c.y*d.y-f;e=c.x*q.x+c.y*q.y-f;0>=p&&a[u++].Set(b[0]);0>=e&&a[u++].Set(b[1]);0>p*e&&(c=p/(p-e),e=a[u],e=e.v,e.x=d.x+c*(q.x-d.x),e.y=d.y+c*(q.y-d.y),e=a[u],e.id=(0<p?b[0]:b[1]).id,++u);return u};s.EdgeSeparation=function(a,b,c,f,e){void 0===c&&(c=0);parseInt(a.m_vertexCount);var u=a.m_vertices;a=a.m_normals;
var d=parseInt(f.m_vertexCount),q=f.m_vertices,p,h;p=b.R;h=a[c];a=p.col1.x*h.x+p.col2.x*h.y;f=p.col1.y*h.x+p.col2.y*h.y;p=e.R;var t=p.col1.x*a+p.col1.y*f;p=p.col2.x*a+p.col2.y*f;for(var y=0,g=Number.MAX_VALUE,J=0;J<d;++J)h=q[J],h=h.x*t+h.y*p,h<g&&(g=h,y=J);h=u[c];p=b.R;c=b.position.x+(p.col1.x*h.x+p.col2.x*h.y);b=b.position.y+(p.col1.y*h.x+p.col2.y*h.y);h=q[y];p=e.R;u=e.position.x+(p.col1.x*h.x+p.col2.x*h.y);e=e.position.y+(p.col1.y*h.x+p.col2.y*h.y);return(u-c)*a+(e-b)*f};s.FindMaxSeparation=function(a,
b,c,f,e){var u=parseInt(b.m_vertexCount),d=b.m_normals,p,q;q=e.R;p=f.m_centroid;var h=e.position.x+(q.col1.x*p.x+q.col2.x*p.y),t=e.position.y+(q.col1.y*p.x+q.col2.y*p.y);q=c.R;p=b.m_centroid;h-=c.position.x+(q.col1.x*p.x+q.col2.x*p.y);t-=c.position.y+(q.col1.y*p.x+q.col2.y*p.y);q=h*c.R.col1.x+t*c.R.col1.y;for(var t=h*c.R.col2.x+t*c.R.col2.y,h=0,y=-Number.MAX_VALUE,g=0;g<u;++g)p=d[g],p=p.x*q+p.y*t,p>y&&(y=p,h=g);d=s.EdgeSeparation(b,c,h,f,e);p=parseInt(0<=h-1?h-1:u-1);q=s.EdgeSeparation(b,c,p,f,e);
var t=parseInt(h+1<u?h+1:0),y=s.EdgeSeparation(b,c,t,f,e),J=0,m=0;if(q>d&&q>y)m=-1,g=p,J=q;else if(y>d)m=1,g=t,J=y;else return a[0]=h,d;for(;;)if(h=-1==m?0<=g-1?g-1:u-1:g+1<u?g+1:0,d=s.EdgeSeparation(b,c,h,f,e),d>J)g=h,J=d;else break;a[0]=g;return J};s.FindIncidentEdge=function(a,b,c,f,e,u){void 0===f&&(f=0);parseInt(b.m_vertexCount);var d=b.m_normals,p=parseInt(e.m_vertexCount);b=e.m_vertices;e=e.m_normals;var q;q=c.R;c=d[f];var d=q.col1.x*c.x+q.col2.x*c.y,h=q.col1.y*c.x+q.col2.y*c.y;q=u.R;c=q.col1.x*
d+q.col1.y*h;h=q.col2.x*d+q.col2.y*h;d=c;q=0;for(var t=Number.MAX_VALUE,y=0;y<p;++y)c=e[y],c=d*c.x+h*c.y,c<t&&(t=c,q=y);e=parseInt(q);d=parseInt(e+1<p?e+1:0);p=a[0];c=b[e];q=u.R;p.v.x=u.position.x+(q.col1.x*c.x+q.col2.x*c.y);p.v.y=u.position.y+(q.col1.y*c.x+q.col2.y*c.y);p.id.features.referenceEdge=f;p.id.features.incidentEdge=e;p.id.features.incidentVertex=0;p=a[1];c=b[d];q=u.R;p.v.x=u.position.x+(q.col1.x*c.x+q.col2.x*c.y);p.v.y=u.position.y+(q.col1.y*c.x+q.col2.y*c.y);p.id.features.referenceEdge=
f;p.id.features.incidentEdge=d;p.id.features.incidentVertex=1};s.MakeClipPointVector=function(){var a=new Vector(2);a[0]=new u;a[1]=new u;return a};s.CollidePolygons=function(a,c,b,e,u){var d;a.m_pointCount=0;var p=c.m_radius+e.m_radius;s.s_edgeAO[0]=0;var q=s.FindMaxSeparation(s.s_edgeAO,c,b,e,u);d=s.s_edgeAO[0];if(!(q>p)){var h;s.s_edgeBO[0]=0;var t=s.FindMaxSeparation(s.s_edgeBO,e,u,c,b);h=s.s_edgeBO[0];if(!(t>p)){var y=0,g=0;t>0.98*q+0.001?(q=e,e=c,c=u,y=h,a.m_type=C.e_faceB,g=1):(q=c,c=b,b=u,
y=d,a.m_type=C.e_faceA,g=0);d=s.s_incidentEdge;s.FindIncidentEdge(d,q,c,y,e,b);h=parseInt(q.m_vertexCount);u=q.m_vertices;var q=u[y],J;J=y+1<h?u[parseInt(y+1)]:u[0];y=s.s_localTangent;y.Set(J.x-q.x,J.y-q.y);y.Normalize();u=s.s_localNormal;u.x=y.y;u.y=-y.x;e=s.s_planePoint;e.Set(0.5*(q.x+J.x),0.5*(q.y+J.y));t=s.s_tangent;h=c.R;t.x=h.col1.x*y.x+h.col2.x*y.y;t.y=h.col1.y*y.x+h.col2.y*y.y;var m=s.s_tangent2;m.x=-t.x;m.y=-t.y;y=s.s_normal;y.x=t.y;y.y=-t.x;var k=s.s_v11,B=s.s_v12;k.x=c.position.x+(h.col1.x*
q.x+h.col2.x*q.y);k.y=c.position.y+(h.col1.y*q.x+h.col2.y*q.y);B.x=c.position.x+(h.col1.x*J.x+h.col2.x*J.y);B.y=c.position.y+(h.col1.y*J.x+h.col2.y*J.y);c=y.x*k.x+y.y*k.y;h=t.x*B.x+t.y*B.y+p;J=s.s_clipPoints1;q=s.s_clipPoints2;B=s.ClipSegmentToLine(J,d,m,-t.x*k.x-t.y*k.y+p);if(!(2>B)&&(B=s.ClipSegmentToLine(q,J,t,h),!(2>B))){a.m_localPlaneNormal.SetV(u);a.m_localPoint.SetV(e);for(e=u=0;e<f.b2_maxManifoldPoints;++e)d=q[e],y.x*d.v.x+y.y*d.v.y-c<=p&&(t=a.m_points[u],h=b.R,m=d.v.x-b.position.x,k=d.v.y-
b.position.y,t.m_localPoint.x=m*h.col1.x+k*h.col1.y,t.m_localPoint.y=m*h.col2.x+k*h.col2.y,t.m_id.Set(d.id),t.m_id.features.flip=g,++u);a.m_pointCount=u}}}};s.CollideCircles=function(a,c,b,f,e){a.m_pointCount=0;var u,d;u=b.R;d=c.m_p;var q=b.position.x+(u.col1.x*d.x+u.col2.x*d.y);b=b.position.y+(u.col1.y*d.x+u.col2.y*d.y);u=e.R;d=f.m_p;q=e.position.x+(u.col1.x*d.x+u.col2.x*d.y)-q;e=e.position.y+(u.col1.y*d.x+u.col2.y*d.y)-b;u=c.m_radius+f.m_radius;q*q+e*e>u*u||(a.m_type=C.e_circles,a.m_localPoint.SetV(c.m_p),
a.m_localPlaneNormal.SetZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.SetV(f.m_p),a.m_points[0].m_id.key=0)};s.CollidePolygonAndCircle=function(a,c,b,f,e){var u=a.m_pointCount=0,d=0,q,p;p=e.R;q=f.m_p;var h=e.position.y+(p.col1.y*q.x+p.col2.y*q.y),u=e.position.x+(p.col1.x*q.x+p.col2.x*q.y)-b.position.x,d=h-b.position.y;p=b.R;b=u*p.col1.x+d*p.col1.y;p=u*p.col2.x+d*p.col2.y;var t=0,h=-Number.MAX_VALUE;e=c.m_radius+f.m_radius;var y=parseInt(c.m_vertexCount),g=c.m_vertices;c=c.m_normals;for(var J=
0;J<y;++J){q=g[J];u=b-q.x;d=p-q.y;q=c[J];u=q.x*u+q.y*d;if(u>e)return;u>h&&(h=u,t=J)}u=parseInt(t);d=parseInt(u+1<y?u+1:0);q=g[u];g=g[d];if(h<Number.MIN_VALUE)a.m_pointCount=1,a.m_type=C.e_faceA,a.m_localPlaneNormal.SetV(c[t]),a.m_localPoint.x=0.5*(q.x+g.x),a.m_localPoint.y=0.5*(q.y+g.y);else if(h=(b-g.x)*(q.x-g.x)+(p-g.y)*(q.y-g.y),0>=(b-q.x)*(g.x-q.x)+(p-q.y)*(g.y-q.y)){if((b-q.x)*(b-q.x)+(p-q.y)*(p-q.y)>e*e)return;a.m_pointCount=1;a.m_type=C.e_faceA;a.m_localPlaneNormal.x=b-q.x;a.m_localPlaneNormal.y=
p-q.y;a.m_localPlaneNormal.Normalize();a.m_localPoint.SetV(q)}else if(0>=h){if((b-g.x)*(b-g.x)+(p-g.y)*(p-g.y)>e*e)return;a.m_pointCount=1;a.m_type=C.e_faceA;a.m_localPlaneNormal.x=b-g.x;a.m_localPlaneNormal.y=p-g.y;a.m_localPlaneNormal.Normalize();a.m_localPoint.SetV(g)}else{t=0.5*(q.x+g.x);q=0.5*(q.y+g.y);h=(b-t)*c[u].x+(p-q)*c[u].y;if(h>e)return;a.m_pointCount=1;a.m_type=C.e_faceA;a.m_localPlaneNormal.x=c[u].x;a.m_localPlaneNormal.y=c[u].y;a.m_localPlaneNormal.Normalize();a.m_localPoint.Set(t,
q)}a.m_points[0].m_localPoint.SetV(f.m_p);a.m_points[0].m_id.key=0};s.TestOverlap=function(a,c){var b=c.lowerBound,f=a.upperBound,e=b.x-f.x,u=b.y-f.y,b=a.lowerBound,f=c.upperBound,q=b.y-f.y;return 0<e||0<u||0<b.x-f.x||0<q?!1:!0};Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=s.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints1=s.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints2=s.MakeClipPointVector();Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1);
Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_localTangent=new h;Box2D.Collision.b2Collision.s_localNormal=new h;Box2D.Collision.b2Collision.s_planePoint=new h;Box2D.Collision.b2Collision.s_normal=new h;Box2D.Collision.b2Collision.s_tangent=new h;Box2D.Collision.b2Collision.s_tangent2=new h;Box2D.Collision.b2Collision.s_v11=new h;Box2D.Collision.b2Collision.s_v12=new h;Box2D.Collision.b2Collision.b2CollidePolyTempVec=new h;Box2D.Collision.b2Collision.b2_nullFeature=
255});x.b2ContactID=function(){this.features=new p};x.prototype.b2ContactID=function(){this.features._m_id=this};x.prototype.Set=function(a){this.key=a._key};x.prototype.Copy=function(){var a=new x;a.key=this.key;return a};Object.defineProperty(x.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}});Object.defineProperty(x.prototype,"key",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._key=a;this.features._referenceEdge=this._key&255;this.features._incidentEdge=
(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&4278190080)>>24&255}});v.b2ContactPoint=function(){this.position=new h;this.velocity=new h;this.normal=new h;this.id=new x};w.b2Distance=function(){};w.Distance=function(a,c,b){++w.b2_gjkCalls;var u=b.proxyA,q=b.proxyB,d=b.transformA,p=b.transformB,t=w.s_simplex;t.ReadCache(c,u,d,q,p);var y=t.m_vertices,g=w.s_saveA,J=w.s_saveB,m=0;t.GetClosestPoint().LengthSquared();for(var k=0,B,O=0;20>
O;){m=t.m_count;for(k=0;k<m;k++)g[k]=y[k].indexA,J[k]=y[k].indexB;switch(t.m_count){case 1:break;case 2:t.Solve2();break;case 3:t.Solve3();break;default:f.b2Assert(!1)}if(3==t.m_count)break;B=t.GetClosestPoint();B.LengthSquared();k=t.GetSearchDirection();if(k.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;B=y[t.m_count];B.indexA=u.GetSupport(e.MulTMV(d.R,k.GetNegative()));B.wA=e.MulX(d,u.GetVertex(B.indexA));B.indexB=q.GetSupport(e.MulTMV(p.R,k));B.wB=e.MulX(p,q.GetVertex(B.indexB));B.w=
e.SubtractVV(B.wB,B.wA);++O;++w.b2_gjkIters;for(var K=!1,k=0;k<m;k++)if(B.indexA==g[k]&&B.indexB==J[k]){K=!0;break}if(K)break;++t.m_count}w.b2_gjkMaxIters=e.Max(w.b2_gjkMaxIters,O);t.GetWitnessPoints(a.pointA,a.pointB);a.distance=e.SubtractVV(a.pointA,a.pointB).Length();a.iterations=O;t.WriteCache(c);b.useRadii&&(c=u.m_radius,q=q.m_radius,a.distance>c+q&&a.distance>Number.MIN_VALUE?(a.distance-=c+q,b=e.SubtractVV(a.pointB,a.pointA),b.Normalize(),a.pointA.x+=c*b.x,a.pointA.y+=c*b.y,a.pointB.x-=q*b.x,
a.pointB.y-=q*b.y):(B=new h,B.x=0.5*(a.pointA.x+a.pointB.x),B.y=0.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=B.x,a.pointA.y=a.pointB.y=B.y,a.distance=0))};Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new t;Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3);Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)});F.b2DistanceInput=function(){};m.b2DistanceOutput=function(){this.pointA=new h;this.pointB=new h};E.b2DistanceProxy=function(){};E.prototype.Set=
function(e){switch(e.GetType()){case a.e_circleShape:e=e instanceof b?e:null;this.m_vertices=new Vector(1,!0);this.m_vertices[0]=e.m_p;this.m_count=1;this.m_radius=e.m_radius;break;case a.e_polygonShape:e=e instanceof c?e:null;this.m_vertices=e.m_vertices;this.m_count=e.m_vertexCount;this.m_radius=e.m_radius;break;default:f.b2Assert(!1)}};E.prototype.GetSupport=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,f=1;f<this.m_count;++f){var e=this.m_vertices[f].x*a.x+this.m_vertices[f].y*
a.y;e>c&&(b=f,c=e)}return b};E.prototype.GetSupportVertex=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,f=1;f<this.m_count;++f){var e=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;e>c&&(b=f,c=e)}return this.m_vertices[b]};E.prototype.GetVertexCount=function(){return this.m_count};E.prototype.GetVertex=function(a){void 0===a&&(a=0);f.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]};A.b2DynamicTree=function(){};A.prototype.b2DynamicTree=function(){this.m_freeList=
this.m_root=null;this.m_insertionCount=this.m_path=0};A.prototype.CreateProxy=function(a,b){var c=this.AllocateNode(),e=f.b2_aabbExtension,u=f.b2_aabbExtension;c.aabb.lowerBound.x=a.lowerBound.x-e;c.aabb.lowerBound.y=a.lowerBound.y-u;c.aabb.upperBound.x=a.upperBound.x+e;c.aabb.upperBound.y=a.upperBound.y+u;c.userData=b;this.InsertLeaf(c);return c};A.prototype.DestroyProxy=function(a){this.RemoveLeaf(a);this.FreeNode(a)};A.prototype.MoveProxy=function(a,c,b){f.b2Assert(a.IsLeaf());if(a.aabb.Contains(c))return!1;
this.RemoveLeaf(a);var e=f.b2_aabbExtension+f.b2_aabbMultiplier*(0<b.x?b.x:-b.x);b=f.b2_aabbExtension+f.b2_aabbMultiplier*(0<b.y?b.y:-b.y);a.aabb.lowerBound.x=c.lowerBound.x-e;a.aabb.lowerBound.y=c.lowerBound.y-b;a.aabb.upperBound.x=c.upperBound.x+e;a.aabb.upperBound.y=c.upperBound.y+b;this.InsertLeaf(a);return!0};A.prototype.Rebalance=function(a){void 0===a&&(a=0);if(null!=this.m_root)for(var c=0;c<a;c++){for(var b=this.m_root,f=0;!1==b.IsLeaf();)b=this.m_path>>f&1?b.child2:b.child1,f=f+1&31;++this.m_path;
this.RemoveLeaf(b);this.InsertLeaf(b)}};A.prototype.GetFatAABB=function(a){return a.aabb};A.prototype.GetUserData=function(a){return a.userData};A.prototype.Query=function(a,b){if(null!=this.m_root){var c=new Vector,f=0;for(c[f++]=this.m_root;0<f;){var e=c[--f];if(e.aabb.TestOverlap(b))if(e.IsLeaf()){if(!a(e))break}else c[f++]=e.child1,c[f++]=e.child2}}};A.prototype.RayCast=function(a,c){if(null!=this.m_root){var b=c.p1,f=c.p2,u=e.SubtractVV(b,f);u.Normalize();var u=e.CrossFV(1,u),q=e.AbsV(u),d=c.maxFraction,
p=new k,h=0,t=0,h=b.x+d*(f.x-b.x),t=b.y+d*(f.y-b.y);p.lowerBound.x=Math.min(b.x,h);p.lowerBound.y=Math.min(b.y,t);p.upperBound.x=Math.max(b.x,h);p.upperBound.y=Math.max(b.y,t);var y=new Vector,g=0;for(y[g++]=this.m_root;0<g;)if(d=y[--g],!1!=d.aabb.TestOverlap(p)&&(h=d.aabb.GetCenter(),t=d.aabb.GetExtents(),!(0<Math.abs(u.x*(b.x-h.x)+u.y*(b.y-h.y))-q.x*t.x-q.y*t.y)))if(d.IsLeaf()){h=new I;h.p1=c.p1;h.p2=c.p2;h.maxFraction=c.maxFraction;d=a(h,d);if(0==d)break;0<d&&(h=b.x+d*(f.x-b.x),t=b.y+d*(f.y-b.y),
p.lowerBound.x=Math.min(b.x,h),p.lowerBound.y=Math.min(b.y,t),p.upperBound.x=Math.max(b.x,h),p.upperBound.y=Math.max(b.y,t))}else y[g++]=d.child1,y[g++]=d.child2}};A.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a}return new D};A.prototype.FreeNode=function(a){a.parent=this.m_freeList;this.m_freeList=a};A.prototype.InsertLeaf=function(a){++this.m_insertionCount;if(null==this.m_root)this.m_root=
a,this.m_root.parent=null;else{var b=a.aabb.GetCenter(),c=this.m_root;if(!1==c.IsLeaf()){do var f=c.child1,c=c.child2,c=Math.abs((f.aabb.lowerBound.x+f.aabb.upperBound.x)/2-b.x)+Math.abs((f.aabb.lowerBound.y+f.aabb.upperBound.y)/2-b.y)<Math.abs((c.aabb.lowerBound.x+c.aabb.upperBound.x)/2-b.x)+Math.abs((c.aabb.lowerBound.y+c.aabb.upperBound.y)/2-b.y)?f:c;while(!1==c.IsLeaf())}b=c.parent;f=this.AllocateNode();f.parent=b;f.userData=null;f.aabb.Combine(a.aabb,c.aabb);if(b){c.parent.child1==c?b.child1=
f:b.child2=f;f.child1=c;f.child2=a;c.parent=f;a.parent=f;do{if(b.aabb.Contains(f.aabb))break;b.aabb.Combine(b.child1.aabb,b.child2.aabb);f=b;b=b.parent}while(b)}else f.child1=c,f.child2=a,c.parent=f,this.m_root=a.parent=f}};A.prototype.RemoveLeaf=function(a){if(a==this.m_root)this.m_root=null;else{var b=a.parent,c=b.parent;a=b.child1==a?b.child2:b.child1;if(c){c.child1==b?c.child1=a:c.child2=a;a.parent=c;for(this.FreeNode(b);c;){b=c.aabb;c.aabb=k.Combine(c.child1.aabb,c.child2.aabb);if(b.Contains(c.aabb))break;
c=c.parent}}else this.m_root=a,a.parent=null,this.FreeNode(b)}};z.b2DynamicTreeBroadPhase=function(){this.m_tree=new A;this.m_moveBuffer=new Vector;this.m_pairBuffer=new Vector;this.m_pairCount=0};z.prototype.CreateProxy=function(a,b){var c=this.m_tree.CreateProxy(a,b);++this.m_proxyCount;this.BufferMove(c);return c};z.prototype.DestroyProxy=function(a){this.UnBufferMove(a);--this.m_proxyCount;this.m_tree.DestroyProxy(a)};z.prototype.MoveProxy=function(a,b,c){this.m_tree.MoveProxy(a,b,c)&&this.BufferMove(a)};
z.prototype.TestOverlap=function(a,b){var c=this.m_tree.GetFatAABB(a),f=this.m_tree.GetFatAABB(b);return c.TestOverlap(f)};z.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a)};z.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a)};z.prototype.GetProxyCount=function(){return this.m_proxyCount};z.prototype.UpdatePairs=function(a){for(var b=this,c=b.m_pairCount=0,f,c=0;c<b.m_moveBuffer.length;++c){f=b.m_moveBuffer[c];var e=b.m_tree.GetFatAABB(f);b.m_tree.Query(function(a){if(a==
f)return!0;b.m_pairCount==b.m_pairBuffer.length&&(b.m_pairBuffer[b.m_pairCount]=new H);var c=b.m_pairBuffer[b.m_pairCount];c.proxyA=a<f?a:f;c.proxyB=a>=f?a:f;++b.m_pairCount;return!0},e)}for(c=b.m_moveBuffer.length=0;c<b.m_pairCount;){var e=b.m_pairBuffer[c],u=b.m_tree.GetUserData(e.proxyA),q=b.m_tree.GetUserData(e.proxyB);a(u,q);for(++c;c<b.m_pairCount;){u=b.m_pairBuffer[c];if(u.proxyA!=e.proxyA||u.proxyB!=e.proxyB)break;++c}}};z.prototype.Query=function(a,b){this.m_tree.Query(a,b)};z.prototype.RayCast=
function(a,b){this.m_tree.RayCast(a,b)};z.prototype.Validate=function(){};z.prototype.Rebalance=function(a){void 0===a&&(a=0);this.m_tree.Rebalance(a)};z.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a};z.prototype.UnBufferMove=function(a){this.m_moveBuffer.splice(parseInt(this.m_moveBuffer.indexOf(a)),1)};z.prototype.ComparePairs=function(){return 0};z.__implements={};z.__implements[J]=!0;D.b2DynamicTreeNode=function(){this.aabb=new k};D.prototype.IsLeaf=function(){return null==
this.child1};H.b2DynamicTreePair=function(){};C.b2Manifold=function(){this.m_pointCount=0};C.prototype.b2Manifold=function(){this.m_points=new Vector(f.b2_maxManifoldPoints);for(var a=0;a<f.b2_maxManifoldPoints;a++)this.m_points[a]=new M;this.m_localPlaneNormal=new h;this.m_localPoint=new h};C.prototype.Reset=function(){for(var a=0;a<f.b2_maxManifoldPoints;a++)(this.m_points[a]instanceof M?this.m_points[a]:null).Reset();this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();this.m_pointCount=
this.m_type=0};C.prototype.Set=function(a){this.m_pointCount=a.m_pointCount;for(var b=0;b<f.b2_maxManifoldPoints;b++)(this.m_points[b]instanceof M?this.m_points[b]:null).Set(a.m_points[b]);this.m_localPlaneNormal.SetV(a.m_localPlaneNormal);this.m_localPoint.SetV(a.m_localPoint);this.m_type=a.m_type};C.prototype.Copy=function(){var a=new C;a.Set(this);return a};Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1;Box2D.Collision.b2Manifold.e_faceA=2;Box2D.Collision.b2Manifold.e_faceB=
4});M.b2ManifoldPoint=function(){this.m_localPoint=new h;this.m_id=new x};M.prototype.b2ManifoldPoint=function(){this.Reset()};M.prototype.Reset=function(){this.m_localPoint.SetZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.key=0};M.prototype.Set=function(a){this.m_localPoint.SetV(a.m_localPoint);this.m_normalImpulse=a.m_normalImpulse;this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.Set(a.m_id)};G.b2Point=function(){this.p=new h};G.prototype.Support=function(){return this.p};G.prototype.GetFirstVertex=
function(){return this.p};I.b2RayCastInput=function(){this.p1=new h;this.p2=new h};I.prototype.b2RayCastInput=function(a,b,c){void 0===a&&(a=null);void 0===b&&(b=null);void 0===c&&(c=1);a&&this.p1.SetV(a);b&&this.p2.SetV(b);this.maxFraction=c};N.b2RayCastOutput=function(){this.normal=new h};L.b2Segment=function(){this.p1=new h;this.p2=new h};L.prototype.TestSegment=function(a,b,c,f){void 0===f&&(f=0);var e=c.p1,u=c.p2.x-e.x,q=c.p2.y-e.y;c=this.p2.y-this.p1.y;var d=-(this.p2.x-this.p1.x),p=100*Number.MIN_VALUE,
h=-(u*c+q*d);if(h>p){var t=e.x-this.p1.x,y=e.y-this.p1.y,e=t*c+y*d;if(0<=e&&e<=f*h&&(f=-u*y+q*t,-p*h<=f&&f<=h*(1+p)))return e/=h,f=Math.sqrt(c*c+d*d),a[0]=e,b.Set(c/f,d/f),!0}return!1};L.prototype.Extend=function(a){this.ExtendForward(a);this.ExtendBackward(a)};L.prototype.ExtendForward=function(a){var b=this.p2.x-this.p1.x,c=this.p2.y-this.p1.y;a=Math.min(0<b?(a.upperBound.x-this.p1.x)/b:0>b?(a.lowerBound.x-this.p1.x)/b:Number.POSITIVE_INFINITY,0<c?(a.upperBound.y-this.p1.y)/c:0>c?(a.lowerBound.y-
this.p1.y)/c:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+b*a;this.p2.y=this.p1.y+c*a};L.prototype.ExtendBackward=function(a){var b=-this.p2.x+this.p1.x,c=-this.p2.y+this.p1.y;a=Math.min(0<b?(a.upperBound.x-this.p2.x)/b:0>b?(a.lowerBound.x-this.p2.x)/b:Number.POSITIVE_INFINITY,0<c?(a.upperBound.y-this.p2.y)/c:0>c?(a.lowerBound.y-this.p2.y)/c:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+b*a;this.p1.y=this.p2.y+c*a};q.b2SeparationFunction=function(){this.m_localPoint=new h;this.m_axis=new h};q.prototype.Initialize=
function(a,b,c,u,d){this.m_proxyA=b;this.m_proxyB=u;var p=parseInt(a.count);f.b2Assert(0<p&&3>p);var t,y,g,J,k=0,B=0;1==p?(this.m_type=q.e_points,t=this.m_proxyA.GetVertex(a.indexA[0]),y=this.m_proxyB.GetVertex(a.indexB[0]),p=t,a=c.R,b=c.position.x+(a.col1.x*p.x+a.col2.x*p.y),u=c.position.y+(a.col1.y*p.x+a.col2.y*p.y),p=y,a=d.R,g=d.position.x+(a.col1.x*p.x+a.col2.x*p.y),J=d.position.y+(a.col1.y*p.x+a.col2.y*p.y),this.m_axis.x=g-b,this.m_axis.y=J-u,this.m_axis.Normalize()):(a.indexB[0]==a.indexB[1]?
(this.m_type=q.e_faceA,b=this.m_proxyA.GetVertex(a.indexA[0]),u=this.m_proxyA.GetVertex(a.indexA[1]),y=this.m_proxyB.GetVertex(a.indexB[0]),this.m_localPoint.x=0.5*(b.x+u.x),this.m_localPoint.y=0.5*(b.y+u.y),this.m_axis=e.CrossVF(e.SubtractVV(u,b),1),this.m_axis.Normalize(),p=this.m_axis,a=c.R,k=a.col1.x*p.x+a.col2.x*p.y,B=a.col1.y*p.x+a.col2.y*p.y,p=this.m_localPoint,a=c.R,b=c.position.x+(a.col1.x*p.x+a.col2.x*p.y),u=c.position.y+(a.col1.y*p.x+a.col2.y*p.y),p=y,a=d.R,g=d.position.x+(a.col1.x*p.x+
a.col2.x*p.y),J=d.position.y+(a.col1.y*p.x+a.col2.y*p.y),k=(g-b)*k+(J-u)*B):a.indexA[0]==a.indexA[0]?(this.m_type=q.e_faceB,g=this.m_proxyB.GetVertex(a.indexB[0]),J=this.m_proxyB.GetVertex(a.indexB[1]),t=this.m_proxyA.GetVertex(a.indexA[0]),this.m_localPoint.x=0.5*(g.x+J.x),this.m_localPoint.y=0.5*(g.y+J.y),this.m_axis=e.CrossVF(e.SubtractVV(J,g),1),this.m_axis.Normalize(),p=this.m_axis,a=d.R,k=a.col1.x*p.x+a.col2.x*p.y,B=a.col1.y*p.x+a.col2.y*p.y,p=this.m_localPoint,a=d.R,g=d.position.x+(a.col1.x*
p.x+a.col2.x*p.y),J=d.position.y+(a.col1.y*p.x+a.col2.y*p.y),p=t,a=c.R,b=c.position.x+(a.col1.x*p.x+a.col2.x*p.y),u=c.position.y+(a.col1.y*p.x+a.col2.y*p.y),k=(b-g)*k+(u-J)*B):(b=this.m_proxyA.GetVertex(a.indexA[0]),u=this.m_proxyA.GetVertex(a.indexA[1]),g=this.m_proxyB.GetVertex(a.indexB[0]),J=this.m_proxyB.GetVertex(a.indexB[1]),e.MulX(c,t),t=e.MulMV(c.R,e.SubtractVV(u,b)),e.MulX(d,y),k=e.MulMV(d.R,e.SubtractVV(J,g)),d=t.x*t.x+t.y*t.y,y=k.x*k.x+k.y*k.y,a=e.SubtractVV(k,t),c=t.x*a.x+t.y*a.y,a=k.x*
a.x+k.y*a.y,t=t.x*k.x+t.y*k.y,B=d*y-t*t,k=0,0!=B&&(k=e.Clamp((t*a-c*y)/B,0,1)),0>(t*k+a)/y&&(k=e.Clamp((t-c)/d,0,1)),t=new h,t.x=b.x+k*(u.x-b.x),t.y=b.y+k*(u.y-b.y),y=new h,y.x=g.x+k*(J.x-g.x),y.y=g.y+k*(J.y-g.y),0==k||1==k?(this.m_type=q.e_faceB,this.m_axis=e.CrossVF(e.SubtractVV(J,g),1),this.m_axis.Normalize(),this.m_localPoint=y):(this.m_type=q.e_faceA,this.m_axis=e.CrossVF(e.SubtractVV(u,b),1),this.m_localPoint=t)),0>k&&this.m_axis.NegativeSelf())};q.prototype.Evaluate=function(a,b){var c,u,p=
0;switch(this.m_type){case q.e_points:return c=e.MulTMV(a.R,this.m_axis),u=e.MulTMV(b.R,this.m_axis.GetNegative()),c=this.m_proxyA.GetSupportVertex(c),u=this.m_proxyB.GetSupportVertex(u),c=e.MulX(a,c),u=e.MulX(b,u),(u.x-c.x)*this.m_axis.x+(u.y-c.y)*this.m_axis.y;case q.e_faceA:return p=e.MulMV(a.R,this.m_axis),c=e.MulX(a,this.m_localPoint),u=e.MulTMV(b.R,p.GetNegative()),u=this.m_proxyB.GetSupportVertex(u),u=e.MulX(b,u),(u.x-c.x)*p.x+(u.y-c.y)*p.y;case q.e_faceB:return p=e.MulMV(b.R,this.m_axis),
u=e.MulX(b,this.m_localPoint),c=e.MulTMV(a.R,p.GetNegative()),c=this.m_proxyA.GetSupportVertex(c),c=e.MulX(a,c),(c.x-u.x)*p.x+(c.y-u.y)*p.y;default:return f.b2Assert(!1),0}};Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1;Box2D.Collision.b2SeparationFunction.e_faceA=2;Box2D.Collision.b2SeparationFunction.e_faceB=4});t.b2Simplex=function(){this.m_v1=new y;this.m_v2=new y;this.m_v3=new y;this.m_vertices=new Vector(3)};t.prototype.b2Simplex=function(){this.m_vertices[0]=
this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};t.prototype.ReadCache=function(a,b,c,u,p){f.b2Assert(0<=a.count&&3>=a.count);var d,q;this.m_count=a.count;for(var h=this.m_vertices,t=0;t<this.m_count;t++){var y=h[t];y.indexA=a.indexA[t];y.indexB=a.indexB[t];d=b.GetVertex(y.indexA);q=u.GetVertex(y.indexB);y.wA=e.MulX(c,d);y.wB=e.MulX(p,q);y.w=e.SubtractVV(y.wB,y.wA);y.a=0}if(1<this.m_count&&(a=a.metric,d=this.GetMetric(),d<0.5*a||2*a<d||d<Number.MIN_VALUE))this.m_count=0;0==this.m_count&&
(y=h[0],y.indexA=0,y.indexB=0,d=b.GetVertex(0),q=u.GetVertex(0),y.wA=e.MulX(c,d),y.wB=e.MulX(p,q),y.w=e.SubtractVV(y.wB,y.wA),this.m_count=1)};t.prototype.WriteCache=function(a){a.metric=this.GetMetric();a.count=Box2D.parseUInt(this.m_count);for(var b=this.m_vertices,c=0;c<this.m_count;c++)a.indexA[c]=Box2D.parseUInt(b[c].indexA),a.indexB[c]=Box2D.parseUInt(b[c].indexB)};t.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var a=e.SubtractVV(this.m_v2.w,
this.m_v1.w);return 0<e.CrossVV(a,this.m_v1.w.GetNegative())?e.CrossFV(1,a):e.CrossVF(a,1);default:return f.b2Assert(!1),new h}};t.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return f.b2Assert(!1),new h;case 1:return this.m_v1.w;case 2:return new h(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return f.b2Assert(!1),new h}};t.prototype.GetWitnessPoints=function(a,b){switch(this.m_count){case 0:f.b2Assert(!1);break;
case 1:a.SetV(this.m_v1.wA);b.SetV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:f.b2Assert(!1)}};
t.prototype.GetMetric=function(){switch(this.m_count){case 0:return f.b2Assert(!1),0;case 1:return 0;case 2:return e.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return e.CrossVV(e.SubtractVV(this.m_v2.w,this.m_v1.w),e.SubtractVV(this.m_v3.w,this.m_v1.w));default:return f.b2Assert(!1),0}};t.prototype.Solve2=function(){var a=this.m_v1.w,b=this.m_v2.w,c=e.SubtractVV(b,a),a=-(a.x*c.x+a.y*c.y);0>=a?this.m_count=this.m_v1.a=1:(b=b.x*c.x+b.y*c.y,0>=b?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):
(c=1/(b+a),this.m_v1.a=b*c,this.m_v2.a=a*c,this.m_count=2))};t.prototype.Solve3=function(){var a=this.m_v1.w,b=this.m_v2.w,c=this.m_v3.w,f=e.SubtractVV(b,a),u=e.Dot(a,f),p=e.Dot(b,f),u=-u,d=e.SubtractVV(c,a),q=e.Dot(a,d),h=e.Dot(c,d),q=-q,t=e.SubtractVV(c,b),y=e.Dot(b,t),t=e.Dot(c,t),y=-y,d=e.CrossVV(f,d),f=d*e.CrossVV(b,c),c=d*e.CrossVV(c,a),a=d*e.CrossVV(a,b);0>=u&&0>=q?this.m_count=this.m_v1.a=1:0<p&&0<u&&0>=a?(h=1/(p+u),this.m_v1.a=p*h,this.m_v2.a=u*h,this.m_count=2):0<h&&0<q&&0>=c?(p=1/(h+q),
this.m_v1.a=h*p,this.m_v3.a=q*p,this.m_count=2,this.m_v2.Set(this.m_v3)):0>=p&&0>=y?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):0>=h&&0>=t?(this.m_count=this.m_v3.a=1,this.m_v1.Set(this.m_v3)):0<t&&0<y&&0>=f?(p=1/(t+y),this.m_v2.a=t*p,this.m_v3.a=y*p,this.m_count=2,this.m_v1.Set(this.m_v3)):(p=1/(f+c+a),this.m_v1.a=f*p,this.m_v2.a=c*p,this.m_v3.a=a*p,this.m_count=3)};B.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3);this.indexB=new Vector_a2j_Number(3)};y.b2SimplexVertex=
function(){};y.prototype.Set=function(a){this.wA.SetV(a.wA);this.wB.SetV(a.wB);this.w.SetV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB};K.b2TimeOfImpact=function(){};K.TimeOfImpact=function(a){++K.b2_toiCalls;var b=a.proxyA,c=a.proxyB,u=a.sweepA,p=a.sweepB;f.b2Assert(u.t0==p.t0);f.b2Assert(1-u.t0>Number.MIN_VALUE);var d=b.m_radius+c.m_radius;a=a.tolerance;var q=0,h=0,t=0;K.s_cache.count=0;for(K.s_distanceInput.useRadii=!1;;){u.GetTransform(K.s_xfA,q);p.GetTransform(K.s_xfB,q);K.s_distanceInput.proxyA=
b;K.s_distanceInput.proxyB=c;K.s_distanceInput.transformA=K.s_xfA;K.s_distanceInput.transformB=K.s_xfB;w.Distance(K.s_distanceOutput,K.s_cache,K.s_distanceInput);if(0>=K.s_distanceOutput.distance){q=1;break}K.s_fcn.Initialize(K.s_cache,b,K.s_xfA,c,K.s_xfB);var y=K.s_fcn.Evaluate(K.s_xfA,K.s_xfB);if(0>=y){q=1;break}0==h&&(t=y>d?e.Max(d-a,0.75*d):e.Max(y-a,0.02*d));if(y-t<0.5*a){if(0==h){q=1;break}break}var g=q,J=q,k=1;u.GetTransform(K.s_xfA,k);p.GetTransform(K.s_xfB,k);var B=K.s_fcn.Evaluate(K.s_xfA,
K.s_xfB);if(B>=t){q=1;break}for(var m=0;;){var O=0,O=m&1?J+(t-y)*(k-J)/(B-y):0.5*(J+k);u.GetTransform(K.s_xfA,O);p.GetTransform(K.s_xfB,O);var P=K.s_fcn.Evaluate(K.s_xfA,K.s_xfB);if(e.Abs(P-t)<0.025*a){g=O;break}P>t?(J=O,y=P):(k=O,B=P);++m;++K.b2_toiRootIters;if(50==m)break}K.b2_toiMaxRootIters=e.Max(K.b2_toiMaxRootIters,m);if(g<(1+100*Number.MIN_VALUE)*q)break;q=g;h++;++K.b2_toiIters;if(1E3==h)break}K.b2_toiMaxIters=e.Max(K.b2_toiMaxIters,h);return q};Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=
0;Box2D.Collision.b2TimeOfImpact.b2_toiIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;Box2D.Collision.b2TimeOfImpact.s_cache=new B;Box2D.Collision.b2TimeOfImpact.s_distanceInput=new F;Box2D.Collision.b2TimeOfImpact.s_xfA=new g;Box2D.Collision.b2TimeOfImpact.s_xfB=new g;Box2D.Collision.b2TimeOfImpact.s_fcn=new q;Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new m});P.b2TOIInput=function(){this.proxyA=
new E;this.proxyB=new E;this.sweepA=new d;this.sweepB=new d};O.b2WorldManifold=function(){this.m_normal=new h};O.prototype.b2WorldManifold=function(){this.m_points=new Vector(f.b2_maxManifoldPoints);for(var a=0;a<f.b2_maxManifoldPoints;a++)this.m_points[a]=new h};O.prototype.Initialize=function(a,b,c,f,e){void 0===c&&(c=0);void 0===e&&(e=0);if(0!=a.m_pointCount){var u=0,p,d,q=0,h=0,t=0,y=0,g=0;switch(a.m_type){case C.e_circles:d=b.R;p=a.m_localPoint;u=b.position.x+d.col1.x*p.x+d.col2.x*p.y;b=b.position.y+
d.col1.y*p.x+d.col2.y*p.y;d=f.R;p=a.m_points[0].m_localPoint;a=f.position.x+d.col1.x*p.x+d.col2.x*p.y;f=f.position.y+d.col1.y*p.x+d.col2.y*p.y;p=a-u;d=f-b;q=p*p+d*d;q>Number.MIN_VALUE*Number.MIN_VALUE?(q=Math.sqrt(q),this.m_normal.x=p/q,this.m_normal.y=d/q):(this.m_normal.x=1,this.m_normal.y=0);p=b+c*this.m_normal.y;f-=e*this.m_normal.y;this.m_points[0].x=0.5*(u+c*this.m_normal.x+(a-e*this.m_normal.x));this.m_points[0].y=0.5*(p+f);break;case C.e_faceA:d=b.R;p=a.m_localPlaneNormal;q=d.col1.x*p.x+d.col2.x*
p.y;h=d.col1.y*p.x+d.col2.y*p.y;d=b.R;p=a.m_localPoint;t=b.position.x+d.col1.x*p.x+d.col2.x*p.y;y=b.position.y+d.col1.y*p.x+d.col2.y*p.y;this.m_normal.x=q;this.m_normal.y=h;for(u=0;u<a.m_pointCount;u++)d=f.R,p=a.m_points[u].m_localPoint,g=f.position.x+d.col1.x*p.x+d.col2.x*p.y,p=f.position.y+d.col1.y*p.x+d.col2.y*p.y,this.m_points[u].x=g+0.5*(c-(g-t)*q-(p-y)*h-e)*q,this.m_points[u].y=p+0.5*(c-(g-t)*q-(p-y)*h-e)*h;break;case C.e_faceB:d=f.R;p=a.m_localPlaneNormal;q=d.col1.x*p.x+d.col2.x*p.y;h=d.col1.y*
p.x+d.col2.y*p.y;d=f.R;p=a.m_localPoint;t=f.position.x+d.col1.x*p.x+d.col2.x*p.y;y=f.position.y+d.col1.y*p.x+d.col2.y*p.y;this.m_normal.x=-q;this.m_normal.y=-h;for(u=0;u<a.m_pointCount;u++)d=b.R,p=a.m_points[u].m_localPoint,g=b.position.x+d.col1.x*p.x+d.col2.x*p.y,p=b.position.y+d.col1.y*p.x+d.col2.y*p.y,this.m_points[u].x=g+0.5*(e-(g-t)*q-(p-y)*h-c)*q,this.m_points[u].y=p+0.5*(e-(g-t)*q-(p-y)*h-c)*h}}};u.ClipVertex=function(){this.v=new h;this.id=new x};u.prototype.Set=function(a){this.v.SetV(a.v);
this.id.Set(a.id)};p.Features=function(){};Object.defineProperty(p.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}});Object.defineProperty(p.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._referenceEdge=a;this._m_id._key=this._m_id._key&4294967040|this._referenceEdge&255}});Object.defineProperty(p.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}});Object.defineProperty(p.prototype,
"incidentEdge",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._incidentEdge=a;this._m_id._key=this._m_id._key&4294902015|this._incidentEdge<<8&65280}});Object.defineProperty(p.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}});Object.defineProperty(p.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._incidentVertex=a;this._m_id._key=this._m_id._key&4278255615|this._incidentVertex<<
16&16711680}});Object.defineProperty(p.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}});Object.defineProperty(p.prototype,"flip",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._flip=a;this._m_id._key=this._m_id._key&16777215|this._flip<<24&4278190080}})})();
(function(){var b=Box2D.Common.b2Settings,c=Box2D.Collision.Shapes.b2CircleShape,a=Box2D.Collision.Shapes.b2EdgeChainDef,f=Box2D.Collision.Shapes.b2EdgeShape,e=Box2D.Collision.Shapes.b2MassData,d=Box2D.Collision.Shapes.b2PolygonShape,g=Box2D.Collision.Shapes.b2Shape,h=Box2D.Common.Math.b2Mat22,k=Box2D.Common.Math.b2Math,l=Box2D.Common.Math.b2Transform,r=Box2D.Common.Math.b2Vec2,s=Box2D.Collision.b2Distance,x=Box2D.Collision.b2DistanceInput,v=Box2D.Collision.b2DistanceOutput,w=Box2D.Collision.b2DistanceProxy,
F=Box2D.Collision.b2SimplexCache;Box2D.inherit(c,Box2D.Collision.Shapes.b2Shape);c.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;c.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.m_p=new r};c.prototype.Copy=function(){var a=new c;a.Set(this);return a};c.prototype.Set=function(a){this.__super.Set.call(this,a);Box2D.is(a,c)&&this.m_p.SetV((a instanceof c?a:null).m_p)};c.prototype.TestPoint=function(a,b){var c=a.R,f=a.position.x+(c.col1.x*this.m_p.x+
c.col2.x*this.m_p.y),c=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y),f=b.x-f,c=b.y-c;return f*f+c*c<=this.m_radius*this.m_radius};c.prototype.RayCast=function(a,b,c){var f=c.R,e=b.p1.x-(c.position.x+(f.col1.x*this.m_p.x+f.col2.x*this.m_p.y));c=b.p1.y-(c.position.y+(f.col1.y*this.m_p.x+f.col2.y*this.m_p.y));var f=b.p2.x-b.p1.x,d=b.p2.y-b.p1.y,h=e*f+c*d,g=f*f+d*d,k=h*h-g*(e*e+c*c-this.m_radius*this.m_radius);if(0>k||g<Number.MIN_VALUE)return!1;h=-(h+Math.sqrt(k));return 0<=h&&h<=b.maxFraction*
g?(h/=g,a.fraction=h,a.normal.x=e+h*f,a.normal.y=c+h*d,a.normal.Normalize(),!0):!1};c.prototype.ComputeAABB=function(a,b){var c=b.R,f=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.Set(f-this.m_radius,c-this.m_radius);a.upperBound.Set(f+this.m_radius,c+this.m_radius)};c.prototype.ComputeMass=function(a,c){void 0===c&&(c=0);a.mass=c*b.b2_pi*this.m_radius*this.m_radius;a.center.SetV(this.m_p);a.I=a.mass*(0.5*this.m_radius*
this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))};c.prototype.ComputeSubmergedArea=function(a,c,b,f){void 0===c&&(c=0);b=k.MulX(b,this.m_p);var e=-(k.Dot(a,b)-c);if(e<-this.m_radius+Number.MIN_VALUE)return 0;if(e>this.m_radius)return f.SetV(b),Math.PI*this.m_radius*this.m_radius;c=this.m_radius*this.m_radius;var d=e*e,e=c*(Math.asin(e/this.m_radius)+Math.PI/2)+e*Math.sqrt(c-d);c=-2/3*Math.pow(c-d,1.5)/e;f.x=b.x+a.x*c;f.y=b.y+a.y*c;return e};c.prototype.GetLocalPosition=function(){return this.m_p};
c.prototype.SetLocalPosition=function(a){this.m_p.SetV(a)};c.prototype.GetRadius=function(){return this.m_radius};c.prototype.SetRadius=function(a){void 0===a&&(a=0);this.m_radius=a};c.prototype.b2CircleShape=function(a){void 0===a&&(a=0);this.__super.b2Shape.call(this);this.m_type=g.e_circleShape;this.m_radius=a};a.b2EdgeChainDef=function(){};a.prototype.b2EdgeChainDef=function(){this.vertexCount=0;this.isALoop=!0;this.vertices=[]};Box2D.inherit(f,Box2D.Collision.Shapes.b2Shape);f.prototype.__super=
Box2D.Collision.Shapes.b2Shape.prototype;f.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.s_supportVec=new r;this.m_v1=new r;this.m_v2=new r;this.m_coreV1=new r;this.m_coreV2=new r;this.m_normal=new r;this.m_direction=new r;this.m_cornerDir1=new r;this.m_cornerDir2=new r};f.prototype.TestPoint=function(){return!1};f.prototype.RayCast=function(a,c,b){var f,e=c.p2.x-c.p1.x,d=c.p2.y-c.p1.y;f=b.R;var h=b.position.x+(f.col1.x*this.m_v1.x+f.col2.x*this.m_v1.y),
g=b.position.y+(f.col1.y*this.m_v1.x+f.col2.y*this.m_v1.y),k=b.position.y+(f.col1.y*this.m_v2.x+f.col2.y*this.m_v2.y)-g;b=-(b.position.x+(f.col1.x*this.m_v2.x+f.col2.x*this.m_v2.y)-h);f=100*Number.MIN_VALUE;var l=-(e*k+d*b);if(l>f){var h=c.p1.x-h,s=c.p1.y-g,g=h*k+s*b;if(0<=g&&g<=c.maxFraction*l&&(c=-e*s+d*h,-f*l<=c&&c<=l*(1+f)))return a.fraction=g/l,c=Math.sqrt(k*k+b*b),a.normal.x=k/c,a.normal.y=b/c,!0}return!1};f.prototype.ComputeAABB=function(a,c){var b=c.R,f=c.position.x+(b.col1.x*this.m_v1.x+
b.col2.x*this.m_v1.y),e=c.position.y+(b.col1.y*this.m_v1.x+b.col2.y*this.m_v1.y),d=c.position.x+(b.col1.x*this.m_v2.x+b.col2.x*this.m_v2.y),b=c.position.y+(b.col1.y*this.m_v2.x+b.col2.y*this.m_v2.y);f<d?(a.lowerBound.x=f,a.upperBound.x=d):(a.lowerBound.x=d,a.upperBound.x=f);e<b?(a.lowerBound.y=e,a.upperBound.y=b):(a.lowerBound.y=b,a.upperBound.y=e)};f.prototype.ComputeMass=function(a){a.mass=0;a.center.SetV(this.m_v1);a.I=0};f.prototype.ComputeSubmergedArea=function(a,c,b,f){void 0===c&&(c=0);var e=
new r(a.x*c,a.y*c),d=k.MulX(b,this.m_v1);b=k.MulX(b,this.m_v2);var h=k.Dot(a,d)-c;a=k.Dot(a,b)-c;if(0<h){if(0<a)return 0;d.x=-a/(h-a)*d.x+h/(h-a)*b.x;d.y=-a/(h-a)*d.y+h/(h-a)*b.y}else 0<a&&(b.x=-a/(h-a)*d.x+h/(h-a)*b.x,b.y=-a/(h-a)*d.y+h/(h-a)*b.y);f.x=(e.x+d.x+b.x)/3;f.y=(e.y+d.y+b.y)/3;return 0.5*((d.x-e.x)*(b.y-e.y)-(d.y-e.y)*(b.x-e.x))};f.prototype.GetLength=function(){return this.m_length};f.prototype.GetVertex1=function(){return this.m_v1};f.prototype.GetVertex2=function(){return this.m_v2};
f.prototype.GetCoreVertex1=function(){return this.m_coreV1};f.prototype.GetCoreVertex2=function(){return this.m_coreV2};f.prototype.GetNormalVector=function(){return this.m_normal};f.prototype.GetDirectionVector=function(){return this.m_direction};f.prototype.GetCorner1Vector=function(){return this.m_cornerDir1};f.prototype.GetCorner2Vector=function(){return this.m_cornerDir2};f.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1};f.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2};
f.prototype.GetFirstVertex=function(a){var b=a.R;return new r(a.position.x+(b.col1.x*this.m_coreV1.x+b.col2.x*this.m_coreV1.y),a.position.y+(b.col1.y*this.m_coreV1.x+b.col2.y*this.m_coreV1.y))};f.prototype.GetNextEdge=function(){return this.m_nextEdge};f.prototype.GetPrevEdge=function(){return this.m_prevEdge};f.prototype.Support=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);var f=a.R,e=a.position.x+(f.col1.x*this.m_coreV1.x+f.col2.x*this.m_coreV1.y),d=a.position.y+(f.col1.y*this.m_coreV1.x+
f.col2.y*this.m_coreV1.y),h=a.position.x+(f.col1.x*this.m_coreV2.x+f.col2.x*this.m_coreV2.y);a=a.position.y+(f.col1.y*this.m_coreV2.x+f.col2.y*this.m_coreV2.y);e*b+d*c>h*b+a*c?(this.s_supportVec.x=e,this.s_supportVec.y=d):(this.s_supportVec.x=h,this.s_supportVec.y=a);return this.s_supportVec};f.prototype.b2EdgeShape=function(a,c){this.__super.b2Shape.call(this);this.m_type=g.e_edgeShape;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=a;this.m_v2=c;this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-
this.m_v1.y);this.m_length=this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.Set(-b.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-b.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y);this.m_coreV2.Set(-b.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-b.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)};f.prototype.SetPrevEdge=
function(a,b,c,f){this.m_prevEdge=a;this.m_coreV1=b;this.m_cornerDir1=c;this.m_cornerConvex1=f};f.prototype.SetNextEdge=function(a,b,c,f){this.m_nextEdge=a;this.m_coreV2=b;this.m_cornerDir2=c;this.m_cornerConvex2=f};e.b2MassData=function(){this.mass=0;this.center=new r(0,0);this.I=0};Box2D.inherit(d,Box2D.Collision.Shapes.b2Shape);d.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;d.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)};d.prototype.Copy=
function(){var a=new d;a.Set(this);return a};d.prototype.Set=function(a){this.__super.Set.call(this,a);if(Box2D.is(a,d)){a=a instanceof d?a:null;this.m_centroid.SetV(a.m_centroid);this.m_vertexCount=a.m_vertexCount;this.Reserve(this.m_vertexCount);for(var b=0;b<this.m_vertexCount;b++)this.m_vertices[b].SetV(a.m_vertices[b]),this.m_normals[b].SetV(a.m_normals[b])}};d.prototype.SetAsArray=function(a,b){void 0===b&&(b=0);for(var c=new Vector,f=0,e,f=0;f<a.length;++f)e=a[f],c.push(e);this.SetAsVector(c,
b)};d.AsArray=function(a,b){void 0===b&&(b=0);var c=new d;c.SetAsArray(a,b);return c};d.prototype.SetAsVector=function(a,c){void 0===c&&(c=0);0==c&&(c=a.length);b.b2Assert(2<=c);this.m_vertexCount=c;this.Reserve(c);for(var f=0,f=0;f<this.m_vertexCount;f++)this.m_vertices[f].SetV(a[f]);for(f=0;f<this.m_vertexCount;++f){var e=parseInt(f),h=parseInt(f+1<this.m_vertexCount?f+1:0),e=k.SubtractVV(this.m_vertices[h],this.m_vertices[e]);b.b2Assert(e.LengthSquared()>Number.MIN_VALUE);this.m_normals[f].SetV(k.CrossVF(e,
1));this.m_normals[f].Normalize()}this.m_centroid=d.ComputeCentroid(this.m_vertices,this.m_vertexCount)};d.AsVector=function(a,b){void 0===b&&(b=0);var c=new d;c.SetAsVector(a,b);return c};d.prototype.SetAsBox=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-a,-b);this.m_vertices[1].Set(a,-b);this.m_vertices[2].Set(a,b);this.m_vertices[3].Set(-a,b);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,
0);this.m_centroid.SetZero()};d.AsBox=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);var c=new d;c.SetAsBox(a,b);return c};d.prototype.SetAsOrientedBox=function(a,b,c,f){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=null);void 0===f&&(f=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-a,-b);this.m_vertices[1].Set(a,-b);this.m_vertices[2].Set(a,b);this.m_vertices[3].Set(-a,b);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,
0);this.m_centroid=c;a=new l;a.position=c;a.R.Set(f);for(c=0;c<this.m_vertexCount;++c)this.m_vertices[c]=k.MulX(a,this.m_vertices[c]),this.m_normals[c]=k.MulMV(a.R,this.m_normals[c])};d.AsOrientedBox=function(a,b,c,f){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=null);void 0===f&&(f=0);var e=new d;e.SetAsOrientedBox(a,b,c,f);return e};d.prototype.SetAsEdge=function(a,b){this.m_vertexCount=2;this.Reserve(2);this.m_vertices[0].SetV(a);this.m_vertices[1].SetV(b);this.m_centroid.x=0.5*(a.x+b.x);
this.m_centroid.y=0.5*(a.y+b.y);this.m_normals[0]=k.CrossVF(k.SubtractVV(b,a),1);this.m_normals[0].Normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y};d.AsEdge=function(a,b){var c=new d;c.SetAsEdge(a,b);return c};d.prototype.TestPoint=function(a,b){var c;c=a.R;for(var f=b.x-a.position.x,e=b.y-a.position.y,d=f*c.col1.x+e*c.col1.y,h=f*c.col2.x+e*c.col2.y,g=0;g<this.m_vertexCount;++g)if(c=this.m_vertices[g],f=d-c.x,e=h-c.y,c=this.m_normals[g],0<c.x*f+c.y*e)return!1;
return!0};d.prototype.RayCast=function(a,b,c){var f=0,e=b.maxFraction,d=0,h=0,g,k,d=b.p1.x-c.position.x,h=b.p1.y-c.position.y;g=c.R;var l=d*g.col1.x+h*g.col1.y,s=d*g.col2.x+h*g.col2.y,d=b.p2.x-c.position.x,h=b.p2.y-c.position.y;g=c.R;b=d*g.col1.x+h*g.col1.y-l;g=d*g.col2.x+h*g.col2.y-s;for(var r=-1,q=0;q<this.m_vertexCount;++q){k=this.m_vertices[q];d=k.x-l;h=k.y-s;k=this.m_normals[q];d=k.x*d+k.y*h;h=k.x*b+k.y*g;if(0==h){if(0>d)return!1}else 0>h&&d<f*h?(f=d/h,r=q):0<h&&d<e*h&&(e=d/h);if(e<f-Number.MIN_VALUE)return!1}return 0<=
r?(a.fraction=f,g=c.R,k=this.m_normals[r],a.normal.x=g.col1.x*k.x+g.col2.x*k.y,a.normal.y=g.col1.y*k.x+g.col2.y*k.y,!0):!1};d.prototype.ComputeAABB=function(a,b){for(var c=b.R,f=this.m_vertices[0],e=b.position.x+(c.col1.x*f.x+c.col2.x*f.y),d=b.position.y+(c.col1.y*f.x+c.col2.y*f.y),h=e,g=d,k=1;k<this.m_vertexCount;++k)var f=this.m_vertices[k],l=b.position.x+(c.col1.x*f.x+c.col2.x*f.y),f=b.position.y+(c.col1.y*f.x+c.col2.y*f.y),e=e<l?e:l,d=d<f?d:f,h=h>l?h:l,g=g>f?g:f;a.lowerBound.x=e-this.m_radius;
a.lowerBound.y=d-this.m_radius;a.upperBound.x=h+this.m_radius;a.upperBound.y=g+this.m_radius};d.prototype.ComputeMass=function(a,b){void 0===b&&(b=0);if(2==this.m_vertexCount)a.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=0.5*(this.m_vertices[0].y+this.m_vertices[1].y),a.mass=0,a.I=0;else{for(var c=0,f=0,e=0,d=0,h=1/3,g=0;g<this.m_vertexCount;++g)var k=this.m_vertices[g],l=g+1<this.m_vertexCount?this.m_vertices[parseInt(g+1)]:this.m_vertices[0],s=k.x-0,r=k.y-0,q=l.x-0,t=l.y-
0,B=s*t-r*q,y=0.5*B,e=e+y,c=c+y*h*(0+k.x+l.x),f=f+y*h*(0+k.y+l.y),k=s,d=d+B*(h*(0.25*(k*k+q*k+q*q)+(0*k+0*q))+0+(h*(0.25*(r*r+t*r+t*t)+(0*r+0*t))+0));a.mass=b*e;a.center.Set(c*(1/e),f*(1/e));a.I=b*d}};d.prototype.ComputeSubmergedArea=function(a,b,c,f){void 0===b&&(b=0);var d=k.MulTMV(c.R,a),h=b-k.Dot(a,c.position),g=new Vector_a2j_Number,l=0,s=-1;b=-1;var x=!1;for(a=a=0;a<this.m_vertexCount;++a){g[a]=k.Dot(d,this.m_vertices[a])-h;var v=g[a]<-Number.MIN_VALUE;0<a&&(v?x||(s=a-1,l++):x&&(b=a-1,l++));
x=v}switch(l){case 0:return x?(a=new e,this.ComputeMass(a,1),f.SetV(k.MulX(c,a.center)),a.mass):0;case 1:-1==s?s=this.m_vertexCount-1:b=this.m_vertexCount-1}a=parseInt((s+1)%this.m_vertexCount);d=parseInt((b+1)%this.m_vertexCount);h=(0-g[s])/(g[a]-g[s]);g=(0-g[b])/(g[d]-g[b]);s=new r(this.m_vertices[s].x*(1-h)+this.m_vertices[a].x*h,this.m_vertices[s].y*(1-h)+this.m_vertices[a].y*h);b=new r(this.m_vertices[b].x*(1-g)+this.m_vertices[d].x*g,this.m_vertices[b].y*(1-g)+this.m_vertices[d].y*g);g=0;h=
new r;for(l=this.m_vertices[a];a!=d;)a=(a+1)%this.m_vertexCount,x=a==d?b:this.m_vertices[a],v=0.5*((l.x-s.x)*(x.y-s.y)-(l.y-s.y)*(x.x-s.x)),g+=v,h.x+=v*(s.x+l.x+x.x)/3,h.y+=v*(s.y+l.y+x.y)/3,l=x;h.Multiply(1/g);f.SetV(k.MulX(c,h));return g};d.prototype.GetVertexCount=function(){return this.m_vertexCount};d.prototype.GetVertices=function(){return this.m_vertices};d.prototype.GetNormals=function(){return this.m_normals};d.prototype.GetSupport=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*
a.y,f=1;f<this.m_vertexCount;++f){var e=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;e>c&&(b=f,c=e)}return b};d.prototype.GetSupportVertex=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,f=1;f<this.m_vertexCount;++f){var e=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;e>c&&(b=f,c=e)}return this.m_vertices[b]};d.prototype.Validate=function(){return!1};d.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);this.m_type=g.e_polygonShape;this.m_centroid=
new r;this.m_vertices=new Vector;this.m_normals=new Vector};d.prototype.Reserve=function(a){void 0===a&&(a=0);for(var b=parseInt(this.m_vertices.length);b<a;b++)this.m_vertices[b]=new r,this.m_normals[b]=new r};d.ComputeCentroid=function(a,b){void 0===b&&(b=0);for(var c=new r,f=0,e=1/3,d=0;d<b;++d){var h=a[d],g=d+1<b?a[parseInt(d+1)]:a[0],k=0.5*((h.x-0)*(g.y-0)-(h.y-0)*(g.x-0)),f=f+k;c.x+=k*e*(0+h.x+g.x);c.y+=k*e*(0+h.y+g.y)}c.x*=1/f;c.y*=1/f;return c};d.ComputeOBB=function(a,b,c){void 0===c&&(c=
0);for(var f=0,e=new Vector(c+1),f=0;f<c;++f)e[f]=b[f];e[c]=e[0];b=Number.MAX_VALUE;for(f=1;f<=c;++f){for(var d=e[parseInt(f-1)],h=e[f].x-d.x,g=e[f].y-d.y,k=Math.sqrt(h*h+g*g),h=h/k,g=g/k,l=-g,s=h,r=k=Number.MAX_VALUE,q=-Number.MAX_VALUE,t=-Number.MAX_VALUE,B=0;B<c;++B){var y=e[B].x-d.x,K=e[B].y-d.y,P=h*y+g*K,y=l*y+s*K;P<k&&(k=P);y<r&&(r=y);P>q&&(q=P);y>t&&(t=y)}B=(q-k)*(t-r);B<0.95*b&&(b=B,a.R.col1.x=h,a.R.col1.y=g,a.R.col2.x=l,a.R.col2.y=s,h=0.5*(k+q),g=0.5*(r+t),l=a.R,a.center.x=d.x+(l.col1.x*
h+l.col2.x*g),a.center.y=d.y+(l.col1.y*h+l.col2.y*g),a.extents.x=0.5*(q-k),a.extents.y=0.5*(t-r))}};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new h});g.b2Shape=function(){};g.prototype.Copy=function(){return null};g.prototype.Set=function(a){this.m_radius=a.m_radius};g.prototype.GetType=function(){return this.m_type};g.prototype.TestPoint=function(){return!1};g.prototype.RayCast=function(){return!1};g.prototype.ComputeAABB=function(){};g.prototype.ComputeMass=function(){};
g.prototype.ComputeSubmergedArea=function(){return 0};g.TestOverlap=function(a,b,c,f){var e=new x;e.proxyA=new w;e.proxyA.Set(a);e.proxyB=new w;e.proxyB.Set(c);e.transformA=b;e.transformB=f;e.useRadii=!0;a=new F;a.count=0;b=new v;s.Distance(b,a,e);return b.distance<10*Number.MIN_VALUE};g.prototype.b2Shape=function(){this.m_type=g.e_unknownShape;this.m_radius=b.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=-1;Box2D.Collision.Shapes.b2Shape.e_circleShape=
0;Box2D.Collision.Shapes.b2Shape.e_polygonShape=1;Box2D.Collision.Shapes.b2Shape.e_edgeShape=2;Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3;Box2D.Collision.Shapes.b2Shape.e_hitCollide=1;Box2D.Collision.Shapes.b2Shape.e_missCollide=0;Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=-1})})();
(function(){var b=Box2D.Common.b2Color,c=Box2D.Common.b2Settings,a=Box2D.Common.Math.b2Math;b.b2Color=function(){this._b=this._g=this._r=0};b.prototype.b2Color=function(b,c,d){void 0===b&&(b=0);void 0===c&&(c=0);void 0===d&&(d=0);this._r=Box2D.parseUInt(255*a.Clamp(b,0,1));this._g=Box2D.parseUInt(255*a.Clamp(c,0,1));this._b=Box2D.parseUInt(255*a.Clamp(d,0,1))};b.prototype.Set=function(b,c,d){void 0===b&&(b=0);void 0===c&&(c=0);void 0===d&&(d=0);this._r=Box2D.parseUInt(255*a.Clamp(b,0,1));this._g=
Box2D.parseUInt(255*a.Clamp(c,0,1));this._b=Box2D.parseUInt(255*a.Clamp(d,0,1))};Object.defineProperty(b.prototype,"r",{enumerable:!1,configurable:!0,set:function(b){void 0===b&&(b=0);this._r=Box2D.parseUInt(255*a.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"g",{enumerable:!1,configurable:!0,set:function(b){void 0===b&&(b=0);this._g=Box2D.parseUInt(255*a.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"b",{enumerable:!1,configurable:!0,set:function(b){void 0===b&&(b=0);this._b=Box2D.parseUInt(255*
a.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}});c.b2Settings=function(){};c.b2MixFriction=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return Math.sqrt(a*b)};c.b2MixRestitution=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return a>b?a:b};c.b2Assert=function(a){if(!a)throw"Assertion Failed";};Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha";Box2D.Common.b2Settings.USHRT_MAX=
65535;Box2D.Common.b2Settings.b2_pi=Math.PI;Box2D.Common.b2Settings.b2_maxManifoldPoints=2;Box2D.Common.b2Settings.b2_aabbExtension=0.1;Box2D.Common.b2Settings.b2_aabbMultiplier=2;Box2D.Common.b2Settings.b2_polygonRadius=2*c.b2_linearSlop;Box2D.Common.b2Settings.b2_linearSlop=0.005;Box2D.Common.b2Settings.b2_angularSlop=2/180*c.b2_pi;Box2D.Common.b2Settings.b2_toiSlop=8*c.b2_linearSlop;Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32;Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32;Box2D.Common.b2Settings.b2_velocityThreshold=
1;Box2D.Common.b2Settings.b2_maxLinearCorrection=0.2;Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*c.b2_pi;Box2D.Common.b2Settings.b2_maxTranslation=2;Box2D.Common.b2Settings.b2_maxTranslationSquared=c.b2_maxTranslation*c.b2_maxTranslation;Box2D.Common.b2Settings.b2_maxRotation=0.5*c.b2_pi;Box2D.Common.b2Settings.b2_maxRotationSquared=c.b2_maxRotation*c.b2_maxRotation;Box2D.Common.b2Settings.b2_contactBaumgarte=0.2;Box2D.Common.b2Settings.b2_timeToSleep=0.5;Box2D.Common.b2Settings.b2_linearSleepTolerance=
0.01;Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*c.b2_pi})})();
(function(){var b=Box2D.Common.Math.b2Mat22,c=Box2D.Common.Math.b2Mat33,a=Box2D.Common.Math.b2Math,f=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,d=Box2D.Common.Math.b2Vec2,g=Box2D.Common.Math.b2Vec3;b.b2Mat22=function(){this.col1=new d;this.col2=new d};b.prototype.b2Mat22=function(){this.SetIdentity()};b.FromAngle=function(a){void 0===a&&(a=0);var c=new b;c.Set(a);return c};b.FromVV=function(a,c){var f=new b;f.SetVV(a,c);return f};b.prototype.Set=function(a){void 0===a&&(a=0);var b=
Math.cos(a);a=Math.sin(a);this.col1.x=b;this.col2.x=-a;this.col1.y=a;this.col2.y=b};b.prototype.SetVV=function(a,b){this.col1.SetV(a);this.col2.SetV(b)};b.prototype.Copy=function(){var a=new b;a.SetM(this);return a};b.prototype.SetM=function(a){this.col1.SetV(a.col1);this.col2.SetV(a.col2)};b.prototype.AddM=function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y};b.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1};
b.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0};b.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)};b.prototype.GetInverse=function(a){var b=this.col1.x,c=this.col2.x,f=this.col1.y,e=this.col2.y,d=b*e-c*f;0!=d&&(d=1/d);a.col1.x=d*e;a.col2.x=-d*c;a.col1.y=-d*f;a.col2.y=d*b;return a};b.prototype.Solve=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);var f=this.col1.x,e=this.col2.x,d=this.col1.y,g=this.col2.y,w=f*g-e*d;0!=w&&(w=1/w);
a.x=w*(g*b-e*c);a.y=w*(f*c-d*b);return a};b.prototype.Abs=function(){this.col1.Abs();this.col2.Abs()};c.b2Mat33=function(){this.col1=new g;this.col2=new g;this.col3=new g};c.prototype.b2Mat33=function(a,b,c){void 0===a&&(a=null);void 0===b&&(b=null);void 0===c&&(c=null);!a&&!b&&!c?(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero()):(this.col1.SetV(a),this.col2.SetV(b),this.col3.SetV(c))};c.prototype.SetVVV=function(a,b,c){this.col1.SetV(a);this.col2.SetV(b);this.col3.SetV(c)};c.prototype.Copy=
function(){return new c(this.col1,this.col2,this.col3)};c.prototype.SetM=function(a){this.col1.SetV(a.col1);this.col2.SetV(a.col2);this.col3.SetV(a.col3)};c.prototype.AddM=function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col1.z+=a.col1.z;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y;this.col2.z+=a.col2.z;this.col3.x+=a.col3.x;this.col3.y+=a.col3.y;this.col3.z+=a.col3.z};c.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;
this.col1.z=0;this.col2.z=0;this.col3.z=1};c.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0};c.prototype.Solve22=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=0);var f=this.col1.x,e=this.col2.x,d=this.col1.y,g=this.col2.y,w=f*g-e*d;0!=w&&(w=1/w);a.x=w*(g*b-e*c);a.y=w*(f*c-d*b);return a};c.prototype.Solve33=function(a,b,c,f){void 0===b&&(b=0);void 0===c&&(c=0);void 0===f&&(f=0);var e=this.col1.x,
d=this.col1.y,g=this.col1.z,w=this.col2.x,F=this.col2.y,m=this.col2.z,E=this.col3.x,A=this.col3.y,z=this.col3.z,D=e*(F*z-m*A)+d*(m*E-w*z)+g*(w*A-F*E);0!=D&&(D=1/D);a.x=D*(b*(F*z-m*A)+c*(m*E-w*z)+f*(w*A-F*E));a.y=D*(e*(c*z-f*A)+d*(f*E-b*z)+g*(b*A-c*E));a.z=D*(e*(F*f-m*c)+d*(m*b-w*f)+g*(w*c-F*b));return a};a.b2Math=function(){};a.IsValid=function(a){void 0===a&&(a=0);return isFinite(a)};a.Dot=function(a,b){return a.x*b.x+a.y*b.y};a.CrossVV=function(a,b){return a.x*b.y-a.y*b.x};a.CrossVF=function(a,
b){void 0===b&&(b=0);return new d(b*a.y,-b*a.x)};a.CrossFV=function(a,b){void 0===a&&(a=0);return new d(-a*b.y,a*b.x)};a.MulMV=function(a,b){return new d(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y)};a.MulTMV=function(b,c){return new d(a.Dot(c,b.col1),a.Dot(c,b.col2))};a.MulX=function(b,c){var f=a.MulMV(b.R,c);f.x+=b.position.x;f.y+=b.position.y;return f};a.MulXT=function(b,c){var f=a.SubtractVV(c,b.position),e=f.x*b.R.col1.x+f.y*b.R.col1.y;f.y=f.x*b.R.col2.x+f.y*b.R.col2.y;f.x=e;return f};
a.AddVV=function(a,b){return new d(a.x+b.x,a.y+b.y)};a.SubtractVV=function(a,b){return new d(a.x-b.x,a.y-b.y)};a.Distance=function(a,b){var c=a.x-b.x,f=a.y-b.y;return Math.sqrt(c*c+f*f)};a.DistanceSquared=function(a,b){var c=a.x-b.x,f=a.y-b.y;return c*c+f*f};a.MulFV=function(a,b){void 0===a&&(a=0);return new d(a*b.x,a*b.y)};a.AddMM=function(c,f){return b.FromVV(a.AddVV(c.col1,f.col1),a.AddVV(c.col2,f.col2))};a.MulMM=function(c,f){return b.FromVV(a.MulMV(c,f.col1),a.MulMV(c,f.col2))};a.MulTMM=function(c,
f){var e=new d(a.Dot(c.col1,f.col1),a.Dot(c.col2,f.col1)),g=new d(a.Dot(c.col1,f.col2),a.Dot(c.col2,f.col2));return b.FromVV(e,g)};a.Abs=function(a){void 0===a&&(a=0);return 0<a?a:-a};a.AbsV=function(b){return new d(a.Abs(b.x),a.Abs(b.y))};a.AbsM=function(c){return b.FromVV(a.AbsV(c.col1),a.AbsV(c.col2))};a.Min=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return a<b?a:b};a.MinV=function(b,c){return new d(a.Min(b.x,c.x),a.Min(b.y,c.y))};a.Max=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);
return a>b?a:b};a.MaxV=function(b,c){return new d(a.Max(b.x,c.x),a.Max(b.y,c.y))};a.Clamp=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);return a<b?b:a>c?c:a};a.ClampV=function(b,c,f){return a.MaxV(c,a.MinV(b,f))};a.Swap=function(a,b){var c=a[0];a[0]=b[0];b[0]=c};a.Random=function(){return 2*Math.random()-1};a.RandomRange=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);var c=Math.random();return(b-a)*c+a};a.NextPowerOfTwo=function(a){void 0===a&&(a=0);a|=a>>1&2147483647;a|=
a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};a.IsPowerOfTwo=function(a){void 0===a&&(a=0);return 0<a&&0==(a&a-1)};Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new d(0,0);Box2D.Common.Math.b2Math.b2Mat22_identity=b.FromVV(new d(1,0),new d(0,1));Box2D.Common.Math.b2Math.b2Transform_identity=new e(a.b2Vec2_zero,a.b2Mat22_identity)});f.b2Sweep=function(){this.localCenter=new d;this.c0=new d;this.c=new d};f.prototype.Set=function(a){this.localCenter.SetV(a.localCenter);
this.c0.SetV(a.c0);this.c.SetV(a.c);this.a0=a.a0;this.a=a.a;this.t0=a.t0};f.prototype.Copy=function(){var a=new f;a.localCenter.SetV(this.localCenter);a.c0.SetV(this.c0);a.c.SetV(this.c);a.a0=this.a0;a.a=this.a;a.t0=this.t0;return a};f.prototype.GetTransform=function(a,b){void 0===b&&(b=0);a.position.x=(1-b)*this.c0.x+b*this.c.x;a.position.y=(1-b)*this.c0.y+b*this.c.y;a.R.Set((1-b)*this.a0+b*this.a);var c=a.R;a.position.x-=c.col1.x*this.localCenter.x+c.col2.x*this.localCenter.y;a.position.y-=c.col1.y*
this.localCenter.x+c.col2.y*this.localCenter.y};f.prototype.Advance=function(a){void 0===a&&(a=0);if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x;this.c0.y=(1-b)*this.c0.y+b*this.c.y;this.a0=(1-b)*this.a0+b*this.a;this.t0=a}};e.b2Transform=function(){this.position=new d;this.R=new b};e.prototype.b2Transform=function(a,b){void 0===a&&(a=null);void 0===b&&(b=null);a&&(this.position.SetV(a),this.R.SetM(b))};e.prototype.Initialize=function(a,
b){this.position.SetV(a);this.R.SetM(b)};e.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity()};e.prototype.Set=function(a){this.position.SetV(a.position);this.R.SetM(a.R)};e.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)};d.b2Vec2=function(){};d.prototype.b2Vec2=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);this.x=a;this.y=b};d.prototype.SetZero=function(){this.y=this.x=0};d.prototype.Set=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);
this.x=a;this.y=b};d.prototype.SetV=function(a){this.x=a.x;this.y=a.y};d.prototype.GetNegative=function(){return new d(-this.x,-this.y)};d.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y};d.Make=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);return new d(a,b)};d.prototype.Copy=function(){return new d(this.x,this.y)};d.prototype.Add=function(a){this.x+=a.x;this.y+=a.y};d.prototype.Subtract=function(a){this.x-=a.x;this.y-=a.y};d.prototype.Multiply=function(a){void 0===a&&(a=0);this.x*=
a;this.y*=a};d.prototype.MulM=function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y;this.y=a.col1.y*b+a.col2.y*this.y};d.prototype.MulTM=function(b){var c=a.Dot(this,b.col1);this.y=a.Dot(this,b.col2);this.x=c};d.prototype.CrossVF=function(a){void 0===a&&(a=0);var b=this.x;this.x=a*this.y;this.y=-a*b};d.prototype.CrossFV=function(a){void 0===a&&(a=0);var b=this.x;this.x=-a*this.y;this.y=a*b};d.prototype.MinV=function(a){this.x=this.x<a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y};d.prototype.MaxV=
function(a){this.x=this.x>a.x?this.x:a.x;this.y=this.y>a.y?this.y:a.y};d.prototype.Abs=function(){0>this.x&&(this.x=-this.x);0>this.y&&(this.y=-this.y)};d.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};d.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y};d.prototype.Normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;this.x*=b;this.y*=b;return a};d.prototype.IsValid=function(){return a.IsValid(this.x)&&
a.IsValid(this.y)};g.b2Vec3=function(){};g.prototype.b2Vec3=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);this.x=a;this.y=b;this.z=c};g.prototype.SetZero=function(){this.x=this.y=this.z=0};g.prototype.Set=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);this.x=a;this.y=b;this.z=c};g.prototype.SetV=function(a){this.x=a.x;this.y=a.y;this.z=a.z};g.prototype.GetNegative=function(){return new g(-this.x,-this.y,-this.z)};g.prototype.NegativeSelf=function(){this.x=
-this.x;this.y=-this.y;this.z=-this.z};g.prototype.Copy=function(){return new g(this.x,this.y,this.z)};g.prototype.Add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z};g.prototype.Subtract=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z};g.prototype.Multiply=function(a){void 0===a&&(a=0);this.x*=a;this.y*=a;this.z*=a}})();
(function(){var b=Box2D.Common.Math.b2Math,c=Box2D.Common.Math.b2Sweep,a=Box2D.Common.Math.b2Transform,f=Box2D.Common.Math.b2Vec2,e=Box2D.Common.b2Color,d=Box2D.Common.b2Settings,g=Box2D.Collision.b2AABB,h=Box2D.Collision.b2ContactPoint,k=Box2D.Collision.b2DynamicTreeBroadPhase,l=Box2D.Collision.b2RayCastInput,r=Box2D.Collision.b2RayCastOutput,s=Box2D.Collision.Shapes.b2CircleShape,x=Box2D.Collision.Shapes.b2EdgeShape,v=Box2D.Collision.Shapes.b2MassData,w=Box2D.Collision.Shapes.b2PolygonShape,F=Box2D.Collision.Shapes.b2Shape,
m=Box2D.Dynamics.b2Body,E=Box2D.Dynamics.b2BodyDef,A=Box2D.Dynamics.b2ContactFilter,z=Box2D.Dynamics.b2ContactImpulse,D=Box2D.Dynamics.b2ContactListener,H=Box2D.Dynamics.b2ContactManager,C=Box2D.Dynamics.b2DebugDraw,M=Box2D.Dynamics.b2DestructionListener,G=Box2D.Dynamics.b2FilterData,I=Box2D.Dynamics.b2Fixture,N=Box2D.Dynamics.b2FixtureDef,L=Box2D.Dynamics.b2Island,q=Box2D.Dynamics.b2TimeStep,t=Box2D.Dynamics.b2World,B=Box2D.Dynamics.Contacts.b2Contact,y=Box2D.Dynamics.Contacts.b2ContactFactory,K=
Box2D.Dynamics.Contacts.b2ContactSolver,P=Box2D.Dynamics.Joints.b2Joint,O=Box2D.Dynamics.Joints.b2PulleyJoint;m.b2Body=function(){this.m_xf=new a;this.m_sweep=new c;this.m_linearVelocity=new f;this.m_force=new f};m.prototype.connectEdges=function(a,c,f){void 0===f&&(f=0);var e=Math.atan2(c.GetDirectionVector().y,c.GetDirectionVector().x);f=b.MulFV(Math.tan(0.5*(e-f)),c.GetDirectionVector());f=b.SubtractVV(f,c.GetNormalVector());f=b.MulFV(d.b2_toiSlop,f);f=b.AddVV(f,c.GetVertex1());var q=b.AddVV(a.GetDirectionVector(),
c.GetDirectionVector());q.Normalize();var g=0<b.Dot(a.GetDirectionVector(),c.GetNormalVector());a.SetNextEdge(c,f,q,g);c.SetPrevEdge(a,f,q,g);return e};m.prototype.CreateFixture=function(a){if(!0==this.m_world.IsLocked())return null;var b=new I;b.Create(this,this.m_xf,a);this.m_flags&m.e_activeFlag&&b.CreateProxy(this.m_world.m_contactManager.m_broadPhase,this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;0<b.m_density&&this.ResetMassData();this.m_world.m_flags|=
t.e_newFixture;return b};m.prototype.CreateFixture2=function(a,b){void 0===b&&(b=0);var c=new N;c.shape=a;c.density=b;return this.CreateFixture(c)};m.prototype.DestroyFixture=function(a){if(!0!=this.m_world.IsLocked()){for(var b=this.m_fixtureList,c=null;null!=b;){if(b==a){c?c.m_next=a.m_next:this.m_fixtureList=a.m_next;break}c=b;b=b.m_next}for(b=this.m_contactList;b;){var c=b.contact,b=b.next,f=c.GetFixtureA(),e=c.GetFixtureB();(a==f||a==e)&&this.m_world.m_contactManager.Destroy(c)}this.m_flags&
m.e_activeFlag&&a.DestroyProxy(this.m_world.m_contactManager.m_broadPhase);a.Destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};m.prototype.SetPositionAndAngle=function(a,b){void 0===b&&(b=0);var c;if(!0!=this.m_world.IsLocked()){this.m_xf.R.Set(b);this.m_xf.position.SetV(a);c=this.m_xf.R;var f=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*f.x+c.col2.x*f.y;this.m_sweep.c.y=c.col1.y*f.x+c.col2.y*f.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;
this.m_sweep.c0.SetV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=b;f=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(f,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}};m.prototype.SetTransform=function(a){this.SetPositionAndAngle(a.position,a.GetAngle())};m.prototype.GetTransform=function(){return this.m_xf};m.prototype.GetPosition=function(){return this.m_xf.position};m.prototype.SetPosition=function(a){this.SetPositionAndAngle(a,
this.GetAngle())};m.prototype.GetAngle=function(){return this.m_sweep.a};m.prototype.SetAngle=function(a){void 0===a&&(a=0);this.SetPositionAndAngle(this.GetPosition(),a)};m.prototype.GetWorldCenter=function(){return this.m_sweep.c};m.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter};m.prototype.SetLinearVelocity=function(a){this.m_type!=m.b2_staticBody&&this.m_linearVelocity.SetV(a)};m.prototype.GetLinearVelocity=function(){return this.m_linearVelocity};m.prototype.SetAngularVelocity=
function(a){void 0===a&&(a=0);this.m_type!=m.b2_staticBody&&(this.m_angularVelocity=a)};m.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};m.prototype.GetDefinition=function(){var a=new E;a.type=this.GetType();a.allowSleep=(this.m_flags&m.e_allowSleepFlag)==m.e_allowSleepFlag;a.angle=this.GetAngle();a.angularDamping=this.m_angularDamping;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&m.e_fixedRotationFlag)==m.e_fixedRotationFlag;a.bullet=(this.m_flags&
m.e_bulletFlag)==m.e_bulletFlag;a.awake=(this.m_flags&m.e_awakeFlag)==m.e_awakeFlag;a.linearDamping=this.m_linearDamping;a.linearVelocity.SetV(this.GetLinearVelocity());a.position=this.GetPosition();a.userData=this.GetUserData();return a};m.prototype.ApplyForce=function(a,b){this.m_type==m.b2_dynamicBody&&(!1==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)};m.prototype.ApplyTorque=function(a){void 0===
a&&(a=0);this.m_type==m.b2_dynamicBody&&(!1==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=a)};m.prototype.ApplyImpulse=function(a,b){this.m_type==m.b2_dynamicBody&&(!1==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))};m.prototype.Split=function(a){for(var c=this.GetLinearVelocity().Copy(),f=this.GetAngularVelocity(),e=this.GetWorldCenter(),
d=this.m_world.CreateBody(this.GetDefinition()),q,g=this.m_fixtureList;g;)if(a(g)){var t=g.m_next;q?q.m_next=t:this.m_fixtureList=t;this.m_fixtureCount--;g.m_next=d.m_fixtureList;d.m_fixtureList=g;d.m_fixtureCount++;g.m_body=d;g=t}else q=g,g=g.m_next;this.ResetMassData();d.ResetMassData();q=this.GetWorldCenter();a=d.GetWorldCenter();q=b.AddVV(c,b.CrossFV(f,b.SubtractVV(q,e)));c=b.AddVV(c,b.CrossFV(f,b.SubtractVV(a,e)));this.SetLinearVelocity(q);d.SetLinearVelocity(c);this.SetAngularVelocity(f);d.SetAngularVelocity(f);
this.SynchronizeFixtures();d.SynchronizeFixtures();return d};m.prototype.Merge=function(a){var b;for(b=a.m_fixtureList;b;){var c=b.m_next;a.m_fixtureCount--;b.m_next=this.m_fixtureList;this.m_fixtureList=b;this.m_fixtureCount++;b.m_body=e;b=c}f.m_fixtureCount=0;var f=this,e=a;f.GetWorldCenter();e.GetWorldCenter();f.GetLinearVelocity().Copy();e.GetLinearVelocity().Copy();f.GetAngularVelocity();e.GetAngularVelocity();f.ResetMassData();this.SynchronizeFixtures()};m.prototype.GetMass=function(){return this.m_mass};
m.prototype.GetInertia=function(){return this.m_I};m.prototype.GetMassData=function(a){a.mass=this.m_mass;a.I=this.m_I;a.center.SetV(this.m_sweep.localCenter)};m.prototype.SetMassData=function(a){d.b2Assert(!1==this.m_world.IsLocked());if(!0!=this.m_world.IsLocked()&&this.m_type==m.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<a.I&&0==(this.m_flags&m.e_fixedRotationFlag)&&(this.m_I=a.I-this.m_mass*(a.center.x*
a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var c=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a.center);this.m_sweep.c0.SetV(b.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-c.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-c.x)}};m.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(!(this.m_type==
m.b2_staticBody||this.m_type==m.b2_kinematicBody)){for(var a=f.Make(0,0),c=this.m_fixtureList;c;c=c.m_next)if(0!=c.m_density){var e=c.GetMassData();this.m_mass+=e.mass;a.x+=e.center.x*e.mass;a.y+=e.center.y*e.mass;this.m_I+=e.I}0<this.m_mass?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0==(this.m_flags&m.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,d.b2Assert(0<this.m_I),this.m_invI=1/
this.m_I):this.m_invI=this.m_I=0;c=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a);this.m_sweep.c0.SetV(b.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-c.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-c.x)}};m.prototype.GetWorldPoint=function(a){var b=this.m_xf.R;a=new f(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;
return a};m.prototype.GetWorldVector=function(a){return b.MulMV(this.m_xf.R,a)};m.prototype.GetLocalPoint=function(a){return b.MulXT(this.m_xf,a)};m.prototype.GetLocalVector=function(a){return b.MulTMV(this.m_xf.R,a)};m.prototype.GetLinearVelocityFromWorldPoint=function(a){return new f(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))};m.prototype.GetLinearVelocityFromLocalPoint=function(a){var b=this.m_xf.R;
a=new f(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return new f(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))};m.prototype.GetLinearDamping=function(){return this.m_linearDamping};m.prototype.SetLinearDamping=function(a){void 0===a&&(a=0);this.m_linearDamping=a};m.prototype.GetAngularDamping=function(){return this.m_angularDamping};m.prototype.SetAngularDamping=
function(a){void 0===a&&(a=0);this.m_angularDamping=a};m.prototype.SetType=function(a){void 0===a&&(a=0);if(this.m_type!=a){this.m_type=a;this.ResetMassData();this.m_type==m.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0);this.SetAwake(!0);this.m_force.SetZero();this.m_torque=0;for(a=this.m_contactList;a;a=a.next)a.contact.FlagForFiltering()}};m.prototype.GetType=function(){return this.m_type};m.prototype.SetBullet=function(a){this.m_flags=a?this.m_flags|m.e_bulletFlag:this.m_flags&
~m.e_bulletFlag};m.prototype.IsBullet=function(){return(this.m_flags&m.e_bulletFlag)==m.e_bulletFlag};m.prototype.SetSleepingAllowed=function(a){a?this.m_flags|=m.e_allowSleepFlag:(this.m_flags&=~m.e_allowSleepFlag,this.SetAwake(!0))};m.prototype.SetAwake=function(a){a?(this.m_flags|=m.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~m.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)};m.prototype.IsAwake=function(){return(this.m_flags&
m.e_awakeFlag)==m.e_awakeFlag};m.prototype.SetFixedRotation=function(a){this.m_flags=a?this.m_flags|m.e_fixedRotationFlag:this.m_flags&~m.e_fixedRotationFlag;this.ResetMassData()};m.prototype.IsFixedRotation=function(){return(this.m_flags&m.e_fixedRotationFlag)==m.e_fixedRotationFlag};m.prototype.SetActive=function(a){if(a!=this.IsActive()){var b;if(a){this.m_flags|=m.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)b.CreateProxy(a,this.m_xf)}else{this.m_flags&=
~m.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)b.DestroyProxy(a);for(a=this.m_contactList;a;)b=a,a=a.next,this.m_world.m_contactManager.Destroy(b.contact);this.m_contactList=null}}};m.prototype.IsActive=function(){return(this.m_flags&m.e_activeFlag)==m.e_activeFlag};m.prototype.IsSleepingAllowed=function(){return(this.m_flags&m.e_allowSleepFlag)==m.e_allowSleepFlag};m.prototype.GetFixtureList=function(){return this.m_fixtureList};m.prototype.GetJointList=
function(){return this.m_jointList};m.prototype.GetControllerList=function(){return this.m_controllerList};m.prototype.GetContactList=function(){return this.m_contactList};m.prototype.GetNext=function(){return this.m_next};m.prototype.GetUserData=function(){return this.m_userData};m.prototype.SetUserData=function(a){this.m_userData=a};m.prototype.GetWorld=function(){return this.m_world};m.prototype.b2Body=function(a,b){this.m_flags=0;a.bullet&&(this.m_flags|=m.e_bulletFlag);a.fixedRotation&&(this.m_flags|=
m.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=m.e_allowSleepFlag);a.awake&&(this.m_flags|=m.e_awakeFlag);a.active&&(this.m_flags|=m.e_activeFlag);this.m_world=b;this.m_xf.position.SetV(a.position);this.m_xf.R.Set(a.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=a.angle;var c=this.m_xf.R,f=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*f.x+c.col2.x*f.y;this.m_sweep.c.y=c.col1.y*f.x+c.col2.y*f.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=
this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.SetV(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;this.m_angularDamping=a.angularDamping;this.m_force.Set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=this.m_type==m.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=
0;this.m_inertiaScale=a.inertiaScale;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0};m.prototype.SynchronizeFixtures=function(){var a=m.s_xf1;a.R.Set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y);a.position.y=this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);c=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)b.Synchronize(c,a,this.m_xf)};m.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);
var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y);this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)};m.prototype.ShouldCollide=function(a){if(this.m_type!=m.b2_dynamicBody&&a.m_type!=m.b2_dynamicBody)return!1;for(var b=this.m_jointList;b;b=b.next)if(b.other==a&&!1==b.joint.m_collideConnected)return!1;return!0};m.prototype.Advance=function(a){void 0===a&&(a=0);this.m_sweep.Advance(a);this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=
this.m_sweep.a0;this.SynchronizeTransform()};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new a;Box2D.Dynamics.b2Body.e_islandFlag=1;Box2D.Dynamics.b2Body.e_awakeFlag=2;Box2D.Dynamics.b2Body.e_allowSleepFlag=4;Box2D.Dynamics.b2Body.e_bulletFlag=8;Box2D.Dynamics.b2Body.e_fixedRotationFlag=16;Box2D.Dynamics.b2Body.e_activeFlag=32;Box2D.Dynamics.b2Body.b2_staticBody=0;Box2D.Dynamics.b2Body.b2_kinematicBody=1;Box2D.Dynamics.b2Body.b2_dynamicBody=2});E.b2BodyDef=function(){this.position=
new f;this.linearVelocity=new f};E.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,0);this.angle=0;this.linearVelocity.Set(0,0);this.angularDamping=this.linearDamping=this.angularVelocity=0;this.awake=this.allowSleep=!0;this.bullet=this.fixedRotation=!1;this.type=m.b2_staticBody;this.active=!0;this.inertiaScale=1};A.b2ContactFilter=function(){};A.prototype.ShouldCollide=function(a,b){var c=a.GetFilterData(),f=b.GetFilterData();return c.groupIndex==f.groupIndex&&0!=c.groupIndex?
0<c.groupIndex:0!=(c.maskBits&f.categoryBits)&&0!=(c.categoryBits&f.maskBits)};A.prototype.RayCollide=function(a,b){return!a?!0:this.ShouldCollide(a instanceof I?a:null,b)};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new A});z.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(d.b2_maxManifoldPoints);this.tangentImpulses=new Vector_a2j_Number(d.b2_maxManifoldPoints)};D.b2ContactListener=function(){};D.prototype.BeginContact=function(){};D.prototype.EndContact=
function(){};D.prototype.PreSolve=function(){};D.prototype.PostSolve=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new D});H.b2ContactManager=function(){};H.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=A.b2_defaultFilter;this.m_contactListener=D.b2_defaultListener;this.m_contactFactory=new y(this.m_allocator);this.m_broadPhase=new k};H.prototype.AddPair=function(a,b){var c=a instanceof I?a:null,
f=b instanceof I?b:null,e=c.GetBody(),d=f.GetBody();if(e!=d){for(var q=d.GetContactList();q;){if(q.other==e){var g=q.contact.GetFixtureA(),t=q.contact.GetFixtureB();if(g==c&&t==f||g==f&&t==c)return}q=q.next}!1!=d.ShouldCollide(e)&&!1!=this.m_contactFilter.ShouldCollide(c,f)&&(q=this.m_contactFactory.Create(c,f),c=q.GetFixtureA(),f=q.GetFixtureB(),e=c.m_body,d=f.m_body,q.m_prev=null,q.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=q),this.m_world.m_contactList=
q,q.m_nodeA.contact=q,q.m_nodeA.other=d,q.m_nodeA.prev=null,q.m_nodeA.next=e.m_contactList,null!=e.m_contactList&&(e.m_contactList.prev=q.m_nodeA),e.m_contactList=q.m_nodeA,q.m_nodeB.contact=q,q.m_nodeB.other=e,q.m_nodeB.prev=null,q.m_nodeB.next=d.m_contactList,null!=d.m_contactList&&(d.m_contactList.prev=q.m_nodeB),d.m_contactList=q.m_nodeB,++this.m_world.m_contactCount)}};H.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))};H.prototype.Destroy=
function(a){var b=a.GetFixtureA(),c=a.GetFixtureB(),b=b.GetBody(),c=c.GetBody();a.IsTouching()&&this.m_contactListener.EndContact(a);a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next);a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA==b.m_contactList&&(b.m_contactList=a.m_nodeA.next);a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next);a.m_nodeB.next&&
(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB==c.m_contactList&&(c.m_contactList=a.m_nodeB.next);this.m_contactFactory.Destroy(a);--this.m_contactCount};H.prototype.Collide=function(){for(var a=this.m_world.m_contactList;a;){var b=a.GetFixtureA(),c=a.GetFixtureB(),f=b.GetBody(),e=c.GetBody();if(!1==f.IsAwake()&&!1==e.IsAwake())a=a.GetNext();else{if(a.m_flags&B.e_filterFlag){if(!1==e.ShouldCollide(f)){b=a;a=b.GetNext();this.Destroy(b);continue}if(!1==this.m_contactFilter.ShouldCollide(b,c)){b=a;a=
b.GetNext();this.Destroy(b);continue}a.m_flags&=~B.e_filterFlag}!1==this.m_broadPhase.TestOverlap(b.m_proxy,c.m_proxy)?(b=a,a=b.GetNext(),this.Destroy(b)):(a.Update(this.m_contactListener),a=a.GetNext())}}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new h});C.b2DebugDraw=function(){};C.prototype.b2DebugDraw=function(){};C.prototype.SetFlags=function(){};C.prototype.GetFlags=function(){};C.prototype.AppendFlags=function(){};C.prototype.ClearFlags=function(){};C.prototype.SetSprite=
function(){};C.prototype.GetSprite=function(){};C.prototype.SetDrawScale=function(){};C.prototype.GetDrawScale=function(){};C.prototype.SetLineThickness=function(){};C.prototype.GetLineThickness=function(){};C.prototype.SetAlpha=function(){};C.prototype.GetAlpha=function(){};C.prototype.SetFillAlpha=function(){};C.prototype.GetFillAlpha=function(){};C.prototype.SetXFormScale=function(){};C.prototype.GetXFormScale=function(){};C.prototype.DrawPolygon=function(){};C.prototype.DrawSolidPolygon=function(){};
C.prototype.DrawCircle=function(){};C.prototype.DrawSolidCircle=function(){};C.prototype.DrawSegment=function(){};C.prototype.DrawTransform=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1;Box2D.Dynamics.b2DebugDraw.e_jointBit=2;Box2D.Dynamics.b2DebugDraw.e_aabbBit=4;Box2D.Dynamics.b2DebugDraw.e_pairBit=8;Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16;Box2D.Dynamics.b2DebugDraw.e_controllerBit=32});M.b2DestructionListener=function(){};M.prototype.SayGoodbyeJoint=
function(){};M.prototype.SayGoodbyeFixture=function(){};G.b2FilterData=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};G.prototype.Copy=function(){var a=new G;a.categoryBits=this.categoryBits;a.maskBits=this.maskBits;a.groupIndex=this.groupIndex;return a};I.b2Fixture=function(){this.m_filter=new G};I.prototype.GetType=function(){return this.m_shape.GetType()};I.prototype.GetShape=function(){return this.m_shape};I.prototype.SetSensor=function(a){if(this.m_isSensor!=a&&(this.m_isSensor=
a,null!=this.m_body))for(a=this.m_body.GetContactList();a;){var b=a.contact,c=b.GetFixtureA(),f=b.GetFixtureB();if(c==this||f==this)b.SetSensor(c.IsSensor()||f.IsSensor());a=a.next}};I.prototype.IsSensor=function(){return this.m_isSensor};I.prototype.SetFilterData=function(a){this.m_filter=a.Copy();if(!this.m_body)for(a=this.m_body.GetContactList();a;){var b=a.contact,c=b.GetFixtureA(),f=b.GetFixtureB();(c==this||f==this)&&b.FlagForFiltering();a=a.next}};I.prototype.GetFilterData=function(){return this.m_filter.Copy()};
I.prototype.GetBody=function(){return this.m_body};I.prototype.GetNext=function(){return this.m_next};I.prototype.GetUserData=function(){return this.m_userData};I.prototype.SetUserData=function(a){this.m_userData=a};I.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)};I.prototype.RayCast=function(a,b){return this.m_shape.RayCast(a,b,this.m_body.GetTransform())};I.prototype.GetMassData=function(a){void 0===a&&(a=null);null==a&&(a=new v);this.m_shape.ComputeMass(a,
this.m_density);return a};I.prototype.SetDensity=function(a){void 0===a&&(a=0);this.m_density=a};I.prototype.GetDensity=function(){return this.m_density};I.prototype.GetFriction=function(){return this.m_friction};I.prototype.SetFriction=function(a){void 0===a&&(a=0);this.m_friction=a};I.prototype.GetRestitution=function(){return this.m_restitution};I.prototype.SetRestitution=function(a){void 0===a&&(a=0);this.m_restitution=a};I.prototype.GetAABB=function(){return this.m_aabb};I.prototype.b2Fixture=
function(){this.m_aabb=new g;this.m_shape=this.m_next=this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};I.prototype.Create=function(a,b,c){this.m_userData=c.userData;this.m_friction=c.friction;this.m_restitution=c.restitution;this.m_body=a;this.m_next=null;this.m_filter=c.filter.Copy();this.m_isSensor=c.isSensor;this.m_shape=c.shape.Copy();this.m_density=c.density};I.prototype.Destroy=function(){this.m_shape=null};I.prototype.CreateProxy=function(a,b){this.m_shape.ComputeAABB(this.m_aabb,
b);this.m_proxy=a.CreateProxy(this.m_aabb,this)};I.prototype.DestroyProxy=function(a){null!=this.m_proxy&&(a.DestroyProxy(this.m_proxy),this.m_proxy=null)};I.prototype.Synchronize=function(a,c,f){if(this.m_proxy){var e=new g,d=new g;this.m_shape.ComputeAABB(e,c);this.m_shape.ComputeAABB(d,f);this.m_aabb.Combine(e,d);c=b.SubtractVV(f.position,c.position);a.MoveProxy(this.m_proxy,this.m_aabb,c)}};N.b2FixtureDef=function(){this.filter=new G};N.prototype.b2FixtureDef=function(){this.userData=this.shape=
null;this.friction=0.2;this.density=this.restitution=0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=!1};L.b2Island=function(){};L.prototype.b2Island=function(){this.m_bodies=new Vector;this.m_contacts=new Vector;this.m_joints=new Vector};L.prototype.Initialize=function(a,b,c,f,e,d){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);var q=0;this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=c;this.m_jointCount=this.m_contactCount=
this.m_bodyCount=0;this.m_allocator=f;this.m_listener=e;this.m_contactSolver=d;for(q=this.m_bodies.length;q<a;q++)this.m_bodies[q]=null;for(q=this.m_contacts.length;q<b;q++)this.m_contacts[q]=null;for(q=this.m_joints.length;q<c;q++)this.m_joints[q]=null};L.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};L.prototype.Solve=function(a,c,f){for(var e=0,q=0,g,e=0;e<this.m_bodyCount;++e)q=this.m_bodies[e],q.GetType()==m.b2_dynamicBody&&(q.m_linearVelocity.x+=a.dt*(c.x+
q.m_invMass*q.m_force.x),q.m_linearVelocity.y+=a.dt*(c.y+q.m_invMass*q.m_force.y),q.m_angularVelocity+=a.dt*q.m_invI*q.m_torque,q.m_linearVelocity.Multiply(b.Clamp(1-a.dt*q.m_linearDamping,0,1)),q.m_angularVelocity*=b.Clamp(1-a.dt*q.m_angularDamping,0,1));this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);c=this.m_contactSolver;c.InitVelocityConstraints(a);for(e=0;e<this.m_jointCount;++e)g=this.m_joints[e],g.InitVelocityConstraints(a);for(e=0;e<a.velocityIterations;++e){for(q=
0;q<this.m_jointCount;++q)g=this.m_joints[q],g.SolveVelocityConstraints(a);c.SolveVelocityConstraints()}for(e=0;e<this.m_jointCount;++e)g=this.m_joints[e],g.FinalizeVelocityConstraints();c.FinalizeVelocityConstraints();for(e=0;e<this.m_bodyCount;++e)if(q=this.m_bodies[e],q.GetType()!=m.b2_staticBody){var t=a.dt*q.m_linearVelocity.x,y=a.dt*q.m_linearVelocity.y;t*t+y*y>d.b2_maxTranslationSquared&&(q.m_linearVelocity.Normalize(),q.m_linearVelocity.x*=d.b2_maxTranslation*a.inv_dt,q.m_linearVelocity.y*=
d.b2_maxTranslation*a.inv_dt);t=a.dt*q.m_angularVelocity;t*t>d.b2_maxRotationSquared&&(q.m_angularVelocity=0>q.m_angularVelocity?-d.b2_maxRotation*a.inv_dt:d.b2_maxRotation*a.inv_dt);q.m_sweep.c0.SetV(q.m_sweep.c);q.m_sweep.a0=q.m_sweep.a;q.m_sweep.c.x+=a.dt*q.m_linearVelocity.x;q.m_sweep.c.y+=a.dt*q.m_linearVelocity.y;q.m_sweep.a+=a.dt*q.m_angularVelocity;q.SynchronizeTransform()}for(e=0;e<a.positionIterations;++e){t=c.SolvePositionConstraints(d.b2_contactBaumgarte);y=!0;for(q=0;q<this.m_jointCount;++q)g=
this.m_joints[q],g=g.SolvePositionConstraints(d.b2_contactBaumgarte),y=y&&g;if(t&&y)break}this.Report(c.m_constraints);if(f){f=Number.MAX_VALUE;c=d.b2_linearSleepTolerance*d.b2_linearSleepTolerance;t=d.b2_angularSleepTolerance*d.b2_angularSleepTolerance;for(e=0;e<this.m_bodyCount;++e)q=this.m_bodies[e],q.GetType()!=m.b2_staticBody&&(0==(q.m_flags&m.e_allowSleepFlag)&&(f=q.m_sleepTime=0),0==(q.m_flags&m.e_allowSleepFlag)||q.m_angularVelocity*q.m_angularVelocity>t||b.Dot(q.m_linearVelocity,q.m_linearVelocity)>
c?f=q.m_sleepTime=0:(q.m_sleepTime+=a.dt,f=b.Min(f,q.m_sleepTime)));if(f>=d.b2_timeToSleep)for(e=0;e<this.m_bodyCount;++e)q=this.m_bodies[e],q.SetAwake(!1)}};L.prototype.SolveTOI=function(a){var b=0,c=0;this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);for(var f=this.m_contactSolver,b=0;b<this.m_jointCount;++b)this.m_joints[b].InitVelocityConstraints(a);for(b=0;b<a.velocityIterations;++b){f.SolveVelocityConstraints();for(c=0;c<this.m_jointCount;++c)this.m_joints[c].SolveVelocityConstraints(a)}for(b=
0;b<this.m_bodyCount;++b)if(c=this.m_bodies[b],c.GetType()!=m.b2_staticBody){var e=a.dt*c.m_linearVelocity.x,q=a.dt*c.m_linearVelocity.y;e*e+q*q>d.b2_maxTranslationSquared&&(c.m_linearVelocity.Normalize(),c.m_linearVelocity.x*=d.b2_maxTranslation*a.inv_dt,c.m_linearVelocity.y*=d.b2_maxTranslation*a.inv_dt);e=a.dt*c.m_angularVelocity;e*e>d.b2_maxRotationSquared&&(c.m_angularVelocity=0>c.m_angularVelocity?-d.b2_maxRotation*a.inv_dt:d.b2_maxRotation*a.inv_dt);c.m_sweep.c0.SetV(c.m_sweep.c);c.m_sweep.a0=
c.m_sweep.a;c.m_sweep.c.x+=a.dt*c.m_linearVelocity.x;c.m_sweep.c.y+=a.dt*c.m_linearVelocity.y;c.m_sweep.a+=a.dt*c.m_angularVelocity;c.SynchronizeTransform()}for(b=0;b<a.positionIterations;++b){e=f.SolvePositionConstraints(0.75);q=!0;for(c=0;c<this.m_jointCount;++c)var g=this.m_joints[c].SolvePositionConstraints(d.b2_contactBaumgarte),q=q&&g;if(e&&q)break}this.Report(f.m_constraints)};L.prototype.Report=function(a){if(null!=this.m_listener)for(var b=0;b<this.m_contactCount;++b){for(var c=this.m_contacts[b],
f=a[b],e=0;e<f.pointCount;++e)L.s_impulse.normalImpulses[e]=f.points[e].normalImpulse,L.s_impulse.tangentImpulses[e]=f.points[e].tangentImpulse;this.m_listener.PostSolve(c,L.s_impulse)}};L.prototype.AddBody=function(a){a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a};L.prototype.AddContact=function(a){this.m_contacts[this.m_contactCount++]=a};L.prototype.AddJoint=function(a){this.m_joints[this.m_jointCount++]=a};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=
new z});q.b2TimeStep=function(){};q.prototype.Set=function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.warmStarting=a.warmStarting};t.b2World=function(){this.s_stack=new Vector;this.m_contactManager=new H;this.m_contactSolver=new K;this.m_island=new L};t.prototype.b2World=function(a,b){this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=
this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;t.m_warmStarting=!0;t.m_continuousPhysics=!0;this.m_allowSleep=b;this.m_gravity=a;this.m_inv_dt0=0;this.m_contactManager.m_world=this;this.m_groundBody=this.CreateBody(new E)};t.prototype.SetDestructionListener=function(a){this.m_destructionListener=a};t.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a};t.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a};t.prototype.SetDebugDraw=
function(a){this.m_debugDraw=a};t.prototype.SetBroadPhase=function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;c;c=c.m_next)for(var f=c.m_fixtureList;f;f=f.m_next)f.m_proxy=a.CreateProxy(b.GetFatAABB(f.m_proxy),f)};t.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()};t.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};t.prototype.CreateBody=function(a){if(!0==this.IsLocked())return null;
a=new m(a,this);a.m_prev=null;if(a.m_next=this.m_bodyList)this.m_bodyList.m_prev=a;this.m_bodyList=a;++this.m_bodyCount;return a};t.prototype.DestroyBody=function(a){if(!0!=this.IsLocked()){for(var b=a.m_jointList;b;){var c=b,b=b.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(c.joint);this.DestroyJoint(c.joint)}for(b=a.m_controllerList;b;)c=b,b=b.nextController,c.controller.RemoveBody(a);for(b=a.m_contactList;b;)c=b,b=b.next,this.m_contactManager.Destroy(c.contact);a.m_contactList=
null;for(b=a.m_fixtureList;b;)c=b,b=b.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(c),c.DestroyProxy(this.m_contactManager.m_broadPhase),c.Destroy();a.m_fixtureList=null;a.m_fixtureCount=0;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}};t.prototype.CreateJoint=function(a){var b=P.Create(a,null);b.m_prev=null;if(b.m_next=this.m_jointList)this.m_jointList.m_prev=b;this.m_jointList=
b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;if(b.m_edgeA.next=b.m_bodyA.m_jointList)b.m_bodyA.m_jointList.prev=b.m_edgeA;b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;b.m_edgeB.prev=null;if(b.m_edgeB.next=b.m_bodyB.m_jointList)b.m_bodyB.m_jointList.prev=b.m_edgeB;b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,f=a.bodyB;if(!1==a.collideConnected)for(a=f.GetContactList();a;)a.other==c&&a.contact.FlagForFiltering(),a=a.next;return b};
t.prototype.DestroyJoint=function(a){var b=a.m_collideConnected;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,f=a.m_bodyB;c.SetAwake(!0);f.SetAwake(!0);a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next);a.m_edgeA.prev=null;a.m_edgeA.next=null;a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);
a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB==f.m_jointList&&(f.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;P.Destroy(a,null);--this.m_jointCount;if(!1==b)for(a=f.GetContactList();a;)a.other==c&&a.contact.FlagForFiltering(),a=a.next};t.prototype.AddController=function(a){a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList=a;a.m_world=this;this.m_controllerCount++;return a};t.prototype.RemoveController=function(a){a.m_prev&&(a.m_prev.m_next=
a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList==a&&(this.m_controllerList=a.m_next);this.m_controllerCount--};t.prototype.CreateController=function(a){if(a.m_world!=this)throw Error("Controller can only be a member of one world");a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;a.m_world=this;return a};t.prototype.DestroyController=function(a){a.Clear();a.m_next&&(a.m_next.m_prev=
a.m_prev);a.m_prev&&(a.m_prev.m_next=a.m_next);a==this.m_controllerList&&(this.m_controllerList=a.m_next);--this.m_controllerCount};t.prototype.SetWarmStarting=function(a){t.m_warmStarting=a};t.prototype.SetContinuousPhysics=function(a){t.m_continuousPhysics=a};t.prototype.GetBodyCount=function(){return this.m_bodyCount};t.prototype.GetJointCount=function(){return this.m_jointCount};t.prototype.GetContactCount=function(){return this.m_contactCount};t.prototype.SetGravity=function(a){this.m_gravity=
a};t.prototype.GetGravity=function(){return this.m_gravity};t.prototype.GetGroundBody=function(){return this.m_groundBody};t.prototype.Step=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=0);void 0===c&&(c=0);this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture);this.m_flags|=t.e_locked;var f=t.s_timestep2;f.dt=a;f.velocityIterations=b;f.positionIterations=c;f.inv_dt=0<a?1/a:0;f.dtRatio=this.m_inv_dt0*a;f.warmStarting=t.m_warmStarting;this.m_contactManager.Collide();
0<f.dt&&this.Solve(f);t.m_continuousPhysics&&0<f.dt&&this.SolveTOI(f);0<f.dt&&(this.m_inv_dt0=f.inv_dt);this.m_flags&=~t.e_locked};t.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0};t.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var a=this.m_debugDraw.GetFlags(),b,c,d;new f;new f;new f;var q;new g;new g;new f;new f;new f;new f;var y=new e(0,0,0);if(a&C.e_shapeBit)for(b=this.m_bodyList;b;b=
b.m_next){q=b.m_xf;for(c=b.GetFixtureList();c;c=c.m_next)d=c.GetShape(),!1==b.IsActive()?y.Set(0.5,0.5,0.3):b.GetType()==m.b2_staticBody?y.Set(0.5,0.9,0.5):b.GetType()==m.b2_kinematicBody?y.Set(0.5,0.5,0.9):!1==b.IsAwake()?y.Set(0.6,0.6,0.6):y.Set(0.9,0.7,0.7),this.DrawShape(d,q,y)}if(a&C.e_jointBit)for(b=this.m_jointList;b;b=b.m_next)this.DrawJoint(b);if(a&C.e_controllerBit)for(b=this.m_controllerList;b;b=b.m_next)b.Draw(this.m_debugDraw);if(a&C.e_pairBit){y.Set(0.3,0.9,0.9);for(b=this.m_contactManager.m_contactList;b;b=
b.GetNext())d=b.GetFixtureA(),c=b.GetFixtureB(),d=d.GetAABB().GetCenter(),c=c.GetAABB().GetCenter(),this.m_debugDraw.DrawSegment(d,c,y)}if(a&C.e_aabbBit){d=this.m_contactManager.m_broadPhase;q=[new f,new f,new f,new f];for(b=this.m_bodyList;b;b=b.GetNext())if(!1!=b.IsActive())for(c=b.GetFixtureList();c;c=c.GetNext()){var h=d.GetFatAABB(c.m_proxy);q[0].Set(h.lowerBound.x,h.lowerBound.y);q[1].Set(h.upperBound.x,h.lowerBound.y);q[2].Set(h.upperBound.x,h.upperBound.y);q[3].Set(h.lowerBound.x,h.upperBound.y);
this.m_debugDraw.DrawPolygon(q,4,y)}}if(a&C.e_centerOfMassBit)for(b=this.m_bodyList;b;b=b.m_next)q=t.s_xf,q.R=b.m_xf.R,q.position=b.GetWorldCenter(),this.m_debugDraw.DrawTransform(q)}};t.prototype.QueryAABB=function(a,b){var c=this.m_contactManager.m_broadPhase;c.Query(function(b){return a(c.GetUserData(b))},b)};t.prototype.QueryShape=function(b,c,f){void 0===f&&(f=null);null==f&&(f=new a,f.SetIdentity());var e=this.m_contactManager.m_broadPhase,d=new g;c.ComputeAABB(d,f);e.Query(function(a){a=e.GetUserData(a)instanceof
I?e.GetUserData(a):null;return F.TestOverlap(c,f,a.GetShape(),a.GetBody().GetTransform())?b(a):!0},d)};t.prototype.QueryPoint=function(a,b){var c=this.m_contactManager.m_broadPhase,f=new g;f.lowerBound.Set(b.x-d.b2_linearSlop,b.y-d.b2_linearSlop);f.upperBound.Set(b.x+d.b2_linearSlop,b.y+d.b2_linearSlop);c.Query(function(f){f=c.GetUserData(f)instanceof I?c.GetUserData(f):null;return f.TestPoint(b)?a(f):!0},f)};t.prototype.RayCast=function(a,b,c){var e=this.m_contactManager.m_broadPhase,d=new r,q=new l(b,
c);e.RayCast(function(q,g){var t=e.GetUserData(g),t=t instanceof I?t:null;if(t.RayCast(d,q)){var y=d.fraction,h=new f((1-y)*b.x+y*c.x,(1-y)*b.y+y*c.y);return a(t,h,d.normal,y)}return q.maxFraction},q)};t.prototype.RayCastOne=function(a,b){var c;this.RayCast(function(a,b,f,e){void 0===e&&(e=0);c=a;return e},a,b);return c};t.prototype.RayCastAll=function(a,b){var c=new Vector;this.RayCast(function(a){c[c.length]=a;return 1},a,b);return c};t.prototype.GetBodyList=function(){return this.m_bodyList};t.prototype.GetJointList=
function(){return this.m_jointList};t.prototype.GetContactList=function(){return this.m_contactList};t.prototype.IsLocked=function(){return 0<(this.m_flags&t.e_locked)};t.prototype.Solve=function(a){for(var b,c=this.m_controllerList;c;c=c.m_next)c.Step(a);c=this.m_island;c.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~m.e_islandFlag;for(var f=this.m_contactList;f;f=
f.m_next)f.m_flags&=~B.e_islandFlag;for(f=this.m_jointList;f;f=f.m_next)f.m_islandFlag=!1;parseInt(this.m_bodyCount);for(var f=this.s_stack,e=this.m_bodyList;e;e=e.m_next)if(!(e.m_flags&m.e_islandFlag)&&!(!1==e.IsAwake()||!1==e.IsActive())&&e.GetType()!=m.b2_staticBody){c.Clear();var d=0;f[d++]=e;for(e.m_flags|=m.e_islandFlag;0<d;)if(b=f[--d],c.AddBody(b),!1==b.IsAwake()&&b.SetAwake(!0),b.GetType()!=m.b2_staticBody){for(var q,g=b.m_contactList;g;g=g.next)if(!(g.contact.m_flags&B.e_islandFlag)&&!(!0==
g.contact.IsSensor()||!1==g.contact.IsEnabled()||!1==g.contact.IsTouching()))c.AddContact(g.contact),g.contact.m_flags|=B.e_islandFlag,q=g.other,q.m_flags&m.e_islandFlag||(f[d++]=q,q.m_flags|=m.e_islandFlag);for(b=b.m_jointList;b;b=b.next)!0!=b.joint.m_islandFlag&&(q=b.other,!1!=q.IsActive()&&(c.AddJoint(b.joint),b.joint.m_islandFlag=!0,q.m_flags&m.e_islandFlag||(f[d++]=q,q.m_flags|=m.e_islandFlag)))}c.Solve(a,this.m_gravity,this.m_allowSleep);for(d=0;d<c.m_bodyCount;++d)b=c.m_bodies[d],b.GetType()==
m.b2_staticBody&&(b.m_flags&=~m.e_islandFlag)}for(d=0;d<f.length&&f[d];++d)f[d]=null;for(b=this.m_bodyList;b;b=b.m_next)!1==b.IsAwake()||!1==b.IsActive()||b.GetType()!=m.b2_staticBody&&b.SynchronizeFixtures();this.m_contactManager.FindNewContacts()};t.prototype.SolveTOI=function(a){var b,c,f,e=this.m_island;e.Initialize(this.m_bodyCount,d.b2_maxTOIContactsPerIsland,d.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var q=t.s_queue;for(b=this.m_bodyList;b;b=
b.m_next)b.m_flags&=~m.e_islandFlag,b.m_sweep.t0=0;for(f=this.m_contactList;f;f=f.m_next)f.m_flags&=~(B.e_toiFlag|B.e_islandFlag);for(f=this.m_jointList;f;f=f.m_next)f.m_islandFlag=!1;for(;;){var g=null,y=1;for(f=this.m_contactList;f;f=f.m_next)if(!(!0==f.IsSensor()||!1==f.IsEnabled()||!1==f.IsContinuous())){if(f.m_flags&B.e_toiFlag)b=f.m_toi;else{b=f.m_fixtureA;c=f.m_fixtureB;b=b.m_body;c=c.m_body;if((b.GetType()!=m.b2_dynamicBody||!1==b.IsAwake())&&(c.GetType()!=m.b2_dynamicBody||!1==c.IsAwake()))continue;
var h=b.m_sweep.t0;b.m_sweep.t0<c.m_sweep.t0?(h=c.m_sweep.t0,b.m_sweep.Advance(h)):c.m_sweep.t0<b.m_sweep.t0&&(h=b.m_sweep.t0,c.m_sweep.Advance(h));b=f.ComputeTOI(b.m_sweep,c.m_sweep);d.b2Assert(0<=b&&1>=b);0<b&&1>b&&(b=(1-b)*h+b,1<b&&(b=1));f.m_toi=b;f.m_flags|=B.e_toiFlag}Number.MIN_VALUE<b&&b<y&&(g=f,y=b)}if(null==g||1-100*Number.MIN_VALUE<y)break;b=g.m_fixtureA;c=g.m_fixtureB;b=b.m_body;c=c.m_body;t.s_backupA.Set(b.m_sweep);t.s_backupB.Set(c.m_sweep);b.Advance(y);c.Advance(y);g.Update(this.m_contactManager.m_contactListener);
g.m_flags&=~B.e_toiFlag;if(!0==g.IsSensor()||!1==g.IsEnabled())b.m_sweep.Set(t.s_backupA),c.m_sweep.Set(t.s_backupB),b.SynchronizeTransform(),c.SynchronizeTransform();else if(!1!=g.IsTouching()){b.GetType()!=m.b2_dynamicBody&&(b=c);e.Clear();g=f=0;q[f+g++]=b;for(b.m_flags|=m.e_islandFlag;0<g;)if(b=q[f++],--g,e.AddBody(b),!1==b.IsAwake()&&b.SetAwake(!0),b.GetType()==m.b2_dynamicBody){for(c=b.m_contactList;c&&e.m_contactCount!=e.m_contactCapacity;c=c.next)if(!(c.contact.m_flags&B.e_islandFlag)&&!(!0==
c.contact.IsSensor()||!1==c.contact.IsEnabled()||!1==c.contact.IsTouching()))e.AddContact(c.contact),c.contact.m_flags|=B.e_islandFlag,h=c.other,h.m_flags&m.e_islandFlag||(h.GetType()!=m.b2_staticBody&&(h.Advance(y),h.SetAwake(!0)),q[f+g]=h,++g,h.m_flags|=m.e_islandFlag);for(b=b.m_jointList;b;b=b.next)e.m_jointCount!=e.m_jointCapacity&&!0!=b.joint.m_islandFlag&&(h=b.other,!1!=h.IsActive()&&(e.AddJoint(b.joint),b.joint.m_islandFlag=!0,h.m_flags&m.e_islandFlag||(h.GetType()!=m.b2_staticBody&&(h.Advance(y),
h.SetAwake(!0)),q[f+g]=h,++g,h.m_flags|=m.e_islandFlag)))}f=t.s_timestep;f.warmStarting=!1;f.dt=(1-y)*a.dt;f.inv_dt=1/f.dt;f.dtRatio=0;f.velocityIterations=a.velocityIterations;f.positionIterations=a.positionIterations;e.SolveTOI(f);for(y=y=0;y<e.m_bodyCount;++y)if(b=e.m_bodies[y],b.m_flags&=~m.e_islandFlag,!1!=b.IsAwake()&&b.GetType()==m.b2_dynamicBody){b.SynchronizeFixtures();for(c=b.m_contactList;c;c=c.next)c.contact.m_flags&=~B.e_toiFlag}for(y=0;y<e.m_contactCount;++y)f=e.m_contacts[y],f.m_flags&=
~(B.e_toiFlag|B.e_islandFlag);for(y=0;y<e.m_jointCount;++y)f=e.m_joints[y],f.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}};t.prototype.DrawJoint=function(a){var b=a.GetBodyA(),c=a.GetBodyB(),f=b.m_xf.position,e=c.m_xf.position,d=a.GetAnchorA(),q=a.GetAnchorB(),g=t.s_jointColor;switch(a.m_type){case P.e_distanceJoint:this.m_debugDraw.DrawSegment(d,q,g);break;case P.e_pulleyJoint:b=a instanceof O?a:null;a=b.GetGroundAnchorA();b=b.GetGroundAnchorB();this.m_debugDraw.DrawSegment(a,d,g);this.m_debugDraw.DrawSegment(b,
q,g);this.m_debugDraw.DrawSegment(a,b,g);break;case P.e_mouseJoint:this.m_debugDraw.DrawSegment(d,q,g);break;default:b!=this.m_groundBody&&this.m_debugDraw.DrawSegment(f,d,g),this.m_debugDraw.DrawSegment(d,q,g),c!=this.m_groundBody&&this.m_debugDraw.DrawSegment(e,q,g)}};t.prototype.DrawShape=function(a,c,f){switch(a.m_type){case F.e_circleShape:var e=a instanceof s?a:null;this.m_debugDraw.DrawSolidCircle(b.MulX(c,e.m_p),e.m_radius,c.R.col1,f);break;case F.e_polygonShape:e=a instanceof w?a:null;a=
parseInt(e.GetVertexCount());for(var d=e.GetVertices(),q=new Vector(a),e=0;e<a;++e)q[e]=b.MulX(c,d[e]);this.m_debugDraw.DrawSolidPolygon(q,a,f);break;case F.e_edgeShape:e=a instanceof x?a:null,this.m_debugDraw.DrawSegment(b.MulX(c,e.GetVertex1()),b.MulX(c,e.GetVertex2()),f)}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new q;Box2D.Dynamics.b2World.s_xf=new a;Box2D.Dynamics.b2World.s_backupA=new c;Box2D.Dynamics.b2World.s_backupB=new c;Box2D.Dynamics.b2World.s_timestep=new q;
Box2D.Dynamics.b2World.s_queue=new Vector;Box2D.Dynamics.b2World.s_jointColor=new e(0.5,0.8,0.8);Box2D.Dynamics.b2World.e_newFixture=1;Box2D.Dynamics.b2World.e_locked=2})})();
(function(){var b=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Collision.Shapes.b2EdgeShape,a=Box2D.Collision.Shapes.b2PolygonShape,f=Box2D.Collision.Shapes.b2Shape,e=Box2D.Dynamics.Contacts.b2CircleContact,d=Box2D.Dynamics.Contacts.b2Contact,g=Box2D.Dynamics.Contacts.b2ContactConstraint,h=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,k=Box2D.Dynamics.Contacts.b2ContactEdge,l=Box2D.Dynamics.Contacts.b2ContactFactory,r=Box2D.Dynamics.Contacts.b2ContactRegister,s=Box2D.Dynamics.Contacts.b2ContactResult,
x=Box2D.Dynamics.Contacts.b2ContactSolver,v=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,w=Box2D.Dynamics.Contacts.b2NullContact,F=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,m=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,E=Box2D.Dynamics.Contacts.b2PolygonContact,A=Box2D.Dynamics.Contacts.b2PositionSolverManifold,z=Box2D.Dynamics.b2Body,D=Box2D.Dynamics.b2TimeStep,H=Box2D.Common.b2Settings,C=Box2D.Common.Math.b2Mat22,M=Box2D.Common.Math.b2Math,G=Box2D.Common.Math.b2Vec2,I=Box2D.Collision.b2Collision,
N=Box2D.Collision.b2ContactID,L=Box2D.Collision.b2Manifold,q=Box2D.Collision.b2TimeOfImpact,t=Box2D.Collision.b2TOIInput,B=Box2D.Collision.b2WorldManifold;Box2D.inherit(e,Box2D.Dynamics.Contacts.b2Contact);e.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;e.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};e.Create=function(){return new e};e.Destroy=function(){};e.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b)};e.prototype.Evaluate=
function(){var a=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody();I.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof b?this.m_fixtureA.GetShape():null,a.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,c.m_xf)};d.b2Contact=function(){this.m_nodeA=new k;this.m_nodeB=new k;this.m_manifold=new L;this.m_oldManifold=new L};d.prototype.GetManifold=function(){return this.m_manifold};d.prototype.GetWorldManifold=function(a){var b=this.m_fixtureA.GetBody(),
c=this.m_fixtureB.GetBody(),f=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();a.Initialize(this.m_manifold,b.GetTransform(),f.m_radius,c.GetTransform(),e.m_radius)};d.prototype.IsTouching=function(){return(this.m_flags&d.e_touchingFlag)==d.e_touchingFlag};d.prototype.IsContinuous=function(){return(this.m_flags&d.e_continuousFlag)==d.e_continuousFlag};d.prototype.SetSensor=function(a){this.m_flags=a?this.m_flags|d.e_sensorFlag:this.m_flags&~d.e_sensorFlag};d.prototype.IsSensor=function(){return(this.m_flags&
d.e_sensorFlag)==d.e_sensorFlag};d.prototype.SetEnabled=function(a){this.m_flags=a?this.m_flags|d.e_enabledFlag:this.m_flags&~d.e_enabledFlag};d.prototype.IsEnabled=function(){return(this.m_flags&d.e_enabledFlag)==d.e_enabledFlag};d.prototype.GetNext=function(){return this.m_next};d.prototype.GetFixtureA=function(){return this.m_fixtureA};d.prototype.GetFixtureB=function(){return this.m_fixtureB};d.prototype.FlagForFiltering=function(){this.m_flags|=d.e_filterFlag};d.prototype.b2Contact=function(){};
d.prototype.Reset=function(a,b){void 0===a&&(a=null);void 0===b&&(b=null);this.m_flags=d.e_enabledFlag;if(!a||!b)this.m_fixtureB=this.m_fixtureA=null;else{if(a.IsSensor()||b.IsSensor())this.m_flags|=d.e_sensorFlag;var c=a.GetBody(),f=b.GetBody();if(c.GetType()!=z.b2_dynamicBody||c.IsBullet()||f.GetType()!=z.b2_dynamicBody||f.IsBullet())this.m_flags|=d.e_continuousFlag;this.m_fixtureA=a;this.m_fixtureB=b;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=
null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}};d.prototype.Update=function(a){var b=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=b;this.m_flags|=d.e_enabledFlag;var c=!1,b=(this.m_flags&d.e_touchingFlag)==d.e_touchingFlag,e=this.m_fixtureA.m_body,q=this.m_fixtureB.m_body,g=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&d.e_sensorFlag)g&&(c=this.m_fixtureA.GetShape(),
g=this.m_fixtureB.GetShape(),e=e.GetTransform(),q=q.GetTransform(),c=f.TestOverlap(c,e,g,q)),this.m_manifold.m_pointCount=0;else{e.GetType()!=z.b2_dynamicBody||e.IsBullet()||q.GetType()!=z.b2_dynamicBody||q.IsBullet()?this.m_flags|=d.e_continuousFlag:this.m_flags&=~d.e_continuousFlag;if(g){this.Evaluate();c=0<this.m_manifold.m_pointCount;for(g=0;g<this.m_manifold.m_pointCount;++g){var t=this.m_manifold.m_points[g];t.m_normalImpulse=0;t.m_tangentImpulse=0;for(var h=t.m_id,B=0;B<this.m_oldManifold.m_pointCount;++B){var k=
this.m_oldManifold.m_points[B];if(k.m_id.key==h.key){t.m_normalImpulse=k.m_normalImpulse;t.m_tangentImpulse=k.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;c!=b&&(e.SetAwake(!0),q.SetAwake(!0))}this.m_flags=c?this.m_flags|d.e_touchingFlag:this.m_flags&~d.e_touchingFlag;!1==b&&!0==c&&a.BeginContact(this);!0==b&&!1==c&&a.EndContact(this);0==(this.m_flags&d.e_sensorFlag)&&a.PreSolve(this,this.m_oldManifold)};d.prototype.Evaluate=function(){};d.prototype.ComputeTOI=function(a,b){d.s_input.proxyA.Set(this.m_fixtureA.GetShape());
d.s_input.proxyB.Set(this.m_fixtureB.GetShape());d.s_input.sweepA=a;d.s_input.sweepB=b;d.s_input.tolerance=H.b2_linearSlop;return q.TimeOfImpact(d.s_input)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1;Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2;Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4;Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8;Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16;Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32;Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=
64;Box2D.Dynamics.Contacts.b2Contact.s_input=new t});g.b2ContactConstraint=function(){this.localPlaneNormal=new G;this.localPoint=new G;this.normal=new G;this.normalMass=new C;this.K=new C};g.prototype.b2ContactConstraint=function(){this.points=new Vector(H.b2_maxManifoldPoints);for(var a=0;a<H.b2_maxManifoldPoints;a++)this.points[a]=new h};h.b2ContactConstraintPoint=function(){this.localPoint=new G;this.rA=new G;this.rB=new G};k.b2ContactEdge=function(){};l.b2ContactFactory=function(){};l.prototype.b2ContactFactory=
function(a){this.m_allocator=a;this.InitializeRegisters()};l.prototype.AddType=function(a,b,c,f){void 0===c&&(c=0);void 0===f&&(f=0);this.m_registers[c][f].createFcn=a;this.m_registers[c][f].destroyFcn=b;this.m_registers[c][f].primary=!0;c!=f&&(this.m_registers[f][c].createFcn=a,this.m_registers[f][c].destroyFcn=b,this.m_registers[f][c].primary=!1)};l.prototype.InitializeRegisters=function(){this.m_registers=new Vector(f.e_shapeTypeCount);for(var a=0;a<f.e_shapeTypeCount;a++){this.m_registers[a]=
new Vector(f.e_shapeTypeCount);for(var b=0;b<f.e_shapeTypeCount;b++)this.m_registers[a][b]=new r}this.AddType(e.Create,e.Destroy,f.e_circleShape,f.e_circleShape);this.AddType(F.Create,F.Destroy,f.e_polygonShape,f.e_circleShape);this.AddType(E.Create,E.Destroy,f.e_polygonShape,f.e_polygonShape);this.AddType(v.Create,v.Destroy,f.e_edgeShape,f.e_circleShape);this.AddType(m.Create,m.Destroy,f.e_polygonShape,f.e_edgeShape)};l.prototype.Create=function(a,b){var c=parseInt(a.GetType()),f=parseInt(b.GetType()),
c=this.m_registers[c][f];if(c.pool)return f=c.pool,c.pool=f.m_next,c.poolCount--,f.Reset(a,b),f;f=c.createFcn;return null!=f?(c.primary?(f=f(this.m_allocator),f.Reset(a,b)):(f=f(this.m_allocator),f.Reset(b,a)),f):null};l.prototype.Destroy=function(a){0<a.m_manifold.m_pointCount&&(a.m_fixtureA.m_body.SetAwake(!0),a.m_fixtureB.m_body.SetAwake(!0));var b=parseInt(a.m_fixtureA.GetType()),c=parseInt(a.m_fixtureB.GetType()),b=this.m_registers[b][c];b.poolCount++;a.m_next=b.pool;b.pool=a;b=b.destroyFcn;
b(a,this.m_allocator)};r.b2ContactRegister=function(){};s.b2ContactResult=function(){this.position=new G;this.normal=new G;this.id=new N};x.b2ContactSolver=function(){this.m_step=new D;this.m_constraints=new Vector};x.prototype.b2ContactSolver=function(){};x.prototype.Initialize=function(a,b,c,f){void 0===c&&(c=0);var e;this.m_step.Set(a);this.m_allocator=f;for(this.m_constraintCount=c;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new g;for(a=0;a<
c;++a){e=b[a];f=e.m_fixtureA;var d=e.m_fixtureB,q=f.m_shape.m_radius,t=d.m_shape.m_radius,h=f.m_body,B=d.m_body,k=e.GetManifold(),m=H.b2MixFriction(f.GetFriction(),d.GetFriction()),s=H.b2MixRestitution(f.GetRestitution(),d.GetRestitution()),l=h.m_linearVelocity.x,r=h.m_linearVelocity.y,v=B.m_linearVelocity.x,w=B.m_linearVelocity.y,A=h.m_angularVelocity,F=B.m_angularVelocity;H.b2Assert(0<k.m_pointCount);x.s_worldManifold.Initialize(k,h.m_xf,q,B.m_xf,t);d=x.s_worldManifold.m_normal.x;e=x.s_worldManifold.m_normal.y;
f=this.m_constraints[a];f.bodyA=h;f.bodyB=B;f.manifold=k;f.normal.x=d;f.normal.y=e;f.pointCount=k.m_pointCount;f.friction=m;f.restitution=s;f.localPlaneNormal.x=k.m_localPlaneNormal.x;f.localPlaneNormal.y=k.m_localPlaneNormal.y;f.localPoint.x=k.m_localPoint.x;f.localPoint.y=k.m_localPoint.y;f.radius=q+t;f.type=k.m_type;for(q=0;q<f.pointCount;++q){m=k.m_points[q];t=f.points[q];t.normalImpulse=m.m_normalImpulse;t.tangentImpulse=m.m_tangentImpulse;t.localPoint.SetV(m.m_localPoint);var m=t.rA.x=x.s_worldManifold.m_points[q].x-
h.m_sweep.c.x,s=t.rA.y=x.s_worldManifold.m_points[q].y-h.m_sweep.c.y,D=t.rB.x=x.s_worldManifold.m_points[q].x-B.m_sweep.c.x,C=t.rB.y=x.s_worldManifold.m_points[q].y-B.m_sweep.c.y,E=m*e-s*d,z=D*e-C*d,E=E*E,z=z*z;t.normalMass=1/(h.m_invMass+B.m_invMass+h.m_invI*E+B.m_invI*z);var G=h.m_mass*h.m_invMass+B.m_mass*B.m_invMass,G=G+(h.m_mass*h.m_invI*E+B.m_mass*B.m_invI*z);t.equalizedMass=1/G;z=e;G=-d;E=m*G-s*z;z=D*G-C*z;E*=E;z*=z;t.tangentMass=1/(h.m_invMass+B.m_invMass+h.m_invI*E+B.m_invI*z);t.velocityBias=
0;m=f.normal.x*(v+-F*C-l- -A*s)+f.normal.y*(w+F*D-r-A*m);m<-H.b2_velocityThreshold&&(t.velocityBias+=-f.restitution*m)}2==f.pointCount&&(w=f.points[0],v=f.points[1],k=h.m_invMass,h=h.m_invI,l=B.m_invMass,B=B.m_invI,r=w.rA.x*e-w.rA.y*d,w=w.rB.x*e-w.rB.y*d,A=v.rA.x*e-v.rA.y*d,v=v.rB.x*e-v.rB.y*d,d=k+l+h*r*r+B*w*w,e=k+l+h*A*A+B*v*v,B=k+l+h*r*A+B*w*v,d*d<100*(d*e-B*B)?(f.K.col1.Set(d,B),f.K.col2.Set(B,e),f.K.GetInverse(f.normalMass)):f.pointCount=1)}};x.prototype.InitVelocityConstraints=function(a){for(var b=
0;b<this.m_constraintCount;++b){var c=this.m_constraints[b],f=c.bodyA,e=c.bodyB,d=f.m_invMass,q=f.m_invI,g=e.m_invMass,t=e.m_invI,h=c.normal.x,B=c.normal.y,k=B,m=-h,s=0,l=0;if(a.warmStarting){l=c.pointCount;for(s=0;s<l;++s){var r=c.points[s];r.normalImpulse*=a.dtRatio;r.tangentImpulse*=a.dtRatio;var v=r.normalImpulse*h+r.tangentImpulse*k,x=r.normalImpulse*B+r.tangentImpulse*m;f.m_angularVelocity-=q*(r.rA.x*x-r.rA.y*v);f.m_linearVelocity.x-=d*v;f.m_linearVelocity.y-=d*x;e.m_angularVelocity+=t*(r.rB.x*
x-r.rB.y*v);e.m_linearVelocity.x+=g*v;e.m_linearVelocity.y+=g*x}}else{l=c.pointCount;for(s=0;s<l;++s)f=c.points[s],f.normalImpulse=0,f.tangentImpulse=0}}};x.prototype.SolveVelocityConstraints=function(){for(var a=0,b,c=0,f=0,e=0,d=0,q=0,g=0,t=0,h,B=0;B<this.m_constraintCount;++B){var e=this.m_constraints[B],k=e.bodyA,m=e.bodyB,s=k.m_angularVelocity,l=m.m_angularVelocity,r=k.m_linearVelocity,v=m.m_linearVelocity,x=k.m_invMass,w=k.m_invI,A=m.m_invMass,F=m.m_invI,g=e.normal.x,z=t=e.normal.y;h=-g;q=e.friction;
for(a=0;a<e.pointCount;a++)b=e.points[a],c=v.x-l*b.rB.y-r.x+s*b.rA.y,f=v.y+l*b.rB.x-r.y-s*b.rA.x,c=c*z+f*h,c=b.tangentMass*-c,f=q*b.normalImpulse,f=M.Clamp(b.tangentImpulse+c,-f,f),c=f-b.tangentImpulse,d=c*z,c*=h,r.x-=x*d,r.y-=x*c,s-=w*(b.rA.x*c-b.rA.y*d),v.x+=A*d,v.y+=A*c,l+=F*(b.rB.x*c-b.rB.y*d),b.tangentImpulse=f;parseInt(e.pointCount);if(1==e.pointCount)b=e.points[0],c=v.x+-l*b.rB.y-r.x- -s*b.rA.y,f=v.y+l*b.rB.x-r.y-s*b.rA.x,e=c*g+f*t,c=-b.normalMass*(e-b.velocityBias),f=b.normalImpulse+c,f=0<
f?f:0,c=f-b.normalImpulse,d=c*g,c*=t,r.x-=x*d,r.y-=x*c,s-=w*(b.rA.x*c-b.rA.y*d),v.x+=A*d,v.y+=A*c,l+=F*(b.rB.x*c-b.rB.y*d),b.normalImpulse=f;else{b=e.points[0];var a=e.points[1],c=b.normalImpulse,q=a.normalImpulse,D=(v.x-l*b.rB.y-r.x+s*b.rA.y)*g+(v.y+l*b.rB.x-r.y-s*b.rA.x)*t,E=(v.x-l*a.rB.y-r.x+s*a.rA.y)*g+(v.y+l*a.rB.x-r.y-s*a.rA.x)*t,f=D-b.velocityBias,d=E-a.velocityBias;h=e.K;f-=h.col1.x*c+h.col2.x*q;for(d-=h.col1.y*c+h.col2.y*q;;){h=e.normalMass;z=-(h.col1.x*f+h.col2.x*d);h=-(h.col1.y*f+h.col2.y*
d);if(0<=z&&0<=h){c=z-c;q=h-q;e=c*g;c*=t;g*=q;t*=q;r.x-=x*(e+g);r.y-=x*(c+t);s-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*t-a.rA.y*g);v.x+=A*(e+g);v.y+=A*(c+t);l+=F*(b.rB.x*c-b.rB.y*e+a.rB.x*t-a.rB.y*g);b.normalImpulse=z;a.normalImpulse=h;break}z=-b.normalMass*f;h=0;E=e.K.col1.y*z+d;if(0<=z&&0<=E){c=z-c;q=h-q;e=c*g;c*=t;g*=q;t*=q;r.x-=x*(e+g);r.y-=x*(c+t);s-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*t-a.rA.y*g);v.x+=A*(e+g);v.y+=A*(c+t);l+=F*(b.rB.x*c-b.rB.y*e+a.rB.x*t-a.rB.y*g);b.normalImpulse=z;a.normalImpulse=h;break}z=0;
h=-a.normalMass*d;D=e.K.col2.x*h+f;if(0<=h&&0<=D){c=z-c;q=h-q;e=c*g;c*=t;g*=q;t*=q;r.x-=x*(e+g);r.y-=x*(c+t);s-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*t-a.rA.y*g);v.x+=A*(e+g);v.y+=A*(c+t);l+=F*(b.rB.x*c-b.rB.y*e+a.rB.x*t-a.rB.y*g);b.normalImpulse=z;a.normalImpulse=h;break}h=z=0;D=f;E=d;if(0<=D&&0<=E){c=z-c;q=h-q;e=c*g;c*=t;g*=q;t*=q;r.x-=x*(e+g);r.y-=x*(c+t);s-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*t-a.rA.y*g);v.x+=A*(e+g);v.y+=A*(c+t);l+=F*(b.rB.x*c-b.rB.y*e+a.rB.x*t-a.rB.y*g);b.normalImpulse=z;a.normalImpulse=h;break}break}}k.m_angularVelocity=
s;m.m_angularVelocity=l}};x.prototype.FinalizeVelocityConstraints=function(){for(var a=0;a<this.m_constraintCount;++a)for(var b=this.m_constraints[a],c=b.manifold,f=0;f<b.pointCount;++f){var e=c.m_points[f],d=b.points[f];e.m_normalImpulse=d.normalImpulse;e.m_tangentImpulse=d.tangentImpulse}};x.prototype.SolvePositionConstraints=function(a){void 0===a&&(a=0);for(var b=0,c=0;c<this.m_constraintCount;c++){var f=this.m_constraints[c],e=f.bodyA,d=f.bodyB,q=e.m_mass*e.m_invMass,g=e.m_mass*e.m_invI,t=d.m_mass*
d.m_invMass,h=d.m_mass*d.m_invI;x.s_psm.Initialize(f);for(var B=x.s_psm.m_normal,k=0;k<f.pointCount;k++){var m=f.points[k],s=x.s_psm.m_points[k],l=x.s_psm.m_separations[k],r=s.x-e.m_sweep.c.x,v=s.y-e.m_sweep.c.y,w=s.x-d.m_sweep.c.x,s=s.y-d.m_sweep.c.y,b=b<l?b:l,l=M.Clamp(a*(l+H.b2_linearSlop),-H.b2_maxLinearCorrection,0),l=-m.equalizedMass*l,m=l*B.x,l=l*B.y;e.m_sweep.c.x-=q*m;e.m_sweep.c.y-=q*l;e.m_sweep.a-=g*(r*l-v*m);e.SynchronizeTransform();d.m_sweep.c.x+=t*m;d.m_sweep.c.y+=t*l;d.m_sweep.a+=h*
(w*l-s*m);d.SynchronizeTransform()}}return b>-1.5*H.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new B;Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new A});Box2D.inherit(v,Box2D.Dynamics.Contacts.b2Contact);v.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;v.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};v.Create=function(){return new v};v.Destroy=function(){};v.prototype.Reset=
function(a,b){this.__super.Reset.call(this,a,b)};v.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),f=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof c?this.m_fixtureA.GetShape():null,a.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,f.m_xf)};v.prototype.b2CollideEdgeAndCircle=function(){};Box2D.inherit(w,Box2D.Dynamics.Contacts.b2Contact);w.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
w.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};w.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)};w.prototype.Evaluate=function(){};Box2D.inherit(F,Box2D.Dynamics.Contacts.b2Contact);F.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;F.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};F.Create=function(){return new F};F.Destroy=function(){};F.prototype.Reset=function(a,
b){this.__super.Reset.call(this,a,b);H.b2Assert(a.GetType()==f.e_polygonShape);H.b2Assert(b.GetType()==f.e_circleShape)};F.prototype.Evaluate=function(){var c=this.m_fixtureA.m_body,f=this.m_fixtureB.m_body;I.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof a?this.m_fixtureA.GetShape():null,c.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,f.m_xf)};Box2D.inherit(m,Box2D.Dynamics.Contacts.b2Contact);m.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
m.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};m.Create=function(){return new m};m.Destroy=function(){};m.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b);H.b2Assert(a.GetType()==f.e_polygonShape);H.b2Assert(b.GetType()==f.e_edgeShape)};m.prototype.Evaluate=function(){var b=this.m_fixtureA.GetBody(),f=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof a?this.m_fixtureA.GetShape():
null,b.m_xf,this.m_fixtureB.GetShape()instanceof c?this.m_fixtureB.GetShape():null,f.m_xf)};m.prototype.b2CollidePolyAndEdge=function(){};Box2D.inherit(E,Box2D.Dynamics.Contacts.b2Contact);E.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;E.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};E.Create=function(){return new E};E.Destroy=function(){};E.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b)};E.prototype.Evaluate=function(){var b=
this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody();I.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof a?this.m_fixtureA.GetShape():null,b.m_xf,this.m_fixtureB.GetShape()instanceof a?this.m_fixtureB.GetShape():null,c.m_xf)};A.b2PositionSolverManifold=function(){};A.prototype.b2PositionSolverManifold=function(){this.m_normal=new G;this.m_separations=new Vector_a2j_Number(H.b2_maxManifoldPoints);this.m_points=new Vector(H.b2_maxManifoldPoints);for(var a=0;a<H.b2_maxManifoldPoints;a++)this.m_points[a]=
new G};A.prototype.Initialize=function(a){H.b2Assert(0<a.pointCount);var b=0,c=0,f=0,e,d=0,q=0;switch(a.type){case L.e_circles:e=a.bodyA.m_xf.R;f=a.localPoint;b=a.bodyA.m_xf.position.x+(e.col1.x*f.x+e.col2.x*f.y);c=a.bodyA.m_xf.position.y+(e.col1.y*f.x+e.col2.y*f.y);e=a.bodyB.m_xf.R;f=a.points[0].localPoint;d=a.bodyB.m_xf.position.x+(e.col1.x*f.x+e.col2.x*f.y);e=a.bodyB.m_xf.position.y+(e.col1.y*f.x+e.col2.y*f.y);var f=d-b,q=e-c,g=f*f+q*q;g>Number.MIN_VALUE*Number.MIN_VALUE?(g=Math.sqrt(g),this.m_normal.x=
f/g,this.m_normal.y=q/g):(this.m_normal.x=1,this.m_normal.y=0);this.m_points[0].x=0.5*(b+d);this.m_points[0].y=0.5*(c+e);this.m_separations[0]=f*this.m_normal.x+q*this.m_normal.y-a.radius;break;case L.e_faceA:e=a.bodyA.m_xf.R;f=a.localPlaneNormal;this.m_normal.x=e.col1.x*f.x+e.col2.x*f.y;this.m_normal.y=e.col1.y*f.x+e.col2.y*f.y;e=a.bodyA.m_xf.R;f=a.localPoint;d=a.bodyA.m_xf.position.x+(e.col1.x*f.x+e.col2.x*f.y);q=a.bodyA.m_xf.position.y+(e.col1.y*f.x+e.col2.y*f.y);e=a.bodyB.m_xf.R;for(b=0;b<a.pointCount;++b)f=
a.points[b].localPoint,c=a.bodyB.m_xf.position.x+(e.col1.x*f.x+e.col2.x*f.y),f=a.bodyB.m_xf.position.y+(e.col1.y*f.x+e.col2.y*f.y),this.m_separations[b]=(c-d)*this.m_normal.x+(f-q)*this.m_normal.y-a.radius,this.m_points[b].x=c,this.m_points[b].y=f;break;case L.e_faceB:e=a.bodyB.m_xf.R;f=a.localPlaneNormal;this.m_normal.x=e.col1.x*f.x+e.col2.x*f.y;this.m_normal.y=e.col1.y*f.x+e.col2.y*f.y;e=a.bodyB.m_xf.R;f=a.localPoint;d=a.bodyB.m_xf.position.x+(e.col1.x*f.x+e.col2.x*f.y);q=a.bodyB.m_xf.position.y+
(e.col1.y*f.x+e.col2.y*f.y);e=a.bodyA.m_xf.R;for(b=0;b<a.pointCount;++b)f=a.points[b].localPoint,c=a.bodyA.m_xf.position.x+(e.col1.x*f.x+e.col2.x*f.y),f=a.bodyA.m_xf.position.y+(e.col1.y*f.x+e.col2.y*f.y),this.m_separations[b]=(c-d)*this.m_normal.x+(f-q)*this.m_normal.y-a.radius,this.m_points[b].Set(c,f);this.m_normal.x*=-1;this.m_normal.y*=-1}};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new G;Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=
new G})})();
(function(){var b=Box2D.Common.Math.b2Mat22,c=Box2D.Common.Math.b2Math,a=Box2D.Common.Math.b2Vec2,f=Box2D.Common.b2Color,e=Box2D.Dynamics.Controllers.b2BuoyancyController,d=Box2D.Dynamics.Controllers.b2ConstantAccelController,g=Box2D.Dynamics.Controllers.b2ConstantForceController,h=Box2D.Dynamics.Controllers.b2Controller,k=Box2D.Dynamics.Controllers.b2ControllerEdge,l=Box2D.Dynamics.Controllers.b2GravityController,r=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(e,Box2D.Dynamics.Controllers.b2Controller);
e.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;e.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.normal=new a(0,-1);this.density=this.offset=0;this.velocity=new a(0,0);this.linearDrag=2;this.angularDrag=1;this.useDensity=!1;this.useWorldGravity=!0;this.gravity=null};e.prototype.Step=function(){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var b=this.m_bodyList;b;b=
b.nextBody){var c=b.body;if(!1!=c.IsAwake()){for(var f=new a,e=new a,d=0,g=0,h=c.GetFixtureList();h;h=h.GetNext()){var k=new a,l=h.GetShape().ComputeSubmergedArea(this.normal,this.offset,c.GetTransform(),k),d=d+l;f.x+=l*k.x;f.y+=l*k.y;var r=0,r=1,g=g+l*r;e.x+=l*k.x*r;e.y+=l*k.y*r}f.x/=d;f.y/=d;e.x/=g;e.y/=g;d<Number.MIN_VALUE||(g=this.gravity.GetNegative(),g.Multiply(this.density*d),c.ApplyForce(g,e),e=c.GetLinearVelocityFromWorldPoint(f),e.Subtract(this.velocity),e.Multiply(-this.linearDrag*d),c.ApplyForce(e,
f),c.ApplyTorque(-c.GetInertia()/c.GetMass()*d*c.GetAngularVelocity()*this.angularDrag))}}}};e.prototype.Draw=function(b){var c=new a,e=new a;c.x=this.normal.x*this.offset+1E3*this.normal.y;c.y=this.normal.y*this.offset-1E3*this.normal.x;e.x=this.normal.x*this.offset-1E3*this.normal.y;e.y=this.normal.y*this.offset+1E3*this.normal.x;var d=new f(0,0,1);b.DrawSegment(c,e,d)};Box2D.inherit(d,Box2D.Dynamics.Controllers.b2Controller);d.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
d.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.A=new a(0,0)};d.prototype.Step=function(b){b=new a(this.A.x*b.dt,this.A.y*b.dt);for(var c=this.m_bodyList;c;c=c.nextBody){var f=c.body;f.IsAwake()&&f.SetLinearVelocity(new a(f.GetLinearVelocity().x+b.x,f.GetLinearVelocity().y+b.y))}};Box2D.inherit(g,Box2D.Dynamics.Controllers.b2Controller);g.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;g.b2ConstantForceController=
function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.F=new a(0,0)};g.prototype.Step=function(){for(var a=this.m_bodyList;a;a=a.nextBody){var b=a.body;b.IsAwake()&&b.ApplyForce(this.F,b.GetWorldCenter())}};h.b2Controller=function(){};h.prototype.Step=function(){};h.prototype.Draw=function(){};h.prototype.AddBody=function(a){var b=new k;b.controller=this;b.body=a;b.nextBody=this.m_bodyList;b.prevBody=null;this.m_bodyList=b;b.nextBody&&(b.nextBody.prevBody=b);this.m_bodyCount++;
b.nextController=a.m_controllerList;b.prevController=null;a.m_controllerList=b;b.nextController&&(b.nextController.prevController=b);a.m_controllerCount++};h.prototype.RemoveBody=function(a){for(var b=a.m_controllerList;b&&b.controller!=this;)b=b.nextController;b.prevBody&&(b.prevBody.nextBody=b.nextBody);b.nextBody&&(b.nextBody.prevBody=b.prevBody);b.nextController&&(b.nextController.prevController=b.prevController);b.prevController&&(b.prevController.nextController=b.nextController);this.m_bodyList==
b&&(this.m_bodyList=b.nextBody);a.m_controllerList==b&&(a.m_controllerList=b.nextController);a.m_controllerCount--;this.m_bodyCount--};h.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)};h.prototype.GetNext=function(){return this.m_next};h.prototype.GetWorld=function(){return this.m_world};h.prototype.GetBodyList=function(){return this.m_bodyList};k.b2ControllerEdge=function(){};Box2D.inherit(l,Box2D.Dynamics.Controllers.b2Controller);l.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
l.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.G=1;this.invSqr=!0};l.prototype.Step=function(){var b=null,c=null,f=null,e=0,d=null,g=null,h=null,k=0,l=0,r=0;if(this.invSqr)for(b=this.m_bodyList;b;b=b.nextBody){c=b.body;f=c.GetWorldCenter();e=c.GetMass();for(d=this.m_bodyList;d!=b;d=d.nextBody)g=d.body,h=g.GetWorldCenter(),k=h.x-f.x,l=h.y-f.y,r=k*k+l*l,r<Number.MIN_VALUE||(k=new a(k,l),k.Multiply(this.G/r/Math.sqrt(r)*e*g.GetMass()),
c.IsAwake()&&c.ApplyForce(k,f),k.Multiply(-1),g.IsAwake()&&g.ApplyForce(k,h))}else for(b=this.m_bodyList;b;b=b.nextBody){c=b.body;f=c.GetWorldCenter();e=c.GetMass();for(d=this.m_bodyList;d!=b;d=d.nextBody)g=d.body,h=g.GetWorldCenter(),k=h.x-f.x,l=h.y-f.y,r=k*k+l*l,r<Number.MIN_VALUE||(k=new a(k,l),k.Multiply(this.G/r*e*g.GetMass()),c.IsAwake()&&c.ApplyForce(k,f),k.Multiply(-1),g.IsAwake()&&g.ApplyForce(k,h))}};Box2D.inherit(r,Box2D.Dynamics.Controllers.b2Controller);r.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
r.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.T=new b;this.maxTimestep=0};r.prototype.SetAxisAligned=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);this.T.col1.x=-a;this.T.col1.y=0;this.T.col2.x=0;this.T.col2.y=-b;this.maxTimestep=0<a||0<b?1/Math.max(a,b):0};r.prototype.Step=function(b){b=b.dt;if(!(b<=Number.MIN_VALUE)){b>this.maxTimestep&&0<this.maxTimestep&&(b=this.maxTimestep);for(var f=this.m_bodyList;f;f=f.nextBody){var e=
f.body;if(e.IsAwake()){var d=e.GetWorldVector(c.MulMV(this.T,e.GetLocalVector(e.GetLinearVelocity())));e.SetLinearVelocity(new a(e.GetLinearVelocity().x+d.x*b,e.GetLinearVelocity().y+d.y*b))}}}}})();
(function(){var b=Box2D.Common.b2Settings,c=Box2D.Common.Math.b2Mat22,a=Box2D.Common.Math.b2Mat33,f=Box2D.Common.Math.b2Math,e=Box2D.Common.Math.b2Vec2,d=Box2D.Common.Math.b2Vec3,g=Box2D.Dynamics.Joints.b2DistanceJoint,h=Box2D.Dynamics.Joints.b2DistanceJointDef,k=Box2D.Dynamics.Joints.b2FrictionJoint,l=Box2D.Dynamics.Joints.b2FrictionJointDef,r=Box2D.Dynamics.Joints.b2GearJoint,s=Box2D.Dynamics.Joints.b2GearJointDef,x=Box2D.Dynamics.Joints.b2Jacobian,v=Box2D.Dynamics.Joints.b2Joint,w=Box2D.Dynamics.Joints.b2JointDef,
F=Box2D.Dynamics.Joints.b2JointEdge,m=Box2D.Dynamics.Joints.b2LineJoint,E=Box2D.Dynamics.Joints.b2LineJointDef,A=Box2D.Dynamics.Joints.b2MouseJoint,z=Box2D.Dynamics.Joints.b2MouseJointDef,D=Box2D.Dynamics.Joints.b2PrismaticJoint,H=Box2D.Dynamics.Joints.b2PrismaticJointDef,C=Box2D.Dynamics.Joints.b2PulleyJoint,M=Box2D.Dynamics.Joints.b2PulleyJointDef,G=Box2D.Dynamics.Joints.b2RevoluteJoint,I=Box2D.Dynamics.Joints.b2RevoluteJointDef,N=Box2D.Dynamics.Joints.b2WeldJoint,L=Box2D.Dynamics.Joints.b2WeldJointDef;
Box2D.inherit(g,Box2D.Dynamics.Joints.b2Joint);g.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;g.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new e;this.m_localAnchor2=new e;this.m_u=new e};g.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};g.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};g.prototype.GetReactionForce=function(a){void 0===a&&(a=0);
return new e(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)};g.prototype.GetReactionTorque=function(){return 0};g.prototype.GetLength=function(){return this.m_length};g.prototype.SetLength=function(a){void 0===a&&(a=0);this.m_length=a};g.prototype.GetFrequency=function(){return this.m_frequencyHz};g.prototype.SetFrequency=function(a){void 0===a&&(a=0);this.m_frequencyHz=a};g.prototype.GetDampingRatio=function(){return this.m_dampingRatio};g.prototype.SetDampingRatio=function(a){void 0===
a&&(a=0);this.m_dampingRatio=a};g.prototype.b2DistanceJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_length=a.length;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_bias=this.m_gamma=this.m_impulse=0};g.prototype.InitVelocityConstraints=function(a){var c,f=0,e=this.m_bodyA,d=this.m_bodyB;c=e.m_xf.R;var g=this.m_localAnchor1.x-e.m_sweep.localCenter.x,h=this.m_localAnchor1.y-e.m_sweep.localCenter.y,
f=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=f;c=d.m_xf.R;var k=this.m_localAnchor2.x-d.m_sweep.localCenter.x,p=this.m_localAnchor2.y-d.m_sweep.localCenter.y,f=c.col1.x*k+c.col2.x*p,p=c.col1.y*k+c.col2.y*p,k=f;this.m_u.x=d.m_sweep.c.x+k-e.m_sweep.c.x-g;this.m_u.y=d.m_sweep.c.y+p-e.m_sweep.c.y-h;f=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);f>b.b2_linearSlop?this.m_u.Multiply(1/f):this.m_u.SetZero();c=g*this.m_u.y-h*this.m_u.x;var l=k*this.m_u.y-p*this.m_u.x;c=e.m_invMass+e.m_invI*
c*c+d.m_invMass+d.m_invI*l*l;this.m_mass=0!=c?1/c:0;if(0<this.m_frequencyHz){var f=f-this.m_length,l=2*Math.PI*this.m_frequencyHz,r=this.m_mass*l*l;this.m_gamma=a.dt*(2*this.m_mass*this.m_dampingRatio*l+a.dt*r);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_bias=f*a.dt*r*this.m_gamma;this.m_mass=c+this.m_gamma;this.m_mass=0!=this.m_mass?1/this.m_mass:0}a.warmStarting?(this.m_impulse*=a.dtRatio,a=this.m_impulse*this.m_u.x,c=this.m_impulse*this.m_u.y,e.m_linearVelocity.x-=e.m_invMass*a,e.m_linearVelocity.y-=
e.m_invMass*c,e.m_angularVelocity-=e.m_invI*(g*c-h*a),d.m_linearVelocity.x+=d.m_invMass*a,d.m_linearVelocity.y+=d.m_invMass*c,d.m_angularVelocity+=d.m_invI*(k*c-p*a)):this.m_impulse=0};g.prototype.SolveVelocityConstraints=function(){var a,b=this.m_bodyA,c=this.m_bodyB;a=b.m_xf.R;var f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,e=this.m_localAnchor1.y-b.m_sweep.localCenter.y,d=a.col1.x*f+a.col2.x*e,e=a.col1.y*f+a.col2.y*e,f=d;a=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-
c.m_sweep.localCenter.y,d=a.col1.x*g+a.col2.x*h,h=a.col1.y*g+a.col2.y*h,g=d,d=-this.m_mass*(this.m_u.x*(c.m_linearVelocity.x+-c.m_angularVelocity*h-(b.m_linearVelocity.x+-b.m_angularVelocity*e))+this.m_u.y*(c.m_linearVelocity.y+c.m_angularVelocity*g-(b.m_linearVelocity.y+b.m_angularVelocity*f))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=d;a=d*this.m_u.x;d*=this.m_u.y;b.m_linearVelocity.x-=b.m_invMass*a;b.m_linearVelocity.y-=b.m_invMass*d;b.m_angularVelocity-=b.m_invI*(f*d-e*a);c.m_linearVelocity.x+=
c.m_invMass*a;c.m_linearVelocity.y+=c.m_invMass*d;c.m_angularVelocity+=c.m_invI*(g*d-h*a)};g.prototype.SolvePositionConstraints=function(){var a;if(0<this.m_frequencyHz)return!0;var c=this.m_bodyA,e=this.m_bodyB;a=c.m_xf.R;var d=this.m_localAnchor1.x-c.m_sweep.localCenter.x,g=this.m_localAnchor1.y-c.m_sweep.localCenter.y,h=a.col1.x*d+a.col2.x*g,g=a.col1.y*d+a.col2.y*g,d=h;a=e.m_xf.R;var k=this.m_localAnchor2.x-e.m_sweep.localCenter.x,u=this.m_localAnchor2.y-e.m_sweep.localCenter.y,h=a.col1.x*k+a.col2.x*
u,u=a.col1.y*k+a.col2.y*u,k=h,h=e.m_sweep.c.x+k-c.m_sweep.c.x-d,p=e.m_sweep.c.y+u-c.m_sweep.c.y-g;a=Math.sqrt(h*h+p*p);h/=a;p/=a;a-=this.m_length;a=f.Clamp(a,-b.b2_maxLinearCorrection,b.b2_maxLinearCorrection);var l=-this.m_mass*a;this.m_u.Set(h,p);h=l*this.m_u.x;p=l*this.m_u.y;c.m_sweep.c.x-=c.m_invMass*h;c.m_sweep.c.y-=c.m_invMass*p;c.m_sweep.a-=c.m_invI*(d*p-g*h);e.m_sweep.c.x+=e.m_invMass*h;e.m_sweep.c.y+=e.m_invMass*p;e.m_sweep.a+=e.m_invI*(k*p-u*h);c.SynchronizeTransform();e.SynchronizeTransform();
return f.Abs(a)<b.b2_linearSlop};Box2D.inherit(h,Box2D.Dynamics.Joints.b2JointDef);h.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;h.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new e;this.localAnchorB=new e};h.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_distanceJoint;this.length=1;this.dampingRatio=this.frequencyHz=0};h.prototype.Initialize=function(a,b,c,f){this.bodyA=
a;this.bodyB=b;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(f));a=f.x-c.x;c=f.y-c.y;this.length=Math.sqrt(a*a+c*c);this.dampingRatio=this.frequencyHz=0};Box2D.inherit(k,Box2D.Dynamics.Joints.b2Joint);k.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;k.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new e;this.m_localAnchorB=new e;this.m_linearMass=new c;this.m_linearImpulse=
new e};k.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};k.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};k.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new e(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)};k.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_angularImpulse};k.prototype.SetMaxForce=function(a){void 0===a&&(a=0);this.m_maxForce=a};k.prototype.GetMaxForce=function(){return this.m_maxForce};
k.prototype.SetMaxTorque=function(a){void 0===a&&(a=0);this.m_maxTorque=a};k.prototype.GetMaxTorque=function(){return this.m_maxTorque};k.prototype.b2FrictionJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchorA.SetV(a.localAnchorA);this.m_localAnchorB.SetV(a.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();this.m_angularImpulse=0;this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque};k.prototype.InitVelocityConstraints=function(a){var b,
f=0,e=this.m_bodyA,d=this.m_bodyB;b=e.m_xf.R;var g=this.m_localAnchorA.x-e.m_sweep.localCenter.x,h=this.m_localAnchorA.y-e.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*h,h=b.col1.y*g+b.col2.y*h,g=f;b=d.m_xf.R;var k=this.m_localAnchorB.x-d.m_sweep.localCenter.x,p=this.m_localAnchorB.y-d.m_sweep.localCenter.y,f=b.col1.x*k+b.col2.x*p,p=b.col1.y*k+b.col2.y*p,k=f;b=e.m_invMass;var f=d.m_invMass,l=e.m_invI,r=d.m_invI,m=new c;m.col1.x=b+f;m.col2.x=0;m.col1.y=0;m.col2.y=b+f;m.col1.x+=l*h*h;m.col2.x+=-l*g*
h;m.col1.y+=-l*g*h;m.col2.y+=l*g*g;m.col1.x+=r*p*p;m.col2.x+=-r*k*p;m.col1.y+=-r*k*p;m.col2.y+=r*k*k;m.GetInverse(this.m_linearMass);this.m_angularMass=l+r;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.warmStarting?(this.m_linearImpulse.x*=a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio,a=this.m_linearImpulse,e.m_linearVelocity.x-=b*a.x,e.m_linearVelocity.y-=b*a.y,e.m_angularVelocity-=l*(g*a.y-h*a.x+this.m_angularImpulse),d.m_linearVelocity.x+=f*a.x,
d.m_linearVelocity.y+=f*a.y,d.m_angularVelocity+=r*(k*a.y-p*a.x+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0)};k.prototype.SolveVelocityConstraints=function(a){var b,c=0,d=this.m_bodyA,g=this.m_bodyB,h=d.m_linearVelocity,k=d.m_angularVelocity,u=g.m_linearVelocity,p=g.m_angularVelocity,l=d.m_invMass,m=g.m_invMass,r=d.m_invI,s=g.m_invI;b=d.m_xf.R;var v=this.m_localAnchorA.x-d.m_sweep.localCenter.x,x=this.m_localAnchorA.y-d.m_sweep.localCenter.y,c=b.col1.x*v+b.col2.x*
x,x=b.col1.y*v+b.col2.y*x,v=c;b=g.m_xf.R;var w=this.m_localAnchorB.x-g.m_sweep.localCenter.x,z=this.m_localAnchorB.y-g.m_sweep.localCenter.y,c=b.col1.x*w+b.col2.x*z,z=b.col1.y*w+b.col2.y*z,w=c,c=-this.m_angularMass*(p-k),A=this.m_angularImpulse;b=a.dt*this.m_maxTorque;this.m_angularImpulse=f.Clamp(this.m_angularImpulse+c,-b,b);c=this.m_angularImpulse-A;k-=r*c;p+=s*c;b=f.MulMV(this.m_linearMass,new e(-(u.x-p*z-h.x+k*x),-(u.y+p*w-h.y-k*v)));c=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(b);
b=a.dt*this.m_maxForce;this.m_linearImpulse.LengthSquared()>b*b&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(b));b=f.SubtractVV(this.m_linearImpulse,c);h.x-=l*b.x;h.y-=l*b.y;k-=r*(v*b.y-x*b.x);u.x+=m*b.x;u.y+=m*b.y;p+=s*(w*b.y-z*b.x);d.m_angularVelocity=k;g.m_angularVelocity=p};k.prototype.SolvePositionConstraints=function(){return!0};Box2D.inherit(l,Box2D.Dynamics.Joints.b2JointDef);l.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;l.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,
arguments);this.localAnchorA=new e;this.localAnchorB=new e};l.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_frictionJoint;this.maxTorque=this.maxForce=0};l.prototype.Initialize=function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(c))};Box2D.inherit(r,Box2D.Dynamics.Joints.b2Joint);r.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;r.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,
arguments);this.m_groundAnchor1=new e;this.m_groundAnchor2=new e;this.m_localAnchor1=new e;this.m_localAnchor2=new e;this.m_J=new x};r.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};r.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};r.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new e(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)};r.prototype.GetReactionTorque=function(a){void 0===
a&&(a=0);var b=this.m_bodyB.m_xf.R,c=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,f=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,e=b.col1.x*c+b.col2.x*f,f=b.col1.y*c+b.col2.y*f;return a*(this.m_impulse*this.m_J.angularB-e*this.m_impulse*this.m_J.linearB.y+f*this.m_impulse*this.m_J.linearB.x)};r.prototype.GetRatio=function(){return this.m_ratio};r.prototype.SetRatio=function(a){void 0===a&&(a=0);this.m_ratio=a};r.prototype.b2GearJoint=function(a){this.__super.b2Joint.call(this,
a);var b=parseInt(a.joint1.m_type),c=parseInt(a.joint2.m_type);this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;var f=0,e=0;this.m_ground1=a.joint1.GetBodyA();this.m_bodyA=a.joint1.GetBodyB();b==v.e_revoluteJoint?(this.m_revolute1=a.joint1 instanceof G?a.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),f=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=a.joint1 instanceof D?a.joint1:null,
this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),f=this.m_prismatic1.GetJointTranslation());this.m_ground2=a.joint2.GetBodyA();this.m_bodyB=a.joint2.GetBodyB();c==v.e_revoluteJoint?(this.m_revolute2=a.joint2 instanceof G?a.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),e=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=a.joint2 instanceof D?a.joint2:
null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),e=this.m_prismatic2.GetJointTranslation());this.m_ratio=a.ratio;this.m_constant=f+this.m_ratio*e;this.m_impulse=0};r.prototype.InitVelocityConstraints=function(a){var b=this.m_ground1,c=this.m_ground2,f=this.m_bodyA,e=this.m_bodyB,d=0,g=0,h=0,p=0,k=0,l=0;this.m_J.SetZero();this.m_revolute1?(this.m_J.angularA=-1,l+=f.m_invI):(b=b.m_xf.R,g=this.m_prismatic1.m_localXAxis1,d=b.col1.x*
g.x+b.col2.x*g.y,g=b.col1.y*g.x+b.col2.y*g.y,b=f.m_xf.R,h=this.m_localAnchor1.x-f.m_sweep.localCenter.x,p=this.m_localAnchor1.y-f.m_sweep.localCenter.y,k=b.col1.x*h+b.col2.x*p,p=b.col1.y*h+b.col2.y*p,h=k*g-p*d,this.m_J.linearA.Set(-d,-g),this.m_J.angularA=-h,l+=f.m_invMass+f.m_invI*h*h);this.m_revolute2?(this.m_J.angularB=-this.m_ratio,l+=this.m_ratio*this.m_ratio*e.m_invI):(b=c.m_xf.R,g=this.m_prismatic2.m_localXAxis1,d=b.col1.x*g.x+b.col2.x*g.y,g=b.col1.y*g.x+b.col2.y*g.y,b=e.m_xf.R,h=this.m_localAnchor2.x-
e.m_sweep.localCenter.x,p=this.m_localAnchor2.y-e.m_sweep.localCenter.y,k=b.col1.x*h+b.col2.x*p,p=b.col1.y*h+b.col2.y*p,h=k*g-p*d,this.m_J.linearB.Set(-this.m_ratio*d,-this.m_ratio*g),this.m_J.angularB=-this.m_ratio*h,l+=this.m_ratio*this.m_ratio*(e.m_invMass+e.m_invI*h*h));this.m_mass=0<l?1/l:0;a.warmStarting?(f.m_linearVelocity.x+=f.m_invMass*this.m_impulse*this.m_J.linearA.x,f.m_linearVelocity.y+=f.m_invMass*this.m_impulse*this.m_J.linearA.y,f.m_angularVelocity+=f.m_invI*this.m_impulse*this.m_J.angularA,
e.m_linearVelocity.x+=e.m_invMass*this.m_impulse*this.m_J.linearB.x,e.m_linearVelocity.y+=e.m_invMass*this.m_impulse*this.m_J.linearB.y,e.m_angularVelocity+=e.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0};r.prototype.SolveVelocityConstraints=function(){var a=this.m_bodyA,b=this.m_bodyB,c=-this.m_mass*this.m_J.Compute(a.m_linearVelocity,a.m_angularVelocity,b.m_linearVelocity,b.m_angularVelocity);this.m_impulse+=c;a.m_linearVelocity.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_linearVelocity.y+=
a.m_invMass*c*this.m_J.linearA.y;a.m_angularVelocity+=a.m_invI*c*this.m_J.angularA;b.m_linearVelocity.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_linearVelocity.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_angularVelocity+=b.m_invI*c*this.m_J.angularB};r.prototype.SolvePositionConstraints=function(){var a=this.m_bodyA,c=this.m_bodyB,f=0,e=0,f=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),e=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation(),
f=-this.m_mass*(this.m_constant-(f+this.m_ratio*e));a.m_sweep.c.x+=a.m_invMass*f*this.m_J.linearA.x;a.m_sweep.c.y+=a.m_invMass*f*this.m_J.linearA.y;a.m_sweep.a+=a.m_invI*f*this.m_J.angularA;c.m_sweep.c.x+=c.m_invMass*f*this.m_J.linearB.x;c.m_sweep.c.y+=c.m_invMass*f*this.m_J.linearB.y;c.m_sweep.a+=c.m_invI*f*this.m_J.angularB;a.SynchronizeTransform();c.SynchronizeTransform();return 0<b.b2_linearSlop};Box2D.inherit(s,Box2D.Dynamics.Joints.b2JointDef);s.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
s.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)};s.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_gearJoint;this.joint2=this.joint1=null;this.ratio=1};x.b2Jacobian=function(){this.linearA=new e;this.linearB=new e};x.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0};x.prototype.Set=function(a,b,c,f){void 0===b&&(b=0);void 0===f&&(f=0);this.linearA.SetV(a);this.angularA=
b;this.linearB.SetV(c);this.angularB=f};x.prototype.Compute=function(a,b,c,f){void 0===b&&(b=0);void 0===f&&(f=0);return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*b+(this.linearB.x*c.x+this.linearB.y*c.y)+this.angularB*f};v.b2Joint=function(){this.m_edgeA=new F;this.m_edgeB=new F;this.m_localCenterA=new e;this.m_localCenterB=new e};v.prototype.GetType=function(){return this.m_type};v.prototype.GetAnchorA=function(){return null};v.prototype.GetAnchorB=function(){return null};v.prototype.GetReactionForce=
function(){return null};v.prototype.GetReactionTorque=function(){return 0};v.prototype.GetBodyA=function(){return this.m_bodyA};v.prototype.GetBodyB=function(){return this.m_bodyB};v.prototype.GetNext=function(){return this.m_next};v.prototype.GetUserData=function(){return this.m_userData};v.prototype.SetUserData=function(a){this.m_userData=a};v.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};v.Create=function(a){var b=null;switch(a.type){case v.e_distanceJoint:b=
new g(a instanceof h?a:null);break;case v.e_mouseJoint:b=new A(a instanceof z?a:null);break;case v.e_prismaticJoint:b=new D(a instanceof H?a:null);break;case v.e_revoluteJoint:b=new G(a instanceof I?a:null);break;case v.e_pulleyJoint:b=new C(a instanceof M?a:null);break;case v.e_gearJoint:b=new r(a instanceof s?a:null);break;case v.e_lineJoint:b=new m(a instanceof E?a:null);break;case v.e_weldJoint:b=new N(a instanceof L?a:null);break;case v.e_frictionJoint:b=new k(a instanceof l?a:null)}return b};
v.Destroy=function(){};v.prototype.b2Joint=function(a){b.b2Assert(a.bodyA!=a.bodyB);this.m_type=a.type;this.m_next=this.m_prev=null;this.m_bodyA=a.bodyA;this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_islandFlag=!1;this.m_userData=a.userData};v.prototype.InitVelocityConstraints=function(){};v.prototype.SolveVelocityConstraints=function(){};v.prototype.FinalizeVelocityConstraints=function(){};v.prototype.SolvePositionConstraints=function(){return!1};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=
0;Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1;Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2;Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3;Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4;Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5;Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6;Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7;Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8;Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9;Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0;Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=
1;Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2;Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3});w.b2JointDef=function(){};w.prototype.b2JointDef=function(){this.type=v.e_unknownJoint;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=!1};F.b2JointEdge=function(){};Box2D.inherit(m,Box2D.Dynamics.Joints.b2Joint);m.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;m.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new e;this.m_localAnchor2=
new e;this.m_localXAxis1=new e;this.m_localYAxis1=new e;this.m_axis=new e;this.m_perp=new e;this.m_K=new c;this.m_impulse=new e};m.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};m.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};m.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new e(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+
(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))};m.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.y};m.prototype.GetJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.GetWorldPoint(this.m_localAnchor1),f=b.GetWorldPoint(this.m_localAnchor2),b=f.x-c.x,c=f.y-c.y,a=a.GetWorldVector(this.m_localXAxis1);return a.x*b+a.y*c};m.prototype.GetJointSpeed=function(){var a=this.m_bodyA,b=this.m_bodyB,c;c=a.m_xf.R;var f=this.m_localAnchor1.x-a.m_sweep.localCenter.x,
e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,d=c.col1.x*f+c.col2.x*e,e=c.col1.y*f+c.col2.y*e,f=d;c=b.m_xf.R;var g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,h=this.m_localAnchor2.y-b.m_sweep.localCenter.y,d=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=d;c=b.m_sweep.c.x+g-(a.m_sweep.c.x+f);var d=b.m_sweep.c.y+h-(a.m_sweep.c.y+e),k=a.GetWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*k.y+d*a*k.x+(k.x*(m.x+-b*
h-l.x- -a*e)+k.y*(m.y+b*g-l.y-a*f))};m.prototype.IsLimitEnabled=function(){return this.m_enableLimit};m.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=a};m.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};m.prototype.GetUpperLimit=function(){return this.m_upperTranslation};m.prototype.SetLimits=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=
b};m.prototype.IsMotorEnabled=function(){return this.m_enableMotor};m.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};m.prototype.SetMotorSpeed=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};m.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};m.prototype.SetMaxMotorForce=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=
a};m.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};m.prototype.GetMotorForce=function(){return this.m_motorImpulse};m.prototype.b2LineJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_localXAxis1.SetV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;
this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=v.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};m.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyA,e=this.m_bodyB,d,g=0;this.m_localCenterA.SetV(c.GetLocalCenter());this.m_localCenterB.SetV(e.GetLocalCenter());var h=c.GetTransform();e.GetTransform();d=c.m_xf.R;var k=this.m_localAnchor1.x-
this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y,g=d.col1.x*k+d.col2.x*u,u=d.col1.y*k+d.col2.y*u,k=g;d=e.m_xf.R;var p=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y,g=d.col1.x*p+d.col2.x*l,l=d.col1.y*p+d.col2.y*l,p=g;d=e.m_sweep.c.x+p-c.m_sweep.c.x-k;g=e.m_sweep.c.y+l-c.m_sweep.c.y-u;this.m_invMassA=c.m_invMass;this.m_invMassB=e.m_invMass;this.m_invIA=c.m_invI;this.m_invIB=e.m_invI;this.m_axis.SetV(f.MulMV(h.R,this.m_localXAxis1));this.m_a1=
(d+k)*this.m_axis.y-(g+u)*this.m_axis.x;this.m_a2=p*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.SetV(f.MulMV(h.R,this.m_localYAxis1));this.m_s1=(d+k)*this.m_perp.y-(g+u)*this.m_perp.x;this.m_s2=p*this.m_perp.y-l*this.m_perp.x;h=this.m_invMassA;k=this.m_invMassB;u=this.m_invIA;p=this.m_invIB;this.m_K.col1.x=h+k+u*this.m_s1*
this.m_s1+p*this.m_s2*this.m_s2;this.m_K.col1.y=u*this.m_s1*this.m_a1+p*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=h+k+u*this.m_a1*this.m_a1+p*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*g,f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop?this.m_limitState=v.e_equalLimits:d<=this.m_lowerTranslation?this.m_limitState!=v.e_atLowerLimit&&(this.m_limitState=v.e_atLowerLimit,this.m_impulse.y=0):d>=this.m_upperTranslation?this.m_limitState!=
v.e_atUpperLimit&&(this.m_limitState=v.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=v.e_inactiveLimit,this.m_impulse.y=0)):this.m_limitState=v.e_inactiveLimit;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,g=this.m_impulse.x*
this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,h=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,c.m_linearVelocity.x-=this.m_invMassA*a,c.m_linearVelocity.y-=this.m_invMassA*d,c.m_angularVelocity-=this.m_invIA*g,e.m_linearVelocity.x+=this.m_invMassB*a,e.m_linearVelocity.y+=this.m_invMassB*d,e.m_angularVelocity+=this.m_invIB*h):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};m.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyA,c=this.m_bodyB,
d=b.m_linearVelocity,g=b.m_angularVelocity,h=c.m_linearVelocity,k=c.m_angularVelocity,u=0,p=0,l=0,m=0;this.m_enableMotor&&this.m_limitState!=v.e_equalLimits&&(m=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(h.x-d.x)+this.m_axis.y*(h.y-d.y)+this.m_a2*k-this.m_a1*g)),u=this.m_motorImpulse,p=a.dt*this.m_maxMotorForce,this.m_motorImpulse=f.Clamp(this.m_motorImpulse+m,-p,p),m=this.m_motorImpulse-u,u=m*this.m_axis.x,p=m*this.m_axis.y,l=m*this.m_a1,m*=this.m_a2,d.x-=this.m_invMassA*u,d.y-=this.m_invMassA*
p,g-=this.m_invIA*l,h.x+=this.m_invMassB*u,h.y+=this.m_invMassB*p,k+=this.m_invIB*m);p=this.m_perp.x*(h.x-d.x)+this.m_perp.y*(h.y-d.y)+this.m_s2*k-this.m_s1*g;this.m_enableLimit&&this.m_limitState!=v.e_inactiveLimit?(l=this.m_axis.x*(h.x-d.x)+this.m_axis.y*(h.y-d.y)+this.m_a2*k-this.m_a1*g,u=this.m_impulse.Copy(),a=this.m_K.Solve(new e,-p,-l),this.m_impulse.Add(a),this.m_limitState==v.e_atLowerLimit?this.m_impulse.y=f.Max(this.m_impulse.y,0):this.m_limitState==v.e_atUpperLimit&&(this.m_impulse.y=
f.Min(this.m_impulse.y,0)),p=-p-(this.m_impulse.y-u.y)*this.m_K.col2.x,l=0!=this.m_K.col1.x?p/this.m_K.col1.x+u.x:u.x,this.m_impulse.x=l,a.x=this.m_impulse.x-u.x,a.y=this.m_impulse.y-u.y,u=a.x*this.m_perp.x+a.y*this.m_axis.x,p=a.x*this.m_perp.y+a.y*this.m_axis.y,l=a.x*this.m_s1+a.y*this.m_a1,m=a.x*this.m_s2+a.y*this.m_a2):(a=0!=this.m_K.col1.x?-p/this.m_K.col1.x:0,this.m_impulse.x+=a,u=a*this.m_perp.x,p=a*this.m_perp.y,l=a*this.m_s1,m=a*this.m_s2);d.x-=this.m_invMassA*u;d.y-=this.m_invMassA*p;g-=
this.m_invIA*l;h.x+=this.m_invMassB*u;h.y+=this.m_invMassB*p;k+=this.m_invIB*m;b.m_linearVelocity.SetV(d);b.m_angularVelocity=g;c.m_linearVelocity.SetV(h);c.m_angularVelocity=k};m.prototype.SolvePositionConstraints=function(){var a=this.m_bodyA,d=this.m_bodyB,g=a.m_sweep.c,h=a.m_sweep.a,k=d.m_sweep.c,l=d.m_sweep.a,m,u=0,p=0,r=0,s=0,v=0,x=0,p=!1,w=0,z=c.FromAngle(h),r=c.FromAngle(l);m=z;var x=this.m_localAnchor1.x-this.m_localCenterA.x,A=this.m_localAnchor1.y-this.m_localCenterA.y,u=m.col1.x*x+m.col2.x*
A,A=m.col1.y*x+m.col2.y*A,x=u;m=r;r=this.m_localAnchor2.x-this.m_localCenterB.x;s=this.m_localAnchor2.y-this.m_localCenterB.y;u=m.col1.x*r+m.col2.x*s;s=m.col1.y*r+m.col2.y*s;r=u;m=k.x+r-g.x-x;u=k.y+s-g.y-A;if(this.m_enableLimit){this.m_axis=f.MulMV(z,this.m_localXAxis1);this.m_a1=(m+x)*this.m_axis.y-(u+A)*this.m_axis.x;this.m_a2=r*this.m_axis.y-s*this.m_axis.x;var C=this.m_axis.x*m+this.m_axis.y*u;f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop?(w=f.Clamp(C,-b.b2_maxLinearCorrection,
b.b2_maxLinearCorrection),v=f.Abs(C),p=!0):C<=this.m_lowerTranslation?(w=f.Clamp(C-this.m_lowerTranslation+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),v=this.m_lowerTranslation-C,p=!0):C>=this.m_upperTranslation&&(w=f.Clamp(C-this.m_upperTranslation+b.b2_linearSlop,0,b.b2_maxLinearCorrection),v=C-this.m_upperTranslation,p=!0)}this.m_perp=f.MulMV(z,this.m_localYAxis1);this.m_s1=(m+x)*this.m_perp.y-(u+A)*this.m_perp.x;this.m_s2=r*this.m_perp.y-s*this.m_perp.x;z=new e;A=this.m_perp.x*m+this.m_perp.y*
u;v=f.Max(v,f.Abs(A));x=0;p?(p=this.m_invMassA,r=this.m_invMassB,s=this.m_invIA,m=this.m_invIB,this.m_K.col1.x=p+r+s*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,this.m_K.col1.y=s*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=p+r+s*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2,this.m_K.Solve(z,-A,-w)):(p=this.m_invMassA,r=this.m_invMassB,s=this.m_invIA,m=this.m_invIB,w=p+r+s*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,z.x=0!=w?-A/w:0,z.y=0);w=z.x*this.m_perp.x+z.y*
this.m_axis.x;p=z.x*this.m_perp.y+z.y*this.m_axis.y;A=z.x*this.m_s1+z.y*this.m_a1;z=z.x*this.m_s2+z.y*this.m_a2;g.x-=this.m_invMassA*w;g.y-=this.m_invMassA*p;h-=this.m_invIA*A;k.x+=this.m_invMassB*w;k.y+=this.m_invMassB*p;l+=this.m_invIB*z;a.m_sweep.a=h;d.m_sweep.a=l;a.SynchronizeTransform();d.SynchronizeTransform();return v<=b.b2_linearSlop&&x<=b.b2_angularSlop};Box2D.inherit(E,Box2D.Dynamics.Joints.b2JointDef);E.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;E.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,
arguments);this.localAnchorA=new e;this.localAnchorB=new e;this.localAxisA=new e};E.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};E.prototype.Initialize=function(a,b,c,f){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.GetLocalPoint(c);this.localAnchorB=this.bodyB.GetLocalPoint(c);this.localAxisA=
this.bodyA.GetLocalVector(f)};Box2D.inherit(A,Box2D.Dynamics.Joints.b2Joint);A.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;A.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new c;this.K1=new c;this.K2=new c;this.m_localAnchor=new e;this.m_target=new e;this.m_impulse=new e;this.m_mass=new c;this.m_C=new e};A.prototype.GetAnchorA=function(){return this.m_target};A.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)};
A.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new e(a*this.m_impulse.x,a*this.m_impulse.y)};A.prototype.GetReactionTorque=function(){return 0};A.prototype.GetTarget=function(){return this.m_target};A.prototype.SetTarget=function(a){!1==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0);this.m_target=a};A.prototype.GetMaxForce=function(){return this.m_maxForce};A.prototype.SetMaxForce=function(a){void 0===a&&(a=0);this.m_maxForce=a};A.prototype.GetFrequency=function(){return this.m_frequencyHz};
A.prototype.SetFrequency=function(a){void 0===a&&(a=0);this.m_frequencyHz=a};A.prototype.GetDampingRatio=function(){return this.m_dampingRatio};A.prototype.SetDampingRatio=function(a){void 0===a&&(a=0);this.m_dampingRatio=a};A.prototype.b2MouseJoint=function(a){this.__super.b2Joint.call(this,a);this.m_target.SetV(a.target);var b=this.m_target.x-this.m_bodyB.m_xf.position.x,c=this.m_target.y-this.m_bodyB.m_xf.position.y,f=this.m_bodyB.m_xf.R;this.m_localAnchor.x=b*f.col1.x+c*f.col1.y;this.m_localAnchor.y=
b*f.col2.x+c*f.col2.y;this.m_maxForce=a.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};A.prototype.InitVelocityConstraints=function(a){var b=this.m_bodyB,c=b.GetMass(),f=2*Math.PI*this.m_frequencyHz,e=c*f*f;this.m_gamma=a.dt*(2*c*this.m_dampingRatio*f+a.dt*e);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_beta=a.dt*e*this.m_gamma;var e=b.m_xf.R,c=this.m_localAnchor.x-b.m_sweep.localCenter.x,f=this.m_localAnchor.y-
b.m_sweep.localCenter.y,d=e.col1.x*c+e.col2.x*f,f=e.col1.y*c+e.col2.y*f,c=d,e=b.m_invMass,d=b.m_invI;this.K1.col1.x=e;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=e;this.K2.col1.x=d*f*f;this.K2.col2.x=-d*c*f;this.K2.col1.y=-d*c*f;this.K2.col2.y=d*c*c;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.GetInverse(this.m_mass);this.m_C.x=b.m_sweep.c.x+c-this.m_target.x;this.m_C.y=b.m_sweep.c.y+f-this.m_target.y;b.m_angularVelocity*=0.98;this.m_impulse.x*=
a.dtRatio;this.m_impulse.y*=a.dtRatio;b.m_linearVelocity.x+=e*this.m_impulse.x;b.m_linearVelocity.y+=e*this.m_impulse.y;b.m_angularVelocity+=d*(c*this.m_impulse.y-f*this.m_impulse.x)};A.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyB,c,f=0,e=0;c=b.m_xf.R;var d=this.m_localAnchor.x-b.m_sweep.localCenter.x,g=this.m_localAnchor.y-b.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*g,g=c.col1.y*d+c.col2.y*g,d=f,f=b.m_linearVelocity.x+-b.m_angularVelocity*g,h=b.m_linearVelocity.y+b.m_angularVelocity*
d;c=this.m_mass;f=f+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;e=h+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;h=-(c.col1.x*f+c.col2.x*e);e=-(c.col1.y*f+c.col2.y*e);c=this.m_impulse.x;f=this.m_impulse.y;this.m_impulse.x+=h;this.m_impulse.y+=e;a=a.dt*this.m_maxForce;this.m_impulse.LengthSquared()>a*a&&this.m_impulse.Multiply(a/this.m_impulse.Length());h=this.m_impulse.x-c;e=this.m_impulse.y-f;b.m_linearVelocity.x+=b.m_invMass*h;b.m_linearVelocity.y+=b.m_invMass*e;b.m_angularVelocity+=
b.m_invI*(d*e-g*h)};A.prototype.SolvePositionConstraints=function(){return!0};Box2D.inherit(z,Box2D.Dynamics.Joints.b2JointDef);z.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;z.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.target=new e};z.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_mouseJoint;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};Box2D.inherit(D,Box2D.Dynamics.Joints.b2Joint);
D.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;D.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new e;this.m_localAnchor2=new e;this.m_localXAxis1=new e;this.m_localYAxis1=new e;this.m_axis=new e;this.m_perp=new e;this.m_K=new a;this.m_impulse=new d};D.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};D.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};
D.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new e(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};D.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.y};D.prototype.GetJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.GetWorldPoint(this.m_localAnchor1),f=b.GetWorldPoint(this.m_localAnchor2),b=f.x-c.x,
c=f.y-c.y,a=a.GetWorldVector(this.m_localXAxis1);return a.x*b+a.y*c};D.prototype.GetJointSpeed=function(){var a=this.m_bodyA,b=this.m_bodyB,c;c=a.m_xf.R;var f=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,d=c.col1.x*f+c.col2.x*e,e=c.col1.y*f+c.col2.y*e,f=d;c=b.m_xf.R;var g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,h=this.m_localAnchor2.y-b.m_sweep.localCenter.y,d=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=d;c=b.m_sweep.c.x+g-(a.m_sweep.c.x+
f);var d=b.m_sweep.c.y+h-(a.m_sweep.c.y+e),k=a.GetWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*k.y+d*a*k.x+(k.x*(m.x+-b*h-l.x- -a*e)+k.y*(m.y+b*g-l.y-a*f))};D.prototype.IsLimitEnabled=function(){return this.m_enableLimit};D.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=a};D.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};D.prototype.GetUpperLimit=
function(){return this.m_upperTranslation};D.prototype.SetLimits=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b};D.prototype.IsMotorEnabled=function(){return this.m_enableMotor};D.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};D.prototype.SetMotorSpeed=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);
this.m_motorSpeed=a};D.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};D.prototype.SetMaxMotorForce=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=a};D.prototype.GetMotorForce=function(){return this.m_motorImpulse};D.prototype.b2PrismaticJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_localXAxis1.SetV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;
this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=v.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};D.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyA,
e=this.m_bodyB,d,g=0;this.m_localCenterA.SetV(c.GetLocalCenter());this.m_localCenterB.SetV(e.GetLocalCenter());var h=c.GetTransform();e.GetTransform();d=c.m_xf.R;var k=this.m_localAnchor1.x-this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y,g=d.col1.x*k+d.col2.x*u,u=d.col1.y*k+d.col2.y*u,k=g;d=e.m_xf.R;var p=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y,g=d.col1.x*p+d.col2.x*l,l=d.col1.y*p+d.col2.y*l,p=g;d=e.m_sweep.c.x+p-c.m_sweep.c.x-
k;g=e.m_sweep.c.y+l-c.m_sweep.c.y-u;this.m_invMassA=c.m_invMass;this.m_invMassB=e.m_invMass;this.m_invIA=c.m_invI;this.m_invIB=e.m_invI;this.m_axis.SetV(f.MulMV(h.R,this.m_localXAxis1));this.m_a1=(d+k)*this.m_axis.y-(g+u)*this.m_axis.x;this.m_a2=p*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);this.m_perp.SetV(f.MulMV(h.R,this.m_localYAxis1));
this.m_s1=(d+k)*this.m_perp.y-(g+u)*this.m_perp.x;this.m_s2=p*this.m_perp.y-l*this.m_perp.x;h=this.m_invMassA;k=this.m_invMassB;u=this.m_invIA;p=this.m_invIB;this.m_K.col1.x=h+k+u*this.m_s1*this.m_s1+p*this.m_s2*this.m_s2;this.m_K.col1.y=u*this.m_s1+p*this.m_s2;this.m_K.col1.z=u*this.m_s1*this.m_a1+p*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=u+p;this.m_K.col2.z=u*this.m_a1+p*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=h+k+u*this.m_a1*
this.m_a1+p*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*g,f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop?this.m_limitState=v.e_equalLimits:d<=this.m_lowerTranslation?this.m_limitState!=v.e_atLowerLimit&&(this.m_limitState=v.e_atLowerLimit,this.m_impulse.z=0):d>=this.m_upperTranslation?this.m_limitState!=v.e_atUpperLimit&&(this.m_limitState=v.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=v.e_inactiveLimit,this.m_impulse.z=0)):this.m_limitState=
v.e_inactiveLimit;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,g=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,h=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+
this.m_impulse.z)*this.m_a2,c.m_linearVelocity.x-=this.m_invMassA*a,c.m_linearVelocity.y-=this.m_invMassA*d,c.m_angularVelocity-=this.m_invIA*g,e.m_linearVelocity.x+=this.m_invMassB*a,e.m_linearVelocity.y+=this.m_invMassB*d,e.m_angularVelocity+=this.m_invIB*h):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};D.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyA,c=this.m_bodyB,g=b.m_linearVelocity,h=b.m_angularVelocity,k=c.m_linearVelocity,l=c.m_angularVelocity,u=0,p=0,m=0,r=0;this.m_enableMotor&&
this.m_limitState!=v.e_equalLimits&&(r=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(k.x-g.x)+this.m_axis.y*(k.y-g.y)+this.m_a2*l-this.m_a1*h)),u=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=f.Clamp(this.m_motorImpulse+r,-a,a),r=this.m_motorImpulse-u,u=r*this.m_axis.x,p=r*this.m_axis.y,m=r*this.m_a1,r*=this.m_a2,g.x-=this.m_invMassA*u,g.y-=this.m_invMassA*p,h-=this.m_invIA*m,k.x+=this.m_invMassB*u,k.y+=this.m_invMassB*p,l+=this.m_invIB*r);m=this.m_perp.x*(k.x-g.x)+this.m_perp.y*
(k.y-g.y)+this.m_s2*l-this.m_s1*h;p=l-h;this.m_enableLimit&&this.m_limitState!=v.e_inactiveLimit?(a=this.m_axis.x*(k.x-g.x)+this.m_axis.y*(k.y-g.y)+this.m_a2*l-this.m_a1*h,u=this.m_impulse.Copy(),a=this.m_K.Solve33(new d,-m,-p,-a),this.m_impulse.Add(a),this.m_limitState==v.e_atLowerLimit?this.m_impulse.z=f.Max(this.m_impulse.z,0):this.m_limitState==v.e_atUpperLimit&&(this.m_impulse.z=f.Min(this.m_impulse.z,0)),m=-m-(this.m_impulse.z-u.z)*this.m_K.col3.x,p=-p-(this.m_impulse.z-u.z)*this.m_K.col3.y,
p=this.m_K.Solve22(new e,m,p),p.x+=u.x,p.y+=u.y,this.m_impulse.x=p.x,this.m_impulse.y=p.y,a.x=this.m_impulse.x-u.x,a.y=this.m_impulse.y-u.y,a.z=this.m_impulse.z-u.z,u=a.x*this.m_perp.x+a.z*this.m_axis.x,p=a.x*this.m_perp.y+a.z*this.m_axis.y,m=a.x*this.m_s1+a.y+a.z*this.m_a1,r=a.x*this.m_s2+a.y+a.z*this.m_a2):(a=this.m_K.Solve22(new e,-m,-p),this.m_impulse.x+=a.x,this.m_impulse.y+=a.y,u=a.x*this.m_perp.x,p=a.x*this.m_perp.y,m=a.x*this.m_s1+a.y,r=a.x*this.m_s2+a.y);g.x-=this.m_invMassA*u;g.y-=this.m_invMassA*
p;h-=this.m_invIA*m;k.x+=this.m_invMassB*u;k.y+=this.m_invMassB*p;l+=this.m_invIB*r;b.m_linearVelocity.SetV(g);b.m_angularVelocity=h;c.m_linearVelocity.SetV(k);c.m_angularVelocity=l};D.prototype.SolvePositionConstraints=function(){var a=this.m_bodyA,g=this.m_bodyB,h=a.m_sweep.c,k=a.m_sweep.a,l=g.m_sweep.c,m=g.m_sweep.a,r,u=0,p=0,s=0,v=0,x=0,p=!1,w=0,z=c.FromAngle(k),A=c.FromAngle(m);r=z;var x=this.m_localAnchor1.x-this.m_localCenterA.x,C=this.m_localAnchor1.y-this.m_localCenterA.y,u=r.col1.x*x+r.col2.x*
C,C=r.col1.y*x+r.col2.y*C,x=u;r=A;A=this.m_localAnchor2.x-this.m_localCenterB.x;s=this.m_localAnchor2.y-this.m_localCenterB.y;u=r.col1.x*A+r.col2.x*s;s=r.col1.y*A+r.col2.y*s;A=u;r=l.x+A-h.x-x;u=l.y+s-h.y-C;if(this.m_enableLimit){this.m_axis=f.MulMV(z,this.m_localXAxis1);this.m_a1=(r+x)*this.m_axis.y-(u+C)*this.m_axis.x;this.m_a2=A*this.m_axis.y-s*this.m_axis.x;var D=this.m_axis.x*r+this.m_axis.y*u;f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop?(w=f.Clamp(D,-b.b2_maxLinearCorrection,
b.b2_maxLinearCorrection),v=f.Abs(D),p=!0):D<=this.m_lowerTranslation?(w=f.Clamp(D-this.m_lowerTranslation+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),v=this.m_lowerTranslation-D,p=!0):D>=this.m_upperTranslation&&(w=f.Clamp(D-this.m_upperTranslation+b.b2_linearSlop,0,b.b2_maxLinearCorrection),v=D-this.m_upperTranslation,p=!0)}this.m_perp=f.MulMV(z,this.m_localYAxis1);this.m_s1=(r+x)*this.m_perp.y-(u+C)*this.m_perp.x;this.m_s2=A*this.m_perp.y-s*this.m_perp.x;z=new d;C=this.m_perp.x*r+this.m_perp.y*
u;A=m-k-this.m_refAngle;v=f.Max(v,f.Abs(C));x=f.Abs(A);p?(p=this.m_invMassA,s=this.m_invMassB,r=this.m_invIA,u=this.m_invIB,this.m_K.col1.x=p+s+r*this.m_s1*this.m_s1+u*this.m_s2*this.m_s2,this.m_K.col1.y=r*this.m_s1+u*this.m_s2,this.m_K.col1.z=r*this.m_s1*this.m_a1+u*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=r+u,this.m_K.col2.z=r*this.m_a1+u*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=p+s+r*this.m_a1*this.m_a1+u*this.m_a2*this.m_a2,
this.m_K.Solve33(z,-C,-A,-w)):(p=this.m_invMassA,s=this.m_invMassB,r=this.m_invIA,u=this.m_invIB,w=r*this.m_s1+u*this.m_s2,D=r+u,this.m_K.col1.Set(p+s+r*this.m_s1*this.m_s1+u*this.m_s2*this.m_s2,w,0),this.m_K.col2.Set(w,D,0),w=this.m_K.Solve22(new e,-C,-A),z.x=w.x,z.y=w.y,z.z=0);w=z.x*this.m_perp.x+z.z*this.m_axis.x;p=z.x*this.m_perp.y+z.z*this.m_axis.y;C=z.x*this.m_s1+z.y+z.z*this.m_a1;z=z.x*this.m_s2+z.y+z.z*this.m_a2;h.x-=this.m_invMassA*w;h.y-=this.m_invMassA*p;k-=this.m_invIA*C;l.x+=this.m_invMassB*
w;l.y+=this.m_invMassB*p;m+=this.m_invIB*z;a.m_sweep.a=k;g.m_sweep.a=m;a.SynchronizeTransform();g.SynchronizeTransform();return v<=b.b2_linearSlop&&x<=b.b2_angularSlop};Box2D.inherit(H,Box2D.Dynamics.Joints.b2JointDef);H.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;H.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new e;this.localAnchorB=new e;this.localAxisA=new e};H.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);
this.type=v.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};H.prototype.Initialize=function(a,b,c,f){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.GetLocalPoint(c);this.localAnchorB=this.bodyB.GetLocalPoint(c);this.localAxisA=this.bodyA.GetLocalVector(f);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(C,Box2D.Dynamics.Joints.b2Joint);
C.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;C.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new e;this.m_groundAnchor2=new e;this.m_localAnchor1=new e;this.m_localAnchor2=new e;this.m_u1=new e;this.m_u2=new e};C.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};C.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};C.prototype.GetReactionForce=function(a){void 0===
a&&(a=0);return new e(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)};C.prototype.GetReactionTorque=function(){return 0};C.prototype.GetGroundAnchorA=function(){var a=this.m_ground.m_xf.position.Copy();a.Add(this.m_groundAnchor1);return a};C.prototype.GetGroundAnchorB=function(){var a=this.m_ground.m_xf.position.Copy();a.Add(this.m_groundAnchor2);return a};C.prototype.GetLength1=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),
a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(b*b+a*a)};C.prototype.GetLength2=function(){var a=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(b*b+a*a)};C.prototype.GetRatio=function(){return this.m_ratio};C.prototype.b2PulleyJoint=function(a){this.__super.b2Joint.call(this,a);this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=
a.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_maxLength1=f.Min(a.maxLengthA,this.m_constant-this.m_ratio*C.b2_minPulleyLength);
this.m_maxLength2=f.Min(a.maxLengthB,(this.m_constant-C.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};C.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyA,f=this.m_bodyB,e;e=c.m_xf.R;var d=this.m_localAnchor1.x-c.m_sweep.localCenter.x,g=this.m_localAnchor1.y-c.m_sweep.localCenter.y,h=e.col1.x*d+e.col2.x*g,g=e.col1.y*d+e.col2.y*g,d=h;e=f.m_xf.R;var k=this.m_localAnchor2.x-f.m_sweep.localCenter.x,p=this.m_localAnchor2.y-f.m_sweep.localCenter.y,
h=e.col1.x*k+e.col2.x*p,p=e.col1.y*k+e.col2.y*p,k=h;e=f.m_sweep.c.x+k;var h=f.m_sweep.c.y+p,l=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,m=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(c.m_sweep.c.x+d-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),c.m_sweep.c.y+g-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.Set(e-l,h-m);e=this.m_u1.Length();h=this.m_u2.Length();e>b.b2_linearSlop?this.m_u1.Multiply(1/e):this.m_u1.SetZero();h>b.b2_linearSlop?
this.m_u2.Multiply(1/h):this.m_u2.SetZero();0<this.m_constant-e-this.m_ratio*h?(this.m_state=v.e_inactiveLimit,this.m_impulse=0):this.m_state=v.e_atUpperLimit;e<this.m_maxLength1?(this.m_limitState1=v.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=v.e_atUpperLimit;h<this.m_maxLength2?(this.m_limitState2=v.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=v.e_atUpperLimit;e=d*this.m_u1.y-g*this.m_u1.x;h=k*this.m_u2.y-p*this.m_u2.x;this.m_limitMass1=c.m_invMass+c.m_invI*e*e;this.m_limitMass2=
f.m_invMass+f.m_invI*h*h;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;a.warmStarting?(this.m_impulse*=a.dtRatio,this.m_limitImpulse1*=a.dtRatio,this.m_limitImpulse2*=a.dtRatio,a=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,e=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,h=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,l=(-this.m_ratio*
this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,c.m_linearVelocity.x+=c.m_invMass*a,c.m_linearVelocity.y+=c.m_invMass*e,c.m_angularVelocity+=c.m_invI*(d*e-g*a),f.m_linearVelocity.x+=f.m_invMass*h,f.m_linearVelocity.y+=f.m_invMass*l,f.m_angularVelocity+=f.m_invI*(k*l-p*h)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};C.prototype.SolveVelocityConstraints=function(){var a=this.m_bodyA,b=this.m_bodyB,c;c=a.m_xf.R;var e=this.m_localAnchor1.x-a.m_sweep.localCenter.x,d=this.m_localAnchor1.y-
a.m_sweep.localCenter.y,g=c.col1.x*e+c.col2.x*d,d=c.col1.y*e+c.col2.y*d,e=g;c=b.m_xf.R;var h=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,g=c.col1.x*h+c.col2.x*k,k=c.col1.y*h+c.col2.y*k,h=g,p=0,l=0;this.m_state==v.e_atUpperLimit&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*d,g=a.m_linearVelocity.y+a.m_angularVelocity*e,p=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*h,c=-(this.m_u1.x*c+this.m_u1.y*g)-this.m_ratio*
(this.m_u2.x*p+this.m_u2.y*l),l=this.m_pulleyMass*-c,c=this.m_impulse,this.m_impulse=f.Max(0,this.m_impulse+l),l=this.m_impulse-c,c=-l*this.m_u1.x,g=-l*this.m_u1.y,p=-this.m_ratio*l*this.m_u2.x,l=-this.m_ratio*l*this.m_u2.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*g,a.m_angularVelocity+=a.m_invI*(e*g-d*c),b.m_linearVelocity.x+=b.m_invMass*p,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(h*l-k*p));this.m_limitState1==v.e_atUpperLimit&&(c=a.m_linearVelocity.x+
-a.m_angularVelocity*d,g=a.m_linearVelocity.y+a.m_angularVelocity*e,c=-(this.m_u1.x*c+this.m_u1.y*g),l=-this.m_limitMass1*c,c=this.m_limitImpulse1,this.m_limitImpulse1=f.Max(0,this.m_limitImpulse1+l),l=this.m_limitImpulse1-c,c=-l*this.m_u1.x,g=-l*this.m_u1.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*g,a.m_angularVelocity+=a.m_invI*(e*g-d*c));this.m_limitState2==v.e_atUpperLimit&&(p=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*h,
c=-(this.m_u2.x*p+this.m_u2.y*l),l=-this.m_limitMass2*c,c=this.m_limitImpulse2,this.m_limitImpulse2=f.Max(0,this.m_limitImpulse2+l),l=this.m_limitImpulse2-c,p=-l*this.m_u2.x,l=-l*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*p,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(h*l-k*p))};C.prototype.SolvePositionConstraints=function(){var a=this.m_bodyA,c=this.m_bodyB,e,d=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,h=
this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,k=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,l=0,p=0,m=0,r=0,s=0,x=0,w=0,z=0;this.m_state==v.e_atUpperLimit&&(e=a.m_xf.R,l=this.m_localAnchor1.x-a.m_sweep.localCenter.x,p=this.m_localAnchor1.y-a.m_sweep.localCenter.y,s=e.col1.x*l+e.col2.x*p,p=e.col1.y*l+e.col2.y*p,l=s,e=c.m_xf.R,m=this.m_localAnchor2.x-c.m_sweep.localCenter.x,r=this.m_localAnchor2.y-c.m_sweep.localCenter.y,s=e.col1.x*m+e.col2.x*r,r=e.col1.y*m+e.col2.y*r,m=s,e=a.m_sweep.c.x+
l,s=a.m_sweep.c.y+p,x=c.m_sweep.c.x+m,w=c.m_sweep.c.y+r,this.m_u1.Set(e-d,s-g),this.m_u2.Set(x-h,w-k),e=this.m_u1.Length(),s=this.m_u2.Length(),e>b.b2_linearSlop?this.m_u1.Multiply(1/e):this.m_u1.SetZero(),s>b.b2_linearSlop?this.m_u2.Multiply(1/s):this.m_u2.SetZero(),e=this.m_constant-e-this.m_ratio*s,z=f.Max(z,-e),e=f.Clamp(e+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),w=-this.m_pulleyMass*e,e=-w*this.m_u1.x,s=-w*this.m_u1.y,x=-this.m_ratio*w*this.m_u2.x,w=-this.m_ratio*w*this.m_u2.y,a.m_sweep.c.x+=
a.m_invMass*e,a.m_sweep.c.y+=a.m_invMass*s,a.m_sweep.a+=a.m_invI*(l*s-p*e),c.m_sweep.c.x+=c.m_invMass*x,c.m_sweep.c.y+=c.m_invMass*w,c.m_sweep.a+=c.m_invI*(m*w-r*x),a.SynchronizeTransform(),c.SynchronizeTransform());this.m_limitState1==v.e_atUpperLimit&&(e=a.m_xf.R,l=this.m_localAnchor1.x-a.m_sweep.localCenter.x,p=this.m_localAnchor1.y-a.m_sweep.localCenter.y,s=e.col1.x*l+e.col2.x*p,p=e.col1.y*l+e.col2.y*p,l=s,e=a.m_sweep.c.x+l,s=a.m_sweep.c.y+p,this.m_u1.Set(e-d,s-g),e=this.m_u1.Length(),e>b.b2_linearSlop?
(this.m_u1.x*=1/e,this.m_u1.y*=1/e):this.m_u1.SetZero(),e=this.m_maxLength1-e,z=f.Max(z,-e),e=f.Clamp(e+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),w=-this.m_limitMass1*e,e=-w*this.m_u1.x,s=-w*this.m_u1.y,a.m_sweep.c.x+=a.m_invMass*e,a.m_sweep.c.y+=a.m_invMass*s,a.m_sweep.a+=a.m_invI*(l*s-p*e),a.SynchronizeTransform());this.m_limitState2==v.e_atUpperLimit&&(e=c.m_xf.R,m=this.m_localAnchor2.x-c.m_sweep.localCenter.x,r=this.m_localAnchor2.y-c.m_sweep.localCenter.y,s=e.col1.x*m+e.col2.x*r,r=e.col1.y*
m+e.col2.y*r,m=s,x=c.m_sweep.c.x+m,w=c.m_sweep.c.y+r,this.m_u2.Set(x-h,w-k),s=this.m_u2.Length(),s>b.b2_linearSlop?(this.m_u2.x*=1/s,this.m_u2.y*=1/s):this.m_u2.SetZero(),e=this.m_maxLength2-s,z=f.Max(z,-e),e=f.Clamp(e+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),w=-this.m_limitMass2*e,x=-w*this.m_u2.x,w=-w*this.m_u2.y,c.m_sweep.c.x+=c.m_invMass*x,c.m_sweep.c.y+=c.m_invMass*w,c.m_sweep.a+=c.m_invI*(m*w-r*x),c.SynchronizeTransform());return z<b.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=
2});Box2D.inherit(M,Box2D.Dynamics.Joints.b2JointDef);M.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;M.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new e;this.groundAnchorB=new e;this.localAnchorA=new e;this.localAnchorB=new e};M.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_pulleyJoint;this.groundAnchorA.Set(-1,1);this.groundAnchorB.Set(1,1);this.localAnchorA.Set(-1,0);this.localAnchorB.Set(1,
0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=!0};M.prototype.Initialize=function(a,b,c,f,e,d,g){void 0===g&&(g=0);this.bodyA=a;this.bodyB=b;this.groundAnchorA.SetV(c);this.groundAnchorB.SetV(f);this.localAnchorA=this.bodyA.GetLocalPoint(e);this.localAnchorB=this.bodyB.GetLocalPoint(d);a=e.x-c.x;c=e.y-c.y;this.lengthA=Math.sqrt(a*a+c*c);c=d.x-f.x;f=d.y-f.y;this.lengthB=Math.sqrt(c*c+f*f);this.ratio=g;g=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=
g-this.ratio*C.b2_minPulleyLength;this.maxLengthB=(g-C.b2_minPulleyLength)/this.ratio};Box2D.inherit(G,Box2D.Dynamics.Joints.b2Joint);G.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;G.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new c;this.K1=new c;this.K2=new c;this.K3=new c;this.impulse3=new d;this.impulse2=new e;this.reduced=new e;this.m_localAnchor1=new e;this.m_localAnchor2=new e;this.m_impulse=new d;this.m_mass=new a};G.prototype.GetAnchorA=
function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};G.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};G.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new e(a*this.m_impulse.x,a*this.m_impulse.y)};G.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.z};G.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};G.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-
this.m_bodyA.m_angularVelocity};G.prototype.IsLimitEnabled=function(){return this.m_enableLimit};G.prototype.EnableLimit=function(a){this.m_enableLimit=a};G.prototype.GetLowerLimit=function(){return this.m_lowerAngle};G.prototype.GetUpperLimit=function(){return this.m_upperAngle};G.prototype.SetLimits=function(a,b){void 0===a&&(a=0);void 0===b&&(b=0);this.m_lowerAngle=a;this.m_upperAngle=b};G.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);return this.m_enableMotor};
G.prototype.EnableMotor=function(a){this.m_enableMotor=a};G.prototype.SetMotorSpeed=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};G.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};G.prototype.SetMaxMotorTorque=function(a){void 0===a&&(a=0);this.m_maxMotorTorque=a};G.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque};G.prototype.b2RevoluteJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);
this.m_localAnchor2.SetV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=v.e_inactiveLimit};G.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyA,e=this.m_bodyB,d,g=0;d=c.m_xf.R;var h=this.m_localAnchor1.x-c.m_sweep.localCenter.x,
k=this.m_localAnchor1.y-c.m_sweep.localCenter.y,g=d.col1.x*h+d.col2.x*k,k=d.col1.y*h+d.col2.y*k,h=g;d=e.m_xf.R;var l=this.m_localAnchor2.x-e.m_sweep.localCenter.x,p=this.m_localAnchor2.y-e.m_sweep.localCenter.y,g=d.col1.x*l+d.col2.x*p,p=d.col1.y*l+d.col2.y*p,l=g;d=c.m_invMass;var g=e.m_invMass,m=c.m_invI,r=e.m_invI;this.m_mass.col1.x=d+g+k*k*m+p*p*r;this.m_mass.col2.x=-k*h*m-p*l*r;this.m_mass.col3.x=-k*m-p*r;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=d+g+h*h*m+l*l*r;this.m_mass.col3.y=
h*m+l*r;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=m+r;this.m_motorMass=1/(m+r);!1==this.m_enableMotor&&(this.m_motorImpulse=0);if(this.m_enableLimit){var s=e.m_sweep.a-c.m_sweep.a-this.m_referenceAngle;f.Abs(this.m_upperAngle-this.m_lowerAngle)<2*b.b2_angularSlop?this.m_limitState=v.e_equalLimits:s<=this.m_lowerAngle?(this.m_limitState!=v.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=v.e_atLowerLimit):s>=this.m_upperAngle?(this.m_limitState!=
v.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=v.e_atUpperLimit):(this.m_limitState=v.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=v.e_inactiveLimit;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x,s=this.m_impulse.y,c.m_linearVelocity.x-=d*a,c.m_linearVelocity.y-=d*s,c.m_angularVelocity-=m*(h*s-k*a+this.m_motorImpulse+this.m_impulse.z),e.m_linearVelocity.x+=g*a,e.m_linearVelocity.y+=g*s,e.m_angularVelocity+=
r*(l*s-p*a+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};G.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyA,c=this.m_bodyB,e=0,d=0,g=0,h=0,k=0,p=b.m_linearVelocity,l=b.m_angularVelocity,m=c.m_linearVelocity,r=c.m_angularVelocity,s=b.m_invMass,x=c.m_invMass,w=b.m_invI,z=c.m_invI;this.m_enableMotor&&this.m_limitState!=v.e_equalLimits&&(d=this.m_motorMass*-(r-l-this.m_motorSpeed),g=this.m_motorImpulse,h=a.dt*this.m_maxMotorTorque,this.m_motorImpulse=
f.Clamp(this.m_motorImpulse+d,-h,h),d=this.m_motorImpulse-g,l-=w*d,r+=z*d);if(this.m_enableLimit&&this.m_limitState!=v.e_inactiveLimit){a=b.m_xf.R;d=this.m_localAnchor1.x-b.m_sweep.localCenter.x;g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=a.col1.x*d+a.col2.x*g;g=a.col1.y*d+a.col2.y*g;d=e;a=c.m_xf.R;h=this.m_localAnchor2.x-c.m_sweep.localCenter.x;k=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=a.col1.x*h+a.col2.x*k;k=a.col1.y*h+a.col2.y*k;h=e;a=m.x+-r*k-p.x- -l*g;var A=m.y+r*h-p.y-l*d;this.m_mass.Solve33(this.impulse3,
-a,-A,-(r-l));this.m_limitState==v.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==v.e_atLowerLimit?(e=this.m_impulse.z+this.impulse3.z,0>e&&(this.m_mass.Solve22(this.reduced,-a,-A),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==v.e_atUpperLimit&&(e=this.m_impulse.z+this.impulse3.z,0<e&&(this.m_mass.Solve22(this.reduced,-a,-A),
this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0));p.x-=s*this.impulse3.x;p.y-=s*this.impulse3.y;l-=w*(d*this.impulse3.y-g*this.impulse3.x+this.impulse3.z);m.x+=x*this.impulse3.x;m.y+=x*this.impulse3.y;r+=z*(h*this.impulse3.y-k*this.impulse3.x+this.impulse3.z)}else a=b.m_xf.R,d=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,
e=a.col1.x*d+a.col2.x*g,g=a.col1.y*d+a.col2.y*g,d=e,a=c.m_xf.R,h=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,e=a.col1.x*h+a.col2.x*k,k=a.col1.y*h+a.col2.y*k,h=e,this.m_mass.Solve22(this.impulse2,-(m.x+-r*k-p.x- -l*g),-(m.y+r*h-p.y-l*d)),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,p.x-=s*this.impulse2.x,p.y-=s*this.impulse2.y,l-=w*(d*this.impulse2.y-g*this.impulse2.x),m.x+=x*this.impulse2.x,m.y+=x*this.impulse2.y,r+=z*(h*this.impulse2.y-
k*this.impulse2.x);b.m_linearVelocity.SetV(p);b.m_angularVelocity=l;c.m_linearVelocity.SetV(m);c.m_angularVelocity=r};G.prototype.SolvePositionConstraints=function(){var a=0,c,e=this.m_bodyA,d=this.m_bodyB,g=0,h=0,k=0,l=0;if(this.m_enableLimit&&this.m_limitState!=v.e_inactiveLimit){var a=d.m_sweep.a-e.m_sweep.a-this.m_referenceAngle,p=0;this.m_limitState==v.e_equalLimits?(a=f.Clamp(a-this.m_lowerAngle,-b.b2_maxAngularCorrection,b.b2_maxAngularCorrection),p=-this.m_motorMass*a,g=f.Abs(a)):this.m_limitState==
v.e_atLowerLimit?(a-=this.m_lowerAngle,g=-a,a=f.Clamp(a+b.b2_angularSlop,-b.b2_maxAngularCorrection,0),p=-this.m_motorMass*a):this.m_limitState==v.e_atUpperLimit&&(g=a-=this.m_upperAngle,a=f.Clamp(a-b.b2_angularSlop,0,b.b2_maxAngularCorrection),p=-this.m_motorMass*a);e.m_sweep.a-=e.m_invI*p;d.m_sweep.a+=d.m_invI*p;e.SynchronizeTransform();d.SynchronizeTransform()}c=e.m_xf.R;p=this.m_localAnchor1.x-e.m_sweep.localCenter.x;a=this.m_localAnchor1.y-e.m_sweep.localCenter.y;h=c.col1.x*p+c.col2.x*a;a=c.col1.y*
p+c.col2.y*a;p=h;c=d.m_xf.R;var m=this.m_localAnchor2.x-d.m_sweep.localCenter.x,r=this.m_localAnchor2.y-d.m_sweep.localCenter.y,h=c.col1.x*m+c.col2.x*r,r=c.col1.y*m+c.col2.y*r,m=h,k=d.m_sweep.c.x+m-e.m_sweep.c.x-p,l=d.m_sweep.c.y+r-e.m_sweep.c.y-a,s=k*k+l*l;c=Math.sqrt(s);var h=e.m_invMass,x=d.m_invMass,w=e.m_invI,z=d.m_invI,A=10*b.b2_linearSlop;s>A*A&&(s=1/(h+x),k=s*-k,l=s*-l,e.m_sweep.c.x-=0.5*h*k,e.m_sweep.c.y-=0.5*h*l,d.m_sweep.c.x+=0.5*x*k,d.m_sweep.c.y+=0.5*x*l,k=d.m_sweep.c.x+m-e.m_sweep.c.x-
p,l=d.m_sweep.c.y+r-e.m_sweep.c.y-a);this.K1.col1.x=h+x;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=h+x;this.K2.col1.x=w*a*a;this.K2.col2.x=-w*p*a;this.K2.col1.y=-w*p*a;this.K2.col2.y=w*p*p;this.K3.col1.x=z*r*r;this.K3.col2.x=-z*m*r;this.K3.col1.y=-z*m*r;this.K3.col2.y=z*m*m;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(G.tImpulse,-k,-l);k=G.tImpulse.x;l=G.tImpulse.y;e.m_sweep.c.x-=e.m_invMass*k;e.m_sweep.c.y-=e.m_invMass*l;e.m_sweep.a-=e.m_invI*(p*l-a*k);d.m_sweep.c.x+=
d.m_invMass*k;d.m_sweep.c.y+=d.m_invMass*l;d.m_sweep.a+=d.m_invI*(m*l-r*k);e.SynchronizeTransform();d.SynchronizeTransform();return c<=b.b2_linearSlop&&g<=b.b2_angularSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new e});Box2D.inherit(I,Box2D.Dynamics.Joints.b2JointDef);I.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;I.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new e;this.localAnchorB=
new e};I.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_revoluteJoint;this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=!1};I.prototype.Initialize=function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.GetLocalPoint(c);this.localAnchorB=this.bodyB.GetLocalPoint(c);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};
Box2D.inherit(N,Box2D.Dynamics.Joints.b2Joint);N.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;N.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new e;this.m_localAnchorB=new e;this.m_impulse=new d;this.m_mass=new a};N.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};N.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};N.prototype.GetReactionForce=function(a){void 0===
a&&(a=0);return new e(a*this.m_impulse.x,a*this.m_impulse.y)};N.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.z};N.prototype.b2WeldJoint=function(b){this.__super.b2Joint.call(this,b);this.m_localAnchorA.SetV(b.localAnchorA);this.m_localAnchorB.SetV(b.localAnchorB);this.m_referenceAngle=b.referenceAngle;this.m_impulse.SetZero();this.m_mass=new a};N.prototype.InitVelocityConstraints=function(a){var b,c=0,f=this.m_bodyA,e=this.m_bodyB;b=f.m_xf.R;var d=this.m_localAnchorA.x-
f.m_sweep.localCenter.x,g=this.m_localAnchorA.y-f.m_sweep.localCenter.y,c=b.col1.x*d+b.col2.x*g,g=b.col1.y*d+b.col2.y*g,d=c;b=e.m_xf.R;var h=this.m_localAnchorB.x-e.m_sweep.localCenter.x,k=this.m_localAnchorB.y-e.m_sweep.localCenter.y,c=b.col1.x*h+b.col2.x*k,k=b.col1.y*h+b.col2.y*k,h=c;b=f.m_invMass;var c=e.m_invMass,l=f.m_invI,m=e.m_invI;this.m_mass.col1.x=b+c+g*g*l+k*k*m;this.m_mass.col2.x=-g*d*l-k*h*m;this.m_mass.col3.x=-g*l-k*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+d*d*
l+h*h*m;this.m_mass.col3.y=d*l+h*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,f.m_linearVelocity.x-=b*this.m_impulse.x,f.m_linearVelocity.y-=b*this.m_impulse.y,f.m_angularVelocity-=l*(d*this.m_impulse.y-g*this.m_impulse.x+this.m_impulse.z),e.m_linearVelocity.x+=c*this.m_impulse.x,e.m_linearVelocity.y+=c*this.m_impulse.y,e.m_angularVelocity+=m*
(h*this.m_impulse.y-k*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()};N.prototype.SolveVelocityConstraints=function(){var a,b=0,c=this.m_bodyA,f=this.m_bodyB,e=c.m_linearVelocity,g=c.m_angularVelocity,h=f.m_linearVelocity,k=f.m_angularVelocity,p=c.m_invMass,l=f.m_invMass,m=c.m_invI,r=f.m_invI;a=c.m_xf.R;var s=this.m_localAnchorA.x-c.m_sweep.localCenter.x,v=this.m_localAnchorA.y-c.m_sweep.localCenter.y,b=a.col1.x*s+a.col2.x*v,v=a.col1.y*s+a.col2.y*v,s=b;a=f.m_xf.R;var x=this.m_localAnchorB.x-
f.m_sweep.localCenter.x,w=this.m_localAnchorB.y-f.m_sweep.localCenter.y,b=a.col1.x*x+a.col2.x*w,w=a.col1.y*x+a.col2.y*w,x=b;a=h.x-k*w-e.x+g*v;var b=h.y+k*x-e.y-g*s,z=k-g,A=new d;this.m_mass.Solve33(A,-a,-b,-z);this.m_impulse.Add(A);e.x-=p*A.x;e.y-=p*A.y;g-=m*(s*A.y-v*A.x+A.z);h.x+=l*A.x;h.y+=l*A.y;k+=r*(x*A.y-w*A.x+A.z);c.m_angularVelocity=g;f.m_angularVelocity=k};N.prototype.SolvePositionConstraints=function(){var a,c=0,e=this.m_bodyA,g=this.m_bodyB;a=e.m_xf.R;var h=this.m_localAnchorA.x-e.m_sweep.localCenter.x,
k=this.m_localAnchorA.y-e.m_sweep.localCenter.y,c=a.col1.x*h+a.col2.x*k,k=a.col1.y*h+a.col2.y*k,h=c;a=g.m_xf.R;var l=this.m_localAnchorB.x-g.m_sweep.localCenter.x,m=this.m_localAnchorB.y-g.m_sweep.localCenter.y,c=a.col1.x*l+a.col2.x*m,m=a.col1.y*l+a.col2.y*m,l=c;a=e.m_invMass;var c=g.m_invMass,p=e.m_invI,r=g.m_invI,s=g.m_sweep.c.x+l-e.m_sweep.c.x-h,v=g.m_sweep.c.y+m-e.m_sweep.c.y-k,x=g.m_sweep.a-e.m_sweep.a-this.m_referenceAngle,w=10*b.b2_linearSlop,z=Math.sqrt(s*s+v*v),A=f.Abs(x);z>w&&(p*=1,r*=1);
this.m_mass.col1.x=a+c+k*k*p+m*m*r;this.m_mass.col2.x=-k*h*p-m*l*r;this.m_mass.col3.x=-k*p-m*r;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=a+c+h*h*p+l*l*r;this.m_mass.col3.y=h*p+l*r;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=p+r;w=new d;this.m_mass.Solve33(w,-s,-v,-x);e.m_sweep.c.x-=a*w.x;e.m_sweep.c.y-=a*w.y;e.m_sweep.a-=p*(h*w.y-k*w.x+w.z);g.m_sweep.c.x+=c*w.x;g.m_sweep.c.y+=c*w.y;g.m_sweep.a+=r*(l*w.y-m*w.x+w.z);e.SynchronizeTransform();
g.SynchronizeTransform();return z<=b.b2_linearSlop&&A<=b.b2_angularSlop};Box2D.inherit(L,Box2D.Dynamics.Joints.b2JointDef);L.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;L.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new e;this.localAnchorB=new e};L.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=v.e_weldJoint;this.referenceAngle=0};L.prototype.Initialize=function(a,b,c){this.bodyA=a;
this.bodyB=b;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(c));this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}})();
(function(){var b=Box2D.Dynamics.b2DebugDraw;b.b2DebugDraw=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;var b=this;this.m_sprite={graphics:{clear:function(){b.m_ctx.clearRect(0,0,b.m_ctx.canvas.width,b.m_ctx.canvas.height)}}}};b.prototype._color=function(b,a){return"rgba("+((b&16711680)>>16)+","+((b&65280)>>8)+","+(b&255)+","+a+")"};b.prototype.b2DebugDraw=function(){this.m_drawFlags=0};b.prototype.SetFlags=function(b){void 0===b&&(b=0);this.m_drawFlags=
b};b.prototype.GetFlags=function(){return this.m_drawFlags};b.prototype.AppendFlags=function(b){void 0===b&&(b=0);this.m_drawFlags|=b};b.prototype.ClearFlags=function(b){void 0===b&&(b=0);this.m_drawFlags&=~b};b.prototype.SetSprite=function(b){this.m_ctx=b};b.prototype.GetSprite=function(){return this.m_ctx};b.prototype.SetDrawScale=function(b){void 0===b&&(b=0);this.m_drawScale=b};b.prototype.GetDrawScale=function(){return this.m_drawScale};b.prototype.SetLineThickness=function(b){void 0===b&&(b=
0);this.m_lineThickness=b;this.m_ctx.strokeWidth=b};b.prototype.GetLineThickness=function(){return this.m_lineThickness};b.prototype.SetAlpha=function(b){void 0===b&&(b=0);this.m_alpha=b};b.prototype.GetAlpha=function(){return this.m_alpha};b.prototype.SetFillAlpha=function(b){void 0===b&&(b=0);this.m_fillAlpha=b};b.prototype.GetFillAlpha=function(){return this.m_fillAlpha};b.prototype.SetXFormScale=function(b){void 0===b&&(b=0);this.m_xformScale=b};b.prototype.GetXFormScale=function(){return this.m_xformScale};
b.prototype.DrawPolygon=function(b,a,f){if(a){var e=this.m_ctx,d=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(f.color,this.m_alpha);e.moveTo(b[0].x*d,b[0].y*d);for(f=1;f<a;f++)e.lineTo(b[f].x*d,b[f].y*d);e.lineTo(b[0].x*d,b[0].y*d);e.closePath();e.stroke()}};b.prototype.DrawSolidPolygon=function(b,a,f){if(a){var e=this.m_ctx,d=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(f.color,this.m_alpha);e.fillStyle=this._color(f.color,this.m_fillAlpha);e.moveTo(b[0].x*d,b[0].y*d);for(f=
1;f<a;f++)e.lineTo(b[f].x*d,b[f].y*d);e.lineTo(b[0].x*d,b[0].y*d);e.closePath();e.fill();e.stroke()}};b.prototype.DrawCircle=function(b,a,f){if(a){var e=this.m_ctx,d=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(f.color,this.m_alpha);e.arc(b.x*d,b.y*d,a*d,0,2*Math.PI,!0);e.closePath();e.stroke()}};b.prototype.DrawSolidCircle=function(b,a,f,e){if(a){var d=this.m_ctx,g=this.m_drawScale,h=b.x*g,k=b.y*g;d.moveTo(0,0);d.beginPath();d.strokeStyle=this._color(e.color,this.m_alpha);d.fillStyle=
this._color(e.color,this.m_fillAlpha);d.arc(h,k,a*g,0,2*Math.PI,!0);d.moveTo(h,k);d.lineTo((b.x+f.x*a)*g,(b.y+f.y*a)*g);d.closePath();d.fill();d.stroke()}};b.prototype.DrawSegment=function(b,a,f){var e=this.m_ctx,d=this.m_drawScale;e.strokeStyle=this._color(f.color,this.m_alpha);e.beginPath();e.moveTo(b.x*d,b.y*d);e.lineTo(a.x*d,a.y*d);e.closePath();e.stroke()};b.prototype.DrawTransform=function(b){var a=this.m_ctx,f=this.m_drawScale;a.beginPath();a.strokeStyle=this._color(16711680,this.m_alpha);
a.moveTo(b.position.x*f,b.position.y*f);a.lineTo((b.position.x+this.m_xformScale*b.R.col1.x)*f,(b.position.y+this.m_xformScale*b.R.col1.y)*f);a.strokeStyle=this._color(65280,this.m_alpha);a.moveTo(b.position.x*f,b.position.y*f);a.lineTo((b.position.x+this.m_xformScale*b.R.col2.x)*f,(b.position.y+this.m_xformScale*b.R.col2.y)*f);a.closePath();a.stroke()}})();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs;
(function(b,c,a){function f(a){return"[object Function]"==w.call(a)}function e(a){return"string"==typeof a}function d(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=F.shift();m=1;a?a.t?x(function(){("c"==a.t?L.injectCss:L.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):m=0}function k(a,b,f,e,d,k,l){function r(c){if(!s&&g(p.readyState)&&(C.r=s=1,!m&&h(),p.onload=p.onreadystatechange=null,c)){"img"!=a&&x(function(){z.removeChild(p)},50);for(var f in G[b])G[b].hasOwnProperty(f)&&
G[b][f].onload()}}l=l||L.errorTimeout;var p={},s=0,w=0,C={t:f,s:b,e:d,a:k,x:l};1===G[b]&&(w=1,G[b]=[],p=c.createElement(a));"object"==a?p.data=b:(p.src=b,p.type=a);p.width=p.height="0";p.onerror=p.onload=p.onreadystatechange=function(){r.call(this,w)};F.splice(e,0,C);"img"!=a&&(w||2===G[b]?(z.insertBefore(p,A?null:v),x(r,l)):G[b].push(p))}function l(a,b,c,f,d){return m=0,b=b||"j",e(a)?k("c"==b?H:D,a,b,this.i++,c,f,d):(F.splice(this.i++,0,a),1==F.length&&h()),this}function r(){var a=L;return a.loader=
{load:l,i:0},a}var s=c.documentElement,x=b.setTimeout,v=c.getElementsByTagName("script")[0],w={}.toString,F=[],m=0,E="MozAppearance"in s.style,A=E&&!!c.createRange().compareNode,z=A?s:v.parentNode,s=b.opera&&"[object Opera]"==w.call(b.opera),s=!!c.attachEvent&&!s,D=E?"object":s?"script":"img",H=s?"script":D,C=Array.isArray||function(a){return"[object Array]"==w.call(a)},M=[],G={},I={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},N,L;L=function(b){function c(a){a=a.split("!");var b=M.length,
f=a.pop(),e=a.length,f={url:f,origUrl:f,prefixes:a},d,g,h;for(g=0;g<e;g++)h=a[g].split("="),(d=I[h.shift()])&&(f=d(f,h));for(g=0;g<b;g++)f=M[g](f);return f}function g(b,e,d,k,l){var m=c(b),q=m.autoCallback;m.url.split(".").pop().split("?").shift();m.bypass||(e&&(e=f(e)?e:e[b]||e[k]||e[b.split("/").pop().split("?")[0]]||h),m.instead?m.instead(b,e,d,k,l):(G[m.url]?m.noexec=!0:G[m.url]=1,d.load(m.url,m.forceCSS||!m.forceJS&&"css"==m.url.split(".").pop().split("?").shift()?"c":a,m.noexec,m.attrs,m.timeout),
(f(e)||f(q))&&d.load(function(){r();e&&e(m.origUrl,l,k);q&&q(m.origUrl,l,k);G[m.url]=2})))}function k(a,b){function c(a,d){if(a)if(e(a))d||(m=function(){var a=[].slice.call(arguments);q.apply(this,a);r()}),g(a,m,b,0,h);else{if(Object(a)===a)for(t in s=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(t)&&(!d&&!--s&&(f(m)?m=function(){var a=[].slice.call(arguments);q.apply(this,a);r()}:m[t]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,
b);r()}}(q[t])),g(a[t],m,b,t,h))}else!d&&r()}var h=!!a.test,l=a.load||a.both,m=a.callback||d,q=m,r=a.complete||d,s,t;c(h?a.yep:a.nope,!!l);l&&c(l)}var l,m,s=this.yepnope.loader;if(e(b))g(b,0,s,0);else if(C(b))for(l=0;l<b.length;l++)m=b[l],e(m)?g(m,0,s,0):C(m)?L(m):Object(m)===m&&k(m,s);else Object(b)===b&&k(b,s)};L.addPrefix=function(a,b){I[a]=b};L.addFilter=function(a){M.push(a)};L.errorTimeout=1E4;null==c.readyState&&c.addEventListener&&(c.readyState="loading",c.addEventListener("DOMContentLoaded",
N=function(){c.removeEventListener("DOMContentLoaded",N,0);c.readyState="complete"},0));b.yepnope=r();b.yepnope.executeStack=h;b.yepnope.injectJs=function(a,b,f,e,k,l){var m=c.createElement("script"),r,p;e=e||L.errorTimeout;m.src=a;for(p in f)m.setAttribute(p,f[p]);b=l?h:b||d;m.onreadystatechange=m.onload=function(){!r&&g(m.readyState)&&(r=1,b(),m.onload=m.onreadystatechange=null)};x(function(){r||(r=1,b(1))},e);k?m.onload():v.parentNode.insertBefore(m,v)};b.yepnope.injectCss=function(a,b,f,e,g,k){e=
c.createElement("link");var l;b=k?h:b||d;e.href=a;e.rel="stylesheet";e.type="text/css";for(l in f)e.setAttribute(l,f[l]);g||(v.parentNode.insertBefore(e,v),x(b,0))}})(this,document);this.createjs=this.createjs||{};(function(){var b=function(){throw"UID cannot be instantiated";};b._nextID=0;b.get=function(){return b._nextID++};createjs.UID=b})();this.createjs=this.createjs||{};
(function(){var b=function(){this.initialize()},c=b.prototype;b.initialize=function(a){a.addEventListener=c.addEventListener;a.removeEventListener=c.removeEventListener;a.removeAllEventListeners=c.removeAllEventListeners;a.hasEventListener=c.hasEventListener;a.dispatchEvent=c.dispatchEvent};c._listeners=null;c.initialize=function(){};c.addEventListener=function(a,b){var c=this._listeners;c?this.removeEventListener(a,b):c=this._listeners={};var d=c[a];d||(d=c[a]=[]);d.push(b);return b};c.removeEventListener=
function(a,b){var c=this._listeners;if(c){var d=c[a];if(d)for(var g=0,h=d.length;g<h;g++)if(d[g]==b){1==h?delete c[a]:d.splice(g,1);break}}};c.removeAllEventListeners=function(a){a?this._listeners&&delete this._listeners[a]:this._listeners=null};c.dispatchEvent=function(a,b){var c=!1,d=this._listeners;if(a&&d){"string"==typeof a&&(a={type:a});a.target=b||this;d=d[a.type];if(!d)return c;for(var d=d.slice(),g=0,h=d.length;g<h;g++){var k=d[g];k instanceof Function?c=c||k.apply(null,[a]):k.handleEvent&&
(c=c||k.handleEvent(a))}}return!!c};c.hasEventListener=function(a){var b=this._listeners;return!(!b||!b[a])};c.toString=function(){return"[EventDispatcher]"};createjs.EventDispatcher=b})();this.createjs=this.createjs||{};
(function(){var b=function(){throw"Ticker cannot be instantiated.";};b.useRAF=!1;b.addEventListener=null;b.removeEventListener=null;b.removeAllEventListeners=null;b.dispatchEvent=null;b.hasEventListener=null;b._listeners=null;createjs.EventDispatcher.initialize(b);b._listeners=null;b._pauseable=null;b._paused=!1;b._inited=!1;b._startTime=0;b._pausedTime=0;b._ticks=0;b._pausedTicks=0;b._interval=50;b._lastTime=0;b._times=null;b._tickTimes=null;b._rafActive=!1;b._timeoutID=null;b.addListener=function(a,
c){null!=a&&(b.removeListener(a),b._pauseable[b._listeners.length]=null==c?!0:c,b._listeners.push(a))};b.init=function(){b._inited=!0;b._times=[];b._tickTimes=[];b._pauseable=[];b._listeners=[];b._times.push(b._lastTime=b._startTime=b._getTime());b.setInterval(b._interval)};b.removeListener=function(a){var c=b._listeners;c&&(a=c.indexOf(a),-1!=a&&(c.splice(a,1),b._pauseable.splice(a,1)))};b.removeAllListeners=function(){b._listeners=[];b._pauseable=[]};b.setInterval=function(a){b._interval=a;b._inited&&
b._setupTick()};b.getInterval=function(){return b._interval};b.setFPS=function(a){b.setInterval(1E3/a)};b.getFPS=function(){return 1E3/b._interval};b.getMeasuredFPS=function(a){if(2>b._times.length)return-1;null==a&&(a=b.getFPS()|0);a=Math.min(b._times.length-1,a);return 1E3/((b._times[0]-b._times[a])/a)};b.setPaused=function(a){b._paused=a};b.getPaused=function(){return b._paused};b.getTime=function(a){return b._getTime()-b._startTime-(a?b._pausedTime:0)};b.getTicks=function(a){return b._ticks-(a?
b._pausedTicks:0)};b._handleAF=function(){b._rafActive=!1;b._setupTick();b._getTime()-b._lastTime>=0.97*(b._interval-1)&&b._tick()};b._handleTimeout=function(){b.timeoutID=null;b._setupTick();b._tick()};b._setupTick=function(){if(!(b._rafActive||null!=b.timeoutID)){if(b.useRAF){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(a){a(b._handleAF);b._rafActive=!0;return}}b.timeoutID=
setTimeout(b._handleTimeout,b._interval)}};b._tick=function(){var a=b._getTime();b._ticks++;var c=a-b._lastTime,e=b._paused;e&&(b._pausedTicks++,b._pausedTime+=c);b._lastTime=a;for(var d=b._pauseable,g=b._listeners.slice(),h=g?g.length:0,k=0;k<h;k++){var l=g[k];null==l||e&&d[k]||(l.tick?l.tick(c,e):l instanceof Function&&l(c,e))}b.dispatchEvent({type:"tick",paused:e,delta:c,time:a,runTime:a-b._pausedTime});for(b._tickTimes.unshift(b._getTime()-a);100<b._tickTimes.length;)b._tickTimes.pop();for(b._times.unshift(a);100<
b._times.length;)b._times.pop()};var c=window.performance&&(performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow);b._getTime=function(){return c&&c.call(performance)||(new Date).getTime()};b.init();createjs.Ticker=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c,d,g,h,k,l,r){this.initialize(a,b,c,d,g,h,k,l,r)},c=b.prototype;c.stageX=0;c.stageY=0;c.rawX=0;c.rawY=0;c.type=null;c.nativeEvent=null;c.onMouseMove=null;c.onMouseUp=null;c.target=null;c.pointerID=0;c.primary=!1;c.addEventListener=null;c.removeEventListener=null;c.removeAllEventListeners=null;c.dispatchEvent=null;c.hasEventListener=null;c._listeners=null;createjs.EventDispatcher.initialize(c);c.initialize=function(a,b,c,d,g,h,k,l,r){this.type=a;this.stageX=b;this.stageY=
c;this.target=d;this.nativeEvent=g;this.pointerID=h;this.primary=k;this.rawX=null==l?b:l;this.rawY=null==r?c:r};c.clone=function(){return new b(this.type,this.stageX,this.stageY,this.target,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)};c.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"};createjs.MouseEvent=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c,d,g,h){this.initialize(a,b,c,d,g,h)},c=b.prototype;b.identity=null;b.DEG_TO_RAD=Math.PI/180;c.a=1;c.b=0;c.c=0;c.d=1;c.tx=0;c.ty=0;c.alpha=1;c.shadow=null;c.compositeOperation=null;c.initialize=function(a,b,c,d,g,h){null!=a&&(this.a=a);this.b=b||0;this.c=c||0;null!=d&&(this.d=d);this.tx=g||0;this.ty=h||0;return this};c.prepend=function(a,b,c,d,g,h){var k=this.tx;if(1!=a||0!=b||0!=c||1!=d){var l=this.a,r=this.c;this.a=l*a+this.b*c;this.b=l*b+this.b*d;this.c=r*a+this.d*
c;this.d=r*b+this.d*d}this.tx=k*a+this.ty*c+g;this.ty=k*b+this.ty*d+h;return this};c.append=function(a,b,c,d,g,h){var k=this.a,l=this.b,r=this.c,s=this.d;this.a=a*k+b*r;this.b=a*l+b*s;this.c=c*k+d*r;this.d=c*l+d*s;this.tx=g*k+h*r+this.tx;this.ty=g*l+h*s+this.ty;return this};c.prependMatrix=function(a){this.prepend(a.a,a.b,a.c,a.d,a.tx,a.ty);this.prependProperties(a.alpha,a.shadow,a.compositeOperation);return this};c.appendMatrix=function(a){this.append(a.a,a.b,a.c,a.d,a.tx,a.ty);this.appendProperties(a.alpha,
a.shadow,a.compositeOperation);return this};c.prependTransform=function(a,c,e,d,g,h,k,l,r){if(g%360){var s=g*b.DEG_TO_RAD;g=Math.cos(s);s=Math.sin(s)}else g=1,s=0;if(l||r)this.tx-=l,this.ty-=r;h||k?(h*=b.DEG_TO_RAD,k*=b.DEG_TO_RAD,this.prepend(g*e,s*e,-s*d,g*d,0,0),this.prepend(Math.cos(k),Math.sin(k),-Math.sin(h),Math.cos(h),a,c)):this.prepend(g*e,s*e,-s*d,g*d,a,c);return this};c.appendTransform=function(a,c,e,d,g,h,k,l,r){if(g%360){var s=g*b.DEG_TO_RAD;g=Math.cos(s);s=Math.sin(s)}else g=1,s=0;h||
k?(h*=b.DEG_TO_RAD,k*=b.DEG_TO_RAD,this.append(Math.cos(k),Math.sin(k),-Math.sin(h),Math.cos(h),a,c),this.append(g*e,s*e,-s*d,g*d,0,0)):this.append(g*e,s*e,-s*d,g*d,a,c);if(l||r)this.tx-=l*this.a+r*this.c,this.ty-=l*this.b+r*this.d;return this};c.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.a,d=this.c,g=this.tx;this.a=c*b-this.b*a;this.b=c*a+this.b*b;this.c=d*b-this.d*a;this.d=d*a+this.d*b;this.tx=g*b-this.ty*a;this.ty=g*a+this.ty*b;return this};c.skew=function(a,c){a*=b.DEG_TO_RAD;
c*=b.DEG_TO_RAD;this.append(Math.cos(c),Math.sin(c),-Math.sin(a),Math.cos(a),0,0);return this};c.scale=function(a,b){this.a*=a;this.d*=b;this.tx*=a;this.ty*=b;return this};c.translate=function(a,b){this.tx+=a;this.ty+=b;return this};c.identity=function(){this.alpha=this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;this.shadow=this.compositeOperation=null;return this};c.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,g=this.tx,h=a*d-b*c;this.a=d/h;this.b=-b/h;this.c=-c/h;this.d=a/h;this.tx=
(c*this.ty-d*g)/h;this.ty=-(a*this.ty-b*g)/h;return this};c.isIdentity=function(){return 0==this.tx&&0==this.ty&&1==this.a&&0==this.b&&0==this.c&&1==this.d};c.decompose=function(a){null==a&&(a={});a.x=this.tx;a.y=this.ty;a.scaleX=Math.sqrt(this.a*this.a+this.b*this.b);a.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var c=Math.atan2(-this.c,this.d),e=Math.atan2(this.b,this.a);c==e?(a.rotation=e/b.DEG_TO_RAD,0>this.a&&0<=this.d&&(a.rotation+=0>=a.rotation?180:-180),a.skewX=a.skewY=0):(a.skewX=c/b.DEG_TO_RAD,
a.skewY=e/b.DEG_TO_RAD);return a};c.reinitialize=function(a,b,c,d,g,h,k,l,r){this.initialize(a,b,c,d,g,h);this.alpha=k||1;this.shadow=l;this.compositeOperation=r;return this};c.appendProperties=function(a,b,c){this.alpha*=a;this.shadow=b||this.shadow;this.compositeOperation=c||this.compositeOperation;return this};c.prependProperties=function(a,b,c){this.alpha*=a;this.shadow=this.shadow||b;this.compositeOperation=this.compositeOperation||c;return this};c.clone=function(){var a=new b(this.a,this.b,
this.c,this.d,this.tx,this.ty);a.shadow=this.shadow;a.alpha=this.alpha;a.compositeOperation=this.compositeOperation;return a};c.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"};b.identity=new b(1,0,0,1,0,0);createjs.Matrix2D=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b){this.initialize(a,b)},c=b.prototype;c.x=0;c.y=0;c.initialize=function(a,b){this.x=null==a?0:a;this.y=null==b?0:b};c.clone=function(){return new b(this.x,this.y)};c.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"};createjs.Point=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c,d){this.initialize(a,b,c,d)},c=b.prototype;c.x=0;c.y=0;c.width=0;c.height=0;c.initialize=function(a,b,c,d){this.x=null==a?0:a;this.y=null==b?0:b;this.width=null==c?0:c;this.height=null==d?0:d};c.clone=function(){return new b(this.x,this.y,this.width,this.height)};c.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"};createjs.Rectangle=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c,d,g,h,k){this.initialize(a,b,c,d,g,h,k)},c=b.prototype;c.target=null;c.overLabel=null;c.outLabel=null;c.downLabel=null;c.play=!1;c._isPressed=!1;c._isOver=!1;c.initialize=function(a,b,c,d,g,h,k){a.addEventListener&&(this.target=a,a.cursor="pointer",this.overLabel=null==c?"over":c,this.outLabel=null==b?"out":b,this.downLabel=null==d?"down":d,this.play=g,this.setEnabled(!0),this.handleEvent({}),h&&(k&&(h.actionsEnabled=!1,h.gotoAndStop&&h.gotoAndStop(k)),a.hitArea=h))};
c.setEnabled=function(a){var b=this.target;a?(b.addEventListener("mouseover",this),b.addEventListener("mouseout",this),b.addEventListener("mousedown",this)):(b.removeEventListener("mouseover",this),b.removeEventListener("mouseout",this),b.removeEventListener("mousedown",this))};c.toString=function(){return"[ButtonHelper]"};c.handleEvent=function(a){var b=this.target,c=a.type;"mousedown"==c?(a.addEventListener("mouseup",this),this._isPressed=!0,a=this.downLabel):"mouseup"==c?(this._isPressed=!1,a=
this._isOver?this.overLabel:this.outLabel):"mouseover"==c?(this._isOver=!0,a=this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,a=this._isPressed?this.overLabel:this.outLabel);this.play?b.gotoAndPlay&&b.gotoAndPlay(a):b.gotoAndStop&&b.gotoAndStop(a)};createjs.ButtonHelper=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c,d){this.initialize(a,b,c,d)},c=b.prototype;b.identity=null;c.color=null;c.offsetX=0;c.offsetY=0;c.blur=0;c.initialize=function(a,b,c,d){this.color=a;this.offsetX=b;this.offsetY=c;this.blur=d};c.toString=function(){return"[Shadow]"};c.clone=function(){return new b(this.color,this.offsetX,this.offsetY,this.blur)};b.identity=new b("transparent",0,0,0);createjs.Shadow=b})();this.createjs=this.createjs||{};
(function(){var b=function(a){this.initialize(a)},c=b.prototype;c.complete=!0;c.onComplete=null;c.addEventListener=null;c.removeEventListener=null;c.removeAllEventListeners=null;c.dispatchEvent=null;c.hasEventListener=null;c._listeners=null;createjs.EventDispatcher.initialize(c);c._animations=null;c._frames=null;c._images=null;c._data=null;c._loadCount=0;c._frameHeight=0;c._frameWidth=0;c._numFrames=0;c._regX=0;c._regY=0;c.initialize=function(a){var b,c,d;if(null!=a){if(a.images&&0<(c=a.images.length)){d=
this._images=[];for(b=0;b<c;b++){var g=a.images[b];if("string"==typeof g){var h=g,g=new Image;g.src=h}d.push(g);!g.getContext&&!g.complete&&(this._loadCount++,this.complete=!1,function(a){g.onload=function(){a._handleImageLoad()}}(this))}}if(null!=a.frames)if(a.frames instanceof Array){this._frames=[];d=a.frames;b=0;for(c=d.length;b<c;b++)h=d[b],this._frames.push({image:this._images[h[4]?h[4]:0],rect:new createjs.Rectangle(h[0],h[1],h[2],h[3]),regX:h[5]||0,regY:h[6]||0})}else c=a.frames,this._frameWidth=
c.width,this._frameHeight=c.height,this._regX=c.regX||0,this._regY=c.regY||0,this._numFrames=c.count,0==this._loadCount&&this._calculateFrames();if(null!=(c=a.animations)){this._animations=[];this._data={};for(var k in c){a={name:k};h=c[k];if("number"==typeof h)d=a.frames=[h];else if(h instanceof Array)if(1==h.length)a.frames=[h[0]];else{a.frequency=h[3];a.next=h[2];d=a.frames=[];for(b=h[0];b<=h[1];b++)d.push(b)}else a.frequency=h.frequency,a.next=h.next,b=h.frames,d=a.frames="number"==typeof b?[b]:
b.slice(0);a.next=2>d.length||!1==a.next?null:null==a.next||!0==a.next?k:a.next;a.frequency||(a.frequency=1);this._animations.push(k);this._data[k]=a}}}};c.getNumFrames=function(a){if(null==a)return this._frames?this._frames.length:this._numFrames;a=this._data[a];return null==a?0:a.frames.length};c.getAnimations=function(){return this._animations.slice(0)};c.getAnimation=function(a){return this._data[a]};c.getFrame=function(a){var b;return this.complete&&this._frames&&(b=this._frames[a])?b:null};
c.getFrameBounds=function(a){return(a=this.getFrame(a))?new createjs.Rectangle(-a.regX,-a.regY,a.rect.width,a.rect.height):null};c.toString=function(){return"[SpriteSheet]"};c.clone=function(){var a=new b;a.complete=this.complete;a._animations=this._animations;a._frames=this._frames;a._images=this._images;a._data=this._data;a._frameHeight=this._frameHeight;a._frameWidth=this._frameWidth;a._numFrames=this._numFrames;a._loadCount=this._loadCount;return a};c._handleImageLoad=function(){0==--this._loadCount&&
(this._calculateFrames(),this.complete=!0,this.onComplete&&this.onComplete(),this.dispatchEvent("complete"))};c._calculateFrames=function(){if(!(this._frames||0==this._frameWidth)){this._frames=[];for(var a=0,b=this._frameWidth,c=this._frameHeight,d=0,g=this._images;d<g.length;d++){for(var h=g[d],k=(h.width+1)/b|0,l=(h.height+1)/c|0,l=0<this._numFrames?Math.min(this._numFrames-a,k*l):k*l,r=0;r<l;r++)this._frames.push({image:h,rect:new createjs.Rectangle(r%k*b,(r/k|0)*c,b,c),regX:this._regX,regY:this._regY});
a+=l}this._numFrames=a}};createjs.SpriteSheet=b})();this.createjs=this.createjs||{};
(function(){function b(a,b,c){this.f=a;this.params=b;this.path=null==c?!0:c}b.prototype.exec=function(a){this.f.apply(a,this.params)};var c=function(){this.initialize()},a=c.prototype;c.getRGB=function(a,b,c,g){null!=a&&null==c&&(g=b,c=a&255,b=a>>8&255,a=a>>16&255);return null==g?"rgb("+a+","+b+","+c+")":"rgba("+a+","+b+","+c+","+g+")"};c.getHSL=function(a,b,c,g){return null==g?"hsl("+a%360+","+b+"%,"+c+"%)":"hsla("+a%360+","+b+"%,"+c+"%,"+g+")"};c.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,
K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63};c.STROKE_CAPS_MAP=["butt","round","square"];c.STROKE_JOINTS_MAP=["miter","round","bevel"];c._ctx=(createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")).getContext("2d");c.beginCmd=new b(c._ctx.beginPath,
[],!1);c.fillCmd=new b(c._ctx.fill,[],!1);c.strokeCmd=new b(c._ctx.stroke,[],!1);a._strokeInstructions=null;a._strokeStyleInstructions=null;a._ignoreScaleStroke=!1;a._fillInstructions=null;a._instructions=null;a._oldInstructions=null;a._activeInstructions=null;a._active=!1;a._dirty=!1;a.initialize=function(){this.clear();this._ctx=c._ctx};a.isEmpty=function(){return!(this._instructions.length||this._oldInstructions.length||this._activeInstructions.length)};a.draw=function(a){this._dirty&&this._updateInstructions();
for(var b=this._instructions,c=0,g=b.length;c<g;c++)b[c].exec(a)};a.drawAsPath=function(a){this._dirty&&this._updateInstructions();for(var b,c=this._instructions,g=0,h=c.length;g<h;g++)((b=c[g]).path||0==g)&&b.exec(a)};a.moveTo=function(a,c){this._activeInstructions.push(new b(this._ctx.moveTo,[a,c]));return this};a.lineTo=function(a,c){this._dirty=this._active=!0;this._activeInstructions.push(new b(this._ctx.lineTo,[a,c]));return this};a.arcTo=function(a,c,d,g,h){this._dirty=this._active=!0;this._activeInstructions.push(new b(this._ctx.arcTo,
[a,c,d,g,h]));return this};a.arc=function(a,c,d,g,h,k){this._dirty=this._active=!0;null==k&&(k=!1);this._activeInstructions.push(new b(this._ctx.arc,[a,c,d,g,h,k]));return this};a.quadraticCurveTo=function(a,c,d,g){this._dirty=this._active=!0;this._activeInstructions.push(new b(this._ctx.quadraticCurveTo,[a,c,d,g]));return this};a.bezierCurveTo=function(a,c,d,g,h,k){this._dirty=this._active=!0;this._activeInstructions.push(new b(this._ctx.bezierCurveTo,[a,c,d,g,h,k]));return this};a.rect=function(a,
c,d,g){this._dirty=this._active=!0;this._activeInstructions.push(new b(this._ctx.rect,[a,c,d,g]));return this};a.closePath=function(){this._active&&(this._dirty=!0,this._activeInstructions.push(new b(this._ctx.closePath,[])));return this};a.clear=function(){this._instructions=[];this._oldInstructions=[];this._activeInstructions=[];this._strokeStyleInstructions=this._strokeInstructions=this._fillInstructions=null;this._active=this._dirty=!1;return this};a.beginFill=function(a){this._active&&this._newPath();
this._fillInstructions=a?[new b(this._setProp,["fillStyle",a],!1),c.fillCmd]:null;return this};a.beginLinearGradientFill=function(a,e,d,g,h,k){this._active&&this._newPath();d=this._ctx.createLinearGradient(d,g,h,k);g=0;for(h=a.length;g<h;g++)d.addColorStop(e[g],a[g]);this._fillInstructions=[new b(this._setProp,["fillStyle",d],!1),c.fillCmd];return this};a.beginRadialGradientFill=function(a,e,d,g,h,k,l,r){this._active&&this._newPath();d=this._ctx.createRadialGradient(d,g,h,k,l,r);g=0;for(h=a.length;g<
h;g++)d.addColorStop(e[g],a[g]);this._fillInstructions=[new b(this._setProp,["fillStyle",d],!1),c.fillCmd];return this};a.beginBitmapFill=function(a,e,d){this._active&&this._newPath();a=this._ctx.createPattern(a,e||"");a=new b(this._setProp,["fillStyle",a],!1);this._fillInstructions=d?[a,new b(this._ctx.save,[],!1),new b(this._ctx.transform,[d.a,d.b,d.c,d.d,d.tx,d.ty],!1),c.fillCmd,new b(this._ctx.restore,[],!1)]:[a,c.fillCmd];return this};a.endFill=function(){return this.beginFill()};a.setStrokeStyle=
function(a,e,d,g,h){this._active&&this._newPath();this._strokeStyleInstructions=[new b(this._setProp,["lineWidth",null==a?"1":a],!1),new b(this._setProp,["lineCap",null==e?"butt":isNaN(e)?e:c.STROKE_CAPS_MAP[e]],!1),new b(this._setProp,["lineJoin",null==d?"miter":isNaN(d)?d:c.STROKE_JOINTS_MAP[d]],!1),new b(this._setProp,["miterLimit",null==g?"10":g],!1)];this._ignoreScaleStroke=h;return this};a.beginStroke=function(a){this._active&&this._newPath();this._strokeInstructions=a?[new b(this._setProp,
["strokeStyle",a],!1)]:null;return this};a.beginLinearGradientStroke=function(a,c,d,g,h,k){this._active&&this._newPath();d=this._ctx.createLinearGradient(d,g,h,k);g=0;for(h=a.length;g<h;g++)d.addColorStop(c[g],a[g]);this._strokeInstructions=[new b(this._setProp,["strokeStyle",d],!1)];return this};a.beginRadialGradientStroke=function(a,c,d,g,h,k,l,r){this._active&&this._newPath();d=this._ctx.createRadialGradient(d,g,h,k,l,r);g=0;for(h=a.length;g<h;g++)d.addColorStop(c[g],a[g]);this._strokeInstructions=
[new b(this._setProp,["strokeStyle",d],!1)];return this};a.beginBitmapStroke=function(a,c){this._active&&this._newPath();var d=this._ctx.createPattern(a,c||"");this._strokeInstructions=[new b(this._setProp,["strokeStyle",d],!1)];return this};a.endStroke=function(){this.beginStroke();return this};a.curveTo=a.quadraticCurveTo;a.drawRect=a.rect;a.drawRoundRect=function(a,b,c,g,h){this.drawRoundRectComplex(a,b,c,g,h,h,h,h);return this};a.drawRoundRectComplex=function(a,c,d,g,h,k,l,r){var s=(d<g?d:g)/
2,x=0,v=0,w=0,F=0;0>h&&(h*=x=-1);h>s&&(h=s);0>k&&(k*=v=-1);k>s&&(k=s);0>l&&(l*=w=-1);l>s&&(l=s);0>r&&(r*=F=-1);r>s&&(r=s);this._dirty=this._active=!0;var s=this._ctx.arcTo,m=this._ctx.lineTo;this._activeInstructions.push(new b(this._ctx.moveTo,[a+d-k,c]),new b(s,[a+d+k*v,c-k*v,a+d,c+k,k]),new b(m,[a+d,c+g-l]),new b(s,[a+d+l*w,c+g+l*w,a+d-l,c+g,l]),new b(m,[a+r,c+g]),new b(s,[a-r*F,c+g+r*F,a,c+g-r,r]),new b(m,[a,c+h]),new b(s,[a-h*x,c-h*x,a+h,c,h]),new b(this._ctx.closePath));return this};a.drawCircle=
function(a,b,c){this.arc(a,b,c,0,2*Math.PI);return this};a.drawEllipse=function(a,c,d,g){this._dirty=this._active=!0;var h=0.5522848*(d/2),k=0.5522848*(g/2),l=a+d,r=c+g;d=a+d/2;g=c+g/2;this._activeInstructions.push(new b(this._ctx.moveTo,[a,g]),new b(this._ctx.bezierCurveTo,[a,g-k,d-h,c,d,c]),new b(this._ctx.bezierCurveTo,[d+h,c,l,g-k,l,g]),new b(this._ctx.bezierCurveTo,[l,g+k,d+h,r,d,r]),new b(this._ctx.bezierCurveTo,[d-h,r,a,g+k,a,g]));return this};a.drawPolyStar=function(a,c,d,g,h,k){this._dirty=
this._active=!0;null==h&&(h=0);h=1-h;k=null==k?0:k/(180/Math.PI);var l=Math.PI/g;this._activeInstructions.push(new b(this._ctx.moveTo,[a+Math.cos(k)*d,c+Math.sin(k)*d]));for(var r=0;r<g;r++)k+=l,1!=h&&this._activeInstructions.push(new b(this._ctx.lineTo,[a+Math.cos(k)*d*h,c+Math.sin(k)*d*h])),k+=l,this._activeInstructions.push(new b(this._ctx.lineTo,[a+Math.cos(k)*d,c+Math.sin(k)*d]));return this};a.decodePath=function(a){for(var b=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,
this.closePath],d=[2,2,4,6,0],g=0,h=a.length,k=[],l=0,r=0,s=c.BASE_64;g<h;){var x=a.charAt(g),v=s[x],w=v>>3,F=b[w];if(!F||v&3)throw"bad path data (@"+g+"): "+x;x=d[w];w||(l=r=0);k.length=0;g++;v=(v>>2&1)+2;for(w=0;w<x;w++){var m=s[a.charAt(g)],E=m>>5?-1:1,m=(m&31)<<6|s[a.charAt(g+1)];3==v&&(m=m<<6|s[a.charAt(g+2)]);m=E*m/10;w%2?l=m+=l:r=m+=r;k[w]=m;g+=v}F.apply(this,k)}return this};a.clone=function(){var a=new c;a._instructions=this._instructions.slice();a._activeInstructions=this._activeInstructions.slice();
a._oldInstructions=this._oldInstructions.slice();this._fillInstructions&&(a._fillInstructions=this._fillInstructions.slice());this._strokeInstructions&&(a._strokeInstructions=this._strokeInstructions.slice());this._strokeStyleInstructions&&(a._strokeStyleInstructions=this._strokeStyleInstructions.slice());a._active=this._active;a._dirty=this._dirty;return a};a.toString=function(){return"[Graphics]"};a.mt=a.moveTo;a.lt=a.lineTo;a.at=a.arcTo;a.bt=a.bezierCurveTo;a.qt=a.quadraticCurveTo;a.a=a.arc;a.r=
a.rect;a.cp=a.closePath;a.c=a.clear;a.f=a.beginFill;a.lf=a.beginLinearGradientFill;a.rf=a.beginRadialGradientFill;a.bf=a.beginBitmapFill;a.ef=a.endFill;a.ss=a.setStrokeStyle;a.s=a.beginStroke;a.ls=a.beginLinearGradientStroke;a.rs=a.beginRadialGradientStroke;a.bs=a.beginBitmapStroke;a.es=a.endStroke;a.dr=a.drawRect;a.rr=a.drawRoundRect;a.rc=a.drawRoundRectComplex;a.dc=a.drawCircle;a.de=a.drawEllipse;a.dp=a.drawPolyStar;a.p=a.decodePath;a._updateInstructions=function(){this._instructions=this._oldInstructions.slice();
this._instructions.push(c.beginCmd);this._instructions.push.apply(this._instructions,this._activeInstructions);this._fillInstructions&&this._instructions.push.apply(this._instructions,this._fillInstructions);this._strokeInstructions&&(this._strokeStyleInstructions&&this._instructions.push.apply(this._instructions,this._strokeStyleInstructions),this._instructions.push.apply(this._instructions,this._strokeInstructions),this._ignoreScaleStroke?this._instructions.push(new b(this._ctx.save,[],!1),new b(this._ctx.setTransform,
[1,0,0,1,0,0],!1),c.strokeCmd,new b(this._ctx.restore,[],!1)):this._instructions.push(c.strokeCmd))};a._newPath=function(){this._dirty&&this._updateInstructions();this._oldInstructions=this._instructions;this._activeInstructions=[];this._active=this._dirty=!1};a._setProp=function(a,b){this[a]=b};createjs.Graphics=c})();this.createjs=this.createjs||{};
(function(){var b=function(){this.initialize()},c=b.prototype;b.suppressCrossDomainErrors=!1;b._hitTestCanvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");b._hitTestCanvas.width=b._hitTestCanvas.height=1;b._hitTestContext=b._hitTestCanvas.getContext("2d");b._nextCacheID=1;c.alpha=1;c.cacheCanvas=null;c.id=-1;c.mouseEnabled=!0;c.name=null;c.parent=null;c.regX=0;c.regY=0;c.rotation=0;c.scaleX=1;c.scaleY=1;c.skewX=0;c.skewY=0;c.shadow=null;c.visible=!0;c.x=0;c.y=0;c.compositeOperation=
null;c.snapToPixel=!1;c.onPress=null;c.onClick=null;c.onDoubleClick=null;c.onMouseOver=null;c.onMouseOut=null;c.onTick=null;c.filters=null;c.cacheID=0;c.mask=null;c.hitArea=null;c.cursor=null;c.addEventListener=null;c.removeEventListener=null;c.removeAllEventListeners=null;c.dispatchEvent=null;c.hasEventListener=null;c._listeners=null;createjs.EventDispatcher.initialize(c);c._cacheOffsetX=0;c._cacheOffsetY=0;c._cacheScale=1;c._cacheDataURLID=0;c._cacheDataURL=null;c._matrix=null;c.initialize=function(){this.id=
createjs.UID.get();this._matrix=new createjs.Matrix2D};c.isVisible=function(){return!(!this.visible||!(0<this.alpha&&0!=this.scaleX&&0!=this.scaleY))};c.draw=function(a,b){var c=this.cacheCanvas;if(b||!c)return!1;var d=this._cacheScale;a.drawImage(c,this._cacheOffsetX,this._cacheOffsetY,c.width/d,c.height/d);return!0};c.updateContext=function(a){var b,c=this.mask;c&&c.graphics&&!c.graphics.isEmpty()&&(b=c.getMatrix(c._matrix),a.transform(b.a,b.b,b.c,b.d,b.tx,b.ty),c.graphics.drawAsPath(a),a.clip(),
b.invert(),a.transform(b.a,b.b,b.c,b.d,b.tx,b.ty));b=this._matrix.identity().appendTransform(this.x,this.y,this.scaleX,this.scaleY,this.rotation,this.skewX,this.skewY,this.regX,this.regY);createjs.Stage._snapToPixelEnabled&&this.snapToPixel?a.transform(b.a,b.b,b.c,b.d,b.tx+0.5|0,b.ty+0.5|0):a.transform(b.a,b.b,b.c,b.d,b.tx,b.ty);a.globalAlpha*=this.alpha;this.compositeOperation&&(a.globalCompositeOperation=this.compositeOperation);this.shadow&&this._applyShadow(a,this.shadow)};c.cache=function(a,
b,c,d,g){g=g||1;this.cacheCanvas||(this.cacheCanvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"));this.cacheCanvas.width=Math.ceil(c*g);this.cacheCanvas.height=Math.ceil(d*g);this._cacheOffsetX=a;this._cacheOffsetY=b;this._cacheScale=g||1;this.updateCache()};c.updateCache=function(a){var c=this.cacheCanvas,e=this._cacheScale,d=this._cacheOffsetX*e,g=this._cacheOffsetY*e;if(!c)throw"cache() must be called before updateCache()";var h=c.getContext("2d");h.save();a||
h.clearRect(0,0,c.width,c.height);h.globalCompositeOperation=a;h.setTransform(e,0,0,e,-d,-g);this.draw(h,!0);this._applyFilters();h.restore();this.cacheID=b._nextCacheID++};c.uncache=function(){this._cacheDataURL=this.cacheCanvas=null;this.cacheID=this._cacheOffsetX=this._cacheOffsetY=0;this._cacheScale=1};c.getCacheDataURL=function(){if(!this.cacheCanvas)return null;this.cacheID!=this._cacheDataURLID&&(this._cacheDataURL=this.cacheCanvas.toDataURL());return this._cacheDataURL};c.getStage=function(){for(var a=
this;a.parent;)a=a.parent;return a instanceof createjs.Stage?a:null};c.localToGlobal=function(a,b){var c=this.getConcatenatedMatrix(this._matrix);if(null==c)return null;c.append(1,0,0,1,a,b);return new createjs.Point(c.tx,c.ty)};c.globalToLocal=function(a,b){var c=this.getConcatenatedMatrix(this._matrix);if(null==c)return null;c.invert();c.append(1,0,0,1,a,b);return new createjs.Point(c.tx,c.ty)};c.localToLocal=function(a,b,c){a=this.localToGlobal(a,b);return c.globalToLocal(a.x,a.y)};c.setTransform=
function(a,b,c,d,g,h,k,l,r){this.x=a||0;this.y=b||0;this.scaleX=null==c?1:c;this.scaleY=null==d?1:d;this.rotation=g||0;this.skewX=h||0;this.skewY=k||0;this.regX=l||0;this.regY=r||0;return this};c.getMatrix=function(a){return(a?a.identity():new createjs.Matrix2D).appendTransform(this.x,this.y,this.scaleX,this.scaleY,this.rotation,this.skewX,this.skewY,this.regX,this.regY).appendProperties(this.alpha,this.shadow,this.compositeOperation)};c.getConcatenatedMatrix=function(a){a?a.identity():a=new createjs.Matrix2D;
for(var b=this;null!=b;)a.prependTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY).prependProperties(b.alpha,b.shadow,b.compositeOperation),b=b.parent;return a};c.hitTest=function(a,c){var e=b._hitTestContext,d=b._hitTestCanvas;e.setTransform(1,0,0,1,-a,-c);this.draw(e);e=this._testHit(e);d.width=0;d.width=1;return e};c.set=function(a){for(var b in a)this[b]=a[b];return this};c.clone=function(){var a=new b;this.cloneProps(a);return a};c.toString=function(){return"[DisplayObject (name="+
this.name+")]"};c.cloneProps=function(a){a.alpha=this.alpha;a.name=this.name;a.regX=this.regX;a.regY=this.regY;a.rotation=this.rotation;a.scaleX=this.scaleX;a.scaleY=this.scaleY;a.shadow=this.shadow;a.skewX=this.skewX;a.skewY=this.skewY;a.visible=this.visible;a.x=this.x;a.y=this.y;a.mouseEnabled=this.mouseEnabled;a.compositeOperation=this.compositeOperation;this.cacheCanvas&&(a.cacheCanvas=this.cacheCanvas.cloneNode(!0),a.cacheCanvas.getContext("2d").putImageData(this.cacheCanvas.getContext("2d").getImageData(0,
0,this.cacheCanvas.width,this.cacheCanvas.height),0,0))};c._applyShadow=function(a,b){b=b||Shadow.identity;a.shadowColor=b.color;a.shadowOffsetX=b.offsetX;a.shadowOffsetY=b.offsetY;a.shadowBlur=b.blur};c._tick=function(a){this.onTick&&this.onTick.apply(this,a);var b=this._listeners;b&&b.tick&&this.dispatchEvent({type:"tick",params:a})};c._testHit=function(a){try{var c=1<a.getImageData(0,0,1,1).data[3]}catch(e){if(!b.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images.";
}return c};c._applyFilters=function(){if(this.filters&&0!=this.filters.length&&this.cacheCanvas)for(var a=this.filters.length,b=this.cacheCanvas.getContext("2d"),c=this.cacheCanvas.width,d=this.cacheCanvas.height,g=0;g<a;g++)this.filters[g].applyFilter(b,0,0,c,d)};c._hasMouseHandler=function(a){var b=this._listeners;return!!(a&1&&(this.onPress||this.onClick||this.onDoubleClick||b&&(this.hasEventListener("mousedown")||this.hasEventListener("click")||this.hasEventListener("dblclick")))||a&2&&(this.onMouseOver||
this.onMouseOut||this.cursor||b&&(this.hasEventListener("mouseover")||this.hasEventListener("mouseout"))))};createjs.DisplayObject=b})();this.createjs=this.createjs||{};
(function(){var b=function(){this.initialize()},c=b.prototype=new createjs.DisplayObject;c.children=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(){this.DisplayObject_initialize();this.children=[]};c.isVisible=function(){var a=this.cacheCanvas||this.children.length;return!(!this.visible||!(0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&a))};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;for(var c=this.children.slice(0),d=0,g=c.length;d<
g;d++){var h=c[d];h.isVisible()&&(a.save(),h.updateContext(a),h.draw(a),a.restore())}return!0};c.addChild=function(a){if(null==a)return a;var b=arguments.length;if(1<b){for(var c=0;c<b;c++)this.addChild(arguments[c]);return arguments[b-1]}a.parent&&a.parent.removeChild(a);a.parent=this;this.children.push(a);return a};c.addChildAt=function(a,b){var c=arguments.length,d=arguments[c-1];if(0>d||d>this.children.length)return arguments[c-2];if(2<c){for(var g=0;g<c-1;g++)this.addChildAt(arguments[g],d+g);
return arguments[c-2]}a.parent&&a.parent.removeChild(a);a.parent=this;this.children.splice(b,0,a);return a};c.removeChild=function(a){var b=arguments.length;if(1<b){for(var c=!0,d=0;d<b;d++)c=c&&this.removeChild(arguments[d]);return c}return this.removeChildAt(this.children.indexOf(a))};c.removeChildAt=function(a){var b=arguments.length;if(1<b){for(var c=[],d=0;d<b;d++)c[d]=arguments[d];c.sort(function(a,b){return b-a});for(var g=!0,d=0;d<b;d++)g=g&&this.removeChildAt(c[d]);return g}if(0>a||a>this.children.length-
1)return!1;if(b=this.children[a])b.parent=null;this.children.splice(a,1);return!0};c.removeAllChildren=function(){for(var a=this.children;a.length;)a.pop().parent=null};c.getChildAt=function(a){return this.children[a]};c.getChildByName=function(a){for(var b=this.children,c=0,d=b.length;c<d;c++)if(b[c].name==a)return b[c];return null};c.sortChildren=function(a){this.children.sort(a)};c.getChildIndex=function(a){return this.children.indexOf(a)};c.getNumChildren=function(){return this.children.length};
c.swapChildrenAt=function(a,b){var c=this.children,d=c[a],g=c[b];d&&g&&(c[a]=g,c[b]=d)};c.swapChildren=function(a,b){for(var c=this.children,d,g,h=0,k=c.length;h<k&&!(c[h]==a&&(d=h),c[h]==b&&(g=h),null!=d&&null!=g);h++);h!=k&&(c[d]=b,c[g]=a)};c.setChildIndex=function(a,b){var c=this.children,d=c.length;if(!(a.parent!=this||0>b||b>=d)){for(var g=0;g<d&&c[g]!=a;g++);g==d||g==b||(c.splice(g,1),b<g&&b--,c.splice(b,0,a))}};c.contains=function(a){for(;a;){if(a==this)return!0;a=a.parent}return!1};c.hitTest=
function(a,b){return null!=this.getObjectUnderPoint(a,b)};c.getObjectsUnderPoint=function(a,b){var c=[],d=this.localToGlobal(a,b);this._getObjectsUnderPoint(d.x,d.y,c);return c};c.getObjectUnderPoint=function(a,b){var c=this.localToGlobal(a,b);return this._getObjectsUnderPoint(c.x,c.y)};c.clone=function(a){var c=new b;this.cloneProps(c);if(a)for(var e=c.children=[],d=0,g=this.children.length;d<g;d++){var h=this.children[d].clone(a);h.parent=c;e.push(h)}return c};c.toString=function(){return"[Container (name="+
this.name+")]"};c.DisplayObject__tick=c._tick;c._tick=function(a){for(var b=this.children.length-1;0<=b;b--){var c=this.children[b];c._tick&&c._tick(a)}this.DisplayObject__tick(a)};c._getObjectsUnderPoint=function(a,c,e,d){var g=createjs.DisplayObject._hitTestContext,h=createjs.DisplayObject._hitTestCanvas,k=this._matrix,l=this._hasMouseHandler(d);if(!this.hitArea&&this.cacheCanvas&&l&&(this.getConcatenatedMatrix(k),g.setTransform(k.a,k.b,k.c,k.d,k.tx-a,k.ty-c),g.globalAlpha=k.alpha,this.draw(g),
this._testHit(g)))return h.width=0,h.width=1,this;for(var r=this.children.length-1;0<=r;r--){var s=this.children[r],x=s.hitArea;if(s.visible&&!(!x&&!s.isVisible()||d&&!s.mouseEnabled)){var v=d&&s._hasMouseHandler(d);if(s instanceof b&&(!x||!v))if(l){if(s._getObjectsUnderPoint(a,c))return this}else{if(s=s._getObjectsUnderPoint(a,c,e,d),!e&&s)return s}else if(!d||l||v)if(s.getConcatenatedMatrix(k),x&&(k.appendTransform(x.x,x.y,x.scaleX,x.scaleY,x.rotation,x.skewX,x.skewY,x.regX,x.regY),k.alpha=x.alpha),
g.globalAlpha=k.alpha,g.setTransform(k.a,k.b,k.c,k.d,k.tx-a,k.ty-c),(x||s).draw(g),this._testHit(g)){h.width=0;h.width=1;if(l)return this;if(e)e.push(s);else return s}}}return null};createjs.Container=b})();this.createjs=this.createjs||{};
(function(){var b=function(a){this.initialize(a)},c=b.prototype=new createjs.Container;b._snapToPixelEnabled=!1;c.autoClear=!0;c.canvas=null;c.mouseX=0;c.mouseY=0;c.onMouseMove=null;c.onMouseUp=null;c.onMouseDown=null;c.snapToPixelEnabled=!1;c.mouseInBounds=!1;c.tickOnUpdate=!0;c.mouseMoveOutside=!1;c._pointerData=null;c._pointerCount=0;c._primaryPointerID=null;c._mouseOverIntervalID=null;c.Container_initialize=c.initialize;c.initialize=function(a){this.Container_initialize();this.canvas="string"==
typeof a?document.getElementById(a):a;this._pointerData={};this.enableDOMEvents(!0)};c.update=function(){if(this.canvas){this.autoClear&&this.clear();b._snapToPixelEnabled=this.snapToPixelEnabled;this.tickOnUpdate&&this._tick(arguments.length?arguments:null);var a=this.canvas.getContext("2d");a.save();this.updateContext(a);this.draw(a,!1);a.restore()}};c.tick=c.update;c.handleEvent=function(a){"tick"==a.type&&this.update(a)};c.clear=function(){if(this.canvas){var a=this.canvas.getContext("2d");a.setTransform(1,
0,0,1,0,0);a.clearRect(0,0,this.canvas.width,this.canvas.height)}};c.toDataURL=function(a,b){b||(b="image/png");var c=this.canvas.getContext("2d"),d=this.canvas.width,g=this.canvas.height,h;if(a){h=c.getImageData(0,0,d,g);var k=c.globalCompositeOperation;c.globalCompositeOperation="destination-over";c.fillStyle=a;c.fillRect(0,0,d,g)}var l=this.canvas.toDataURL(b);a&&(c.clearRect(0,0,d,g),c.putImageData(h,0,0),c.globalCompositeOperation=k);return l};c.enableMouseOver=function(a){this._mouseOverIntervalID&&
(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null);if(null==a)a=20;else if(0>=a)return;var b=this;this._mouseOverIntervalID=setInterval(function(){b._testMouseOver()},1E3/Math.min(50,a))};c.enableDOMEvents=function(a){null==a&&(a=!0);var b,c=this._eventListeners;if(!a&&c){for(b in c)a=c[b],a.t.removeEventListener(b,a.f);this._eventListeners=null}else if(a&&!c){a=window.addEventListener?window:document;var d=this,c=this._eventListeners={};c.mouseup={t:a,f:function(a){d._handleMouseUp(a)}};
c.mousemove={t:a,f:function(a){d._handleMouseMove(a)}};c.dblclick={t:a,f:function(a){d._handleDoubleClick(a)}};(a=this.canvas)&&(c.mousedown={t:a,f:function(a){d._handleMouseDown(a)}});for(b in c)a=c[b],a.t.addEventListener(b,a.f)}};c.clone=function(){var a=new b(null);this.cloneProps(a);return a};c.toString=function(){return"[Stage (name="+this.name+")]"};c._getPointerData=function(a){var b=this._pointerData[a];b||(b=this._pointerData[a]={x:0,y:0},null==this._primaryPointerID&&(this._primaryPointerID=
a));return b};c._handleMouseMove=function(a){a||(a=window.event);this._handlePointerMove(-1,a,a.pageX,a.pageY)};c._handlePointerMove=function(a,b,c,d){if(this.canvas){var g=this._getPointerData(a),h=g.inBounds;this._updatePointerPosition(a,c,d);if(h||g.inBounds||this.mouseMoveOutside){if(this.onMouseMove||this.hasEventListener("stagemousemove"))c=new createjs.MouseEvent("stagemousemove",g.x,g.y,this,b,a,a==this._primaryPointerID,g.rawX,g.rawY),this.onMouseMove&&this.onMouseMove(c),this.dispatchEvent(c);
if((d=g.event)&&(d.onMouseMove||d.hasEventListener("mousemove")))c=new createjs.MouseEvent("mousemove",g.x,g.y,d.target,b,a,a==this._primaryPointerID,g.rawX,g.rawY),d.onMouseMove&&d.onMouseMove(c),d.dispatchEvent(c,d.target)}}};c._updatePointerPosition=function(a,b,c){var d=this._getElementRect(this.canvas);b-=d.left;c-=d.top;var g=this.canvas.width,h=this.canvas.height;b/=(d.right-d.left)/g;c/=(d.bottom-d.top)/h;d=this._getPointerData(a);(d.inBounds=0<=b&&0<=c&&b<=g-1&&c<=h-1)?(d.x=b,d.y=c):this.mouseMoveOutside&&
(d.x=0>b?0:b>g-1?g-1:b,d.y=0>c?0:c>h-1?h-1:c);d.rawX=b;d.rawY=c;a==this._primaryPointerID&&(this.mouseX=d.x,this.mouseY=d.y,this.mouseInBounds=d.inBounds)};c._getElementRect=function(a){var b;try{b=a.getBoundingClientRect()}catch(c){b={top:a.offsetTop,left:a.offsetLeft,width:a.offsetWidth,height:a.offsetHeight}}var d=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),g=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||
0),h=window.getComputedStyle?getComputedStyle(a):a.currentStyle;a=parseInt(h.paddingLeft)+parseInt(h.borderLeftWidth);var k=parseInt(h.paddingTop)+parseInt(h.borderTopWidth),l=parseInt(h.paddingRight)+parseInt(h.borderRightWidth),h=parseInt(h.paddingBottom)+parseInt(h.borderBottomWidth);return{left:b.left+d+a,right:b.right+d-l,top:b.top+g+k,bottom:b.bottom+g-h}};c._handleMouseUp=function(a){this._handlePointerUp(-1,a,!1)};c._handlePointerUp=function(a,b,c){var d=this._getPointerData(a),g;if(this.onMouseMove||
this.hasEventListener("stagemouseup"))g=new createjs.MouseEvent("stagemouseup",d.x,d.y,this,b,a,a==this._primaryPointerID,d.rawX,d.rawY),this.onMouseUp&&this.onMouseUp(g),this.dispatchEvent(g);var h=d.event;if(h&&(h.onMouseUp||h.hasEventListener("mouseup")))g=new createjs.MouseEvent("mouseup",d.x,d.y,h.target,b,a,a==this._primaryPointerID,d.rawX,d.rawY),h.onMouseUp&&h.onMouseUp(g),h.dispatchEvent(g,h.target);if((h=d.target)&&(h.onClick||h.hasEventListener("click"))&&this._getObjectsUnderPoint(d.x,
d.y,null,!0,this._mouseOverIntervalID?3:1)==h)g=new createjs.MouseEvent("click",d.x,d.y,h,b,a,a==this._primaryPointerID,d.rawX,d.rawY),h.onClick&&h.onClick(g),h.dispatchEvent(g);c?(a==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[a]):d.event=d.target=null};c._handleMouseDown=function(a){this._handlePointerDown(-1,a,!1)};c._handlePointerDown=function(a,b,c,d){var g=this._getPointerData(a);null!=d&&this._updatePointerPosition(a,c,d);if(this.onMouseDown||this.hasEventListener("stagemousedown"))c=
new createjs.MouseEvent("stagemousedown",g.x,g.y,this,b,a,a==this._primaryPointerID,g.rawX,g.rawY),this.onMouseDown&&this.onMouseDown(c),this.dispatchEvent(c);if(d=this._getObjectsUnderPoint(g.x,g.y,null,this._mouseOverIntervalID?3:1))if(g.target=d,d.onPress||d.hasEventListener("mousedown"))if(c=new createjs.MouseEvent("mousedown",g.x,g.y,d,b,a,a==this._primaryPointerID,g.rawX,g.rawY),d.onPress&&d.onPress(c),d.dispatchEvent(c),c.onMouseMove||c.onMouseUp||c.hasEventListener("mousemove")||c.hasEventListener("mouseup"))g.event=
c};c._testMouseOver=function(){if(-1==this._primaryPointerID&&!(this.mouseX==this._mouseOverX&&this.mouseY==this._mouseOverY&&this.mouseInBounds)){var a=null;this.mouseInBounds&&(a=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,3),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);var b=this._mouseOverTarget;if(b!=a){var c=this._getPointerData(-1);if(b&&(b.onMouseOut||b.hasEventListener("mouseout"))){var d=new createjs.MouseEvent("mouseout",c.x,c.y,b,null,-1,c.rawX,c.rawY);b.onMouseOut&&
b.onMouseOut(d);b.dispatchEvent(d)}b&&(this.canvas.style.cursor="");if(a&&(a.onMouseOver||a.hasEventListener("mouseover")))d=new createjs.MouseEvent("mouseover",c.x,c.y,a,null,-1,c.rawX,c.rawY),a.onMouseOver&&a.onMouseOver(d),a.dispatchEvent(d);a&&(this.canvas.style.cursor=a.cursor||"");this._mouseOverTarget=a}}};c._handleDoubleClick=function(a){var b=this._getPointerData(-1),c=this._getObjectsUnderPoint(b.x,b.y,null,this._mouseOverIntervalID?3:1);if(c&&(c.onDoubleClick||c.hasEventListener("dblclick")))evt=
new createjs.MouseEvent("dblclick",b.x,b.y,c,a,-1,!0,b.rawX,b.rawY),c.onDoubleClick&&c.onDoubleClick(evt),c.dispatchEvent(evt)};createjs.Stage=b})();this.createjs=this.createjs||{};
(function(){var b=function(a){this.initialize(a)},c=b.prototype=new createjs.DisplayObject;c.image=null;c.snapToPixel=!0;c.sourceRect=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(a){this.DisplayObject_initialize();"string"==typeof a?(this.image=new Image,this.image.src=a):this.image=a};c.isVisible=function(){var a=this.cacheCanvas||this.image&&(this.image.complete||this.image.getContext||2<=this.image.readyState);return!(!this.visible||!(0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&
a))};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;var c=this.sourceRect;c?a.drawImage(this.image,c.x,c.y,c.width,c.height,0,0,c.width,c.height):a.drawImage(this.image,0,0);return!0};c.clone=function(){var a=new b(this.image);this.sourceRect&&(a.sourceRect=this.sourceRect.clone());this.cloneProps(a);return a};c.toString=function(){return"[Bitmap (name="+this.name+")]"};createjs.Bitmap=b})();this.createjs=this.createjs||{};
(function(){var b=function(a){this.initialize(a)},c=b.prototype=new createjs.DisplayObject;c.onAnimationEnd=null;c.currentFrame=-1;c.currentAnimation=null;c.paused=!0;c.spriteSheet=null;c.snapToPixel=!0;c.offset=0;c.currentAnimationFrame=0;c.addEventListener=null;c.removeEventListener=null;c.removeAllEventListeners=null;c.dispatchEvent=null;c.hasEventListener=null;c._listeners=null;createjs.EventDispatcher.initialize(c);c._advanceCount=0;c._animation=null;c.DisplayObject_initialize=c.initialize;c.initialize=
function(a){this.DisplayObject_initialize();this.spriteSheet=a};c.isVisible=function(){var a=this.cacheCanvas||this.spriteSheet.complete&&0<=this.currentFrame;return!(!this.visible||!(0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&a))};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;this._normalizeFrame();var c=this.spriteSheet.getFrame(this.currentFrame);if(c){var d=c.rect;a.drawImage(c.image,d.x,d.y,d.width,d.height,-c.regX,-c.regY,d.width,d.height);return!0}};
c.play=function(){this.paused=!1};c.stop=function(){this.paused=!0};c.gotoAndPlay=function(a){this.paused=!1;this._goto(a)};c.gotoAndStop=function(a){this.paused=!0;this._goto(a)};c.advance=function(){this._animation?this.currentAnimationFrame++:this.currentFrame++;this._normalizeFrame()};c.getBounds=function(){return this.spriteSheet.getFrameBounds(this.currentFrame)};c.clone=function(){var a=new b(this.spriteSheet);this.cloneProps(a);return a};c.toString=function(){return"[BitmapAnimation (name="+
this.name+")]"};c.DisplayObject__tick=c._tick;c._tick=function(a){var b=this._animation?this._animation.frequency:1;!this.paused&&0==(++this._advanceCount+this.offset)%b&&this.advance();this.DisplayObject__tick(a)};c._normalizeFrame=function(){var a=this._animation,b=this.currentFrame,c=this.paused,d;if(a)if(d=a.frames.length,this.currentAnimationFrame>=d){var g=a.next;this._dispatchAnimationEnd(a,b,c,g,d-1)||(g?this._goto(g):(this.paused=!0,this.currentAnimationFrame=a.frames.length-1,this.currentFrame=
a.frames[this.currentAnimationFrame]))}else this.currentFrame=a.frames[this.currentAnimationFrame];else d=this.spriteSheet.getNumFrames(),b>=d&&!this._dispatchAnimationEnd(a,b,c,d-1)&&(this.currentFrame=0)};c._dispatchAnimationEnd=function(a,b,c,d,g){var h=a?a.name:null;this.onAnimationEnd&&this.onAnimationEnd(this,h,d);this.dispatchEvent({type:"animationend",name:h,next:d});!c&&this.paused&&(this.currentAnimationFrame=g);return this.paused!=c||this._animation!=a||this.currentFrame!=b};c.DisplayObject_cloneProps=
c.cloneProps;c.cloneProps=function(a){this.DisplayObject_cloneProps(a);a.onAnimationEnd=this.onAnimationEnd;a.currentFrame=this.currentFrame;a.currentAnimation=this.currentAnimation;a.paused=this.paused;a.offset=this.offset;a._animation=this._animation;a.currentAnimationFrame=this.currentAnimationFrame};c._goto=function(a){if(isNaN(a)){var b=this.spriteSheet.getAnimation(a);b&&(this.currentAnimationFrame=0,this._animation=b,this.currentAnimation=a,this._normalizeFrame())}else this.currentAnimation=
this._animation=null,this.currentFrame=a};createjs.BitmapAnimation=b})();this.createjs=this.createjs||{};
(function(){var b=function(a){this.initialize(a)},c=b.prototype=new createjs.DisplayObject;c.graphics=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(a){this.DisplayObject_initialize();this.graphics=a?a:new createjs.Graphics};c.isVisible=function(){var a=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!(!this.visible||!(0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&a))};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;this.graphics.draw(a);
return!0};c.clone=function(a){a=new b(a&&this.graphics?this.graphics.clone():this.graphics);this.cloneProps(a);return a};c.toString=function(){return"[Shape (name="+this.name+")]"};createjs.Shape=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c){this.initialize(a,b,c)},c=b.prototype=new createjs.DisplayObject;b._workingContext=(createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")).getContext("2d");c.text="";c.font=null;c.color="#000";c.textAlign="left";c.textBaseline="top";c.maxWidth=null;c.outline=!1;c.lineHeight=0;c.lineWidth=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(a,b,c){this.DisplayObject_initialize();this.text=a;this.font=b;this.color=c?c:"#000"};
c.isVisible=function(){var a=this.cacheCanvas||null!=this.text&&""!==this.text;return!(!this.visible||!(0<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&a))};c.DisplayObject_draw=c.draw;c.draw=function(a,b){if(this.DisplayObject_draw(a,b))return!0;this.outline?a.strokeStyle=this.color:a.fillStyle=this.color;a.font=this.font;a.textAlign=this.textAlign||"start";a.textBaseline=this.textBaseline||"alphabetic";this._drawText(a);return!0};c.getMeasuredWidth=function(){return this._getWorkingContext().measureText(this.text).width};
c.getMeasuredLineHeight=function(){return 1.2*this._getWorkingContext().measureText("M").width};c.getMeasuredHeight=function(){return this._drawText()*(this.lineHeight||this.getMeasuredLineHeight())};c.clone=function(){var a=new b(this.text,this.font,this.color);this.cloneProps(a);return a};c.toString=function(){return"[Text (text="+(20<this.text.length?this.text.substr(0,17)+"...":this.text)+")]"};c.DisplayObject_cloneProps=c.cloneProps;c.cloneProps=function(a){this.DisplayObject_cloneProps(a);a.textAlign=
this.textAlign;a.textBaseline=this.textBaseline;a.maxWidth=this.maxWidth;a.outline=this.outline;a.lineHeight=this.lineHeight;a.lineWidth=this.lineWidth};c._getWorkingContext=function(){var a=b._workingContext;a.font=this.font;a.textAlign=this.textAlign||"start";a.textBaseline=this.textBaseline||"alphabetic";return a};c._drawText=function(a){var b=!!a;b||(a=this._getWorkingContext());for(var c=String(this.text).split(/(?:\r\n|\r|\n)/),d=this.lineHeight||this.getMeasuredLineHeight(),g=0,h=0,k=c.length;h<
k;h++){var l=a.measureText(c[h]).width;if(null==this.lineWidth||l<this.lineWidth)b&&this._drawTextLine(a,c[h],g*d);else{for(var l=c[h].split(/(\s)/),r=l[0],s=1,x=l.length;s<x;s+=2)a.measureText(r+l[s]+l[s+1]).width>this.lineWidth?(b&&this._drawTextLine(a,r,g*d),g++,r=l[s+1]):r+=l[s]+l[s+1];b&&this._drawTextLine(a,r,g*d)}g++}return g};c._drawTextLine=function(a,b,c){this.outline?a.strokeText(b,0,c,this.maxWidth||65535):a.fillText(b,0,c,this.maxWidth||65535)};createjs.Text=b})();
this.createjs=this.createjs||{};
(function(){var b=function(){throw"SpriteSheetUtils cannot be instantiated";};b._workingCanvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");b._workingContext=b._workingCanvas.getContext("2d");b.addFlippedFrames=function(c,a,f,e){if(a||f||e){var d=0;a&&b._flip(c,++d,!0,!1);f&&b._flip(c,++d,!1,!0);e&&b._flip(c,++d,!0,!0)}};b.extractFrame=function(c,a){isNaN(a)&&(a=c.getAnimation(a).frames[0]);var f=c.getFrame(a);if(!f)return null;var e=f.rect,d=b._workingCanvas;d.width=
e.width;d.height=e.height;b._workingContext.drawImage(f.image,e.x,e.y,e.width,e.height,0,0,e.width,e.height);f=new Image;f.src=d.toDataURL("image/png");return f};b.mergeAlpha=function(b,a,f){f||(f=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"));f.width=Math.max(a.width,b.width);f.height=Math.max(a.height,b.height);var e=f.getContext("2d");e.save();e.drawImage(b,0,0);e.globalCompositeOperation="destination-in";e.drawImage(a,0,0);e.restore();return f};b._flip=function(c,
a,f,e){for(var d=c._images,g=b._workingCanvas,h=b._workingContext,k=d.length/a,l=0;l<k;l++){var r=d[l];r.__tmp=l;g.width=0;g.width=r.width;g.height=r.height;h.setTransform(f?-1:1,0,0,e?-1:1,f?r.width:0,e?r.height:0);h.drawImage(r,0,0);var s=new Image;s.src=g.toDataURL("image/png");s.width=r.width;s.height=r.height;d.push(s)}h=c._frames;g=h.length/a;for(l=0;l<g;l++){var r=h[l],x=r.rect.clone(),s=d[r.image.__tmp+k*a],v={image:s,rect:x,regX:r.regX,regY:r.regY};f&&(x.x=s.width-x.x-x.width,v.regX=x.width-
r.regX);e&&(x.y=s.height-x.y-x.height,v.regY=x.height-r.regY);h.push(v)}f="_"+(f?"h":"")+(e?"v":"");e=c._animations;c=c._data;d=e.length/a;for(l=0;l<d;l++){h=e[l];r=c[h];k={name:h+f,frequency:r.frequency,next:r.next,frames:[]};r.next&&(k.next+=f);h=r.frames;r=0;for(s=h.length;r<s;r++)k.frames.push(h[r]+g*a);c[k.name]=k;e.push(k.name)}};createjs.SpriteSheetUtils=b})();this.createjs=this.createjs||{};
(function(){var b=function(){this.initialize()},c=b.prototype;b.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions";b.ERR_RUNNING="a build is already running";c.maxWidth=2048;c.maxHeight=2048;c.spriteSheet=null;c.scale=1;c.padding=1;c.timeSlice=0.3;c.progress=-1;c.onComplete=null;c.onProgress=null;c.addEventListener=null;c.removeEventListener=null;c.removeAllEventListeners=null;c.dispatchEvent=null;c.hasEventListener=null;c._listeners=null;createjs.EventDispatcher.initialize(c);c._frames=
null;c._animations=null;c._data=null;c._nextFrameIndex=0;c._index=0;c._timerID=null;c._scale=1;c.initialize=function(){this._frames=[];this._animations={}};c.addFrame=function(a,c,e,d,g,h){if(this._data)throw b.ERR_RUNNING;c=c||a.bounds||a.nominalBounds;!c&&a.getBounds&&(c=a.getBounds());if(!c)return null;e=e||1;return this._frames.push({source:a,sourceRect:c,scale:e,funct:d,params:g,scope:h,index:this._frames.length,height:c.height*e})-1};c.addAnimation=function(a,c,e,d){if(this._data)throw b.ERR_RUNNING;
this._animations[a]={frames:c,next:e,frequency:d}};c.addMovieClip=function(a,c,e){if(this._data)throw b.ERR_RUNNING;var d=a.frameBounds,g=c||a.bounds||a.nominalBounds;!g&&a.getBounds&&(g=a.getBounds());if(!g&&!d)return null;c=this._frames.length;for(var h=a.timeline.duration,k=0;k<h;k++)this.addFrame(a,d&&d[k]?d[k]:g,e,function(a){var b=this.actionsEnabled;this.actionsEnabled=!1;this.gotoAndStop(a);this.actionsEnabled=b},[k],a);k=a.timeline._labels;a=[];for(var l in k)a.push({index:k[l],label:l});
if(a.length){a.sort(function(a,b){return a.index-b.index});k=0;for(l=a.length;k<l;k++){e=a[k].label;for(var d=c+(k==l-1?h:a[k+1].index),g=[],r=c+a[k].index;r<d;r++)g.push(r);this.addAnimation(e,g,!0)}}};c.build=function(){if(this._data)throw b.ERR_RUNNING;for(this._startBuild();this._drawNext(););this._endBuild();return this.spriteSheet};c.buildAsync=function(a){if(this._data)throw b.ERR_RUNNING;this.timeSlice=a;this._startBuild();var c=this;this._timerID=setTimeout(function(){c._run()},50-50*Math.max(0.01,
Math.min(0.99,this.timeSlice||0.3)))};c.stopAsync=function(){clearTimeout(this._timerID);this._data=null};c.clone=function(){throw"SpriteSheetBuilder cannot be cloned.";};c.toString=function(){return"[SpriteSheetBuilder]"};c._startBuild=function(){var a=this.padding||0;this.progress=0;this.spriteSheet=null;this._index=0;this._scale=this.scale;var c=[];this._data={images:[],frames:c,animations:this._animations};var e=this._frames.slice();e.sort(function(a,b){return a.height<=b.height?-1:1});if(e[e.length-
1].height+2*a>this.maxHeight)throw b.ERR_DIMENSIONS;for(var d=0,g=0,h=0;e.length;){var k=this._fillRow(e,d,h,c,a);k.w>g&&(g=k.w);d+=k.h;if(!k.h||!e.length){var l=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");l.width=this._getSize(g,this.maxWidth);l.height=this._getSize(d,this.maxHeight);this._data.images[h]=l;k.h||(g=d=0,h++)}}};c._getSize=function(a,b){for(var c=4;Math.pow(2,++c)<a;);return Math.min(b,Math.pow(2,c))};c._fillRow=function(a,c,e,d,g){var h=this.maxWidth,
k=this.maxHeight;c+=g;for(var k=k-c,l=g,r=0,s=a.length-1;0<=s;s--){var x=a[s],v=this._scale*x.scale,w=x.sourceRect,F=x.source,m=Math.floor(v*w.x-g),E=Math.floor(v*w.y-g),A=Math.ceil(v*w.height+2*g),w=Math.ceil(v*w.width+2*g);if(w>h)throw b.ERR_DIMENSIONS;A>k||l+w>h||(x.img=e,x.rect=new createjs.Rectangle(l,c,w,A),r=r||A,a.splice(s,1),d[x.index]=[l,c,w,A,e,Math.round(-m+v*F.regX-g),Math.round(-E+v*F.regY-g)],l+=w)}return{w:l,h:r}};c._endBuild=function(){this.spriteSheet=new createjs.SpriteSheet(this._data);
this._data=null;this.progress=1;this.onComplete&&this.onComplete(this);this.dispatchEvent("complete")};c._run=function(){for(var a=50*Math.max(0.01,Math.min(0.99,this.timeSlice||0.3)),b=(new Date).getTime()+a,c=!1;b>(new Date).getTime();)if(!this._drawNext()){c=!0;break}if(c)this._endBuild();else{var d=this;this._timerID=setTimeout(function(){d._run()},50-a)}a=this.progress=this._index/this._frames.length;this.onProgress&&this.onProgress(this,a);this.dispatchEvent({type:"progress",progress:a})};c._drawNext=
function(){var a=this._frames[this._index],b=a.scale*this._scale,c=a.rect,d=a.sourceRect,g=this._data.images[a.img].getContext("2d");a.funct&&a.funct.apply(a.scope,a.params);g.save();g.beginPath();g.rect(c.x,c.y,c.width,c.height);g.clip();g.translate(Math.ceil(c.x-d.x*b),Math.ceil(c.y-d.y*b));g.scale(b,b);a.source.draw(g);g.restore();return++this._index<this._frames.length};createjs.SpriteSheetBuilder=b})();this.createjs=this.createjs||{};
(function(){var b=function(a){this.initialize(a)},c=b.prototype=new createjs.DisplayObject;c.htmlElement=null;c._oldMtx=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(a){"string"==typeof a&&(a=document.getElementById(a));this.DisplayObject_initialize();this.mouseEnabled=!1;this.htmlElement=a;a=a.style;a.position="absolute";a.transformOrigin=a.WebkitTransformOrigin=a.msTransformOrigin=a.MozTransformOrigin=a.OTransformOrigin="0% 0%"};c.isVisible=function(){return null!=this.htmlElement};
c.draw=function(){if(null!=this.htmlElement){var a=this.getConcatenatedMatrix(this._matrix),b=this.htmlElement.style;if(this.visible)b.visibility="visible";else return!0;var c=this._oldMtx||{};c.alpha!=a.alpha&&(b.opacity=""+a.alpha,c.alpha=a.alpha);if(c.tx!=a.tx||c.ty!=a.ty||c.a!=a.a||c.b!=a.b||c.c!=a.c||c.d!=a.d)b.transform=b.WebkitTransform=b.OTransform=b.msTransform=["matrix("+a.a,a.b,a.c,a.d,a.tx+0.5|0,(a.ty+0.5|0)+")"].join(),b.MozTransform=["matrix("+a.a,a.b,a.c,a.d,(a.tx+0.5|0)+"px",(a.ty+
0.5|0)+"px)"].join(),this._oldMtx=a.clone();return!0}};c.cache=function(){};c.uncache=function(){};c.updateCache=function(){};c.hitTest=function(){};c.localToGlobal=function(){};c.globalToLocal=function(){};c.localToLocal=function(){};c.clone=function(){throw"DOMElement cannot be cloned.";};c.toString=function(){return"[DOMElement (name="+this.name+")]"};c.DisplayObject__tick=c._tick;c._tick=function(a){this.htmlElement.style.visibility="hidden";this.DisplayObject__tick(a)};createjs.DOMElement=b})();
this.createjs=this.createjs||{};(function(){var b=function(){this.initialize()},c=b.prototype;c.initialize=function(){};c.getBounds=function(){return new createjs.Rectangle(0,0,0,0)};c.applyFilter=function(){};c.toString=function(){return"[Filter]"};c.clone=function(){return new b};createjs.Filter=b})();this.createjs=this.createjs||{};
(function(){var b=function(){throw"Touch cannot be instantiated";};b.isSupported=function(){return"ontouchstart"in window||window.navigator.msPointerEnabled};b.enable=function(c,a,f){if(!c||!c.canvas||!b.isSupported())return!1;c.__touch={pointers:{},multitouch:!a,preventDefault:!f,count:0};"ontouchstart"in window?b._IOS_enable(c):window.navigator.msPointerEnabled&&b._IE_enable(c);return!0};b.disable=function(c){c&&("ontouchstart"in window?b._IOS_disable(c):window.navigator.msPointerEnabled&&b._IE_disable(c))};
b._IOS_enable=function(c){var a=c.canvas,f=c.__touch.f=function(a){b._IOS_handleEvent(c,a)};a.addEventListener("touchstart",f,!1);a.addEventListener("touchmove",f,!1);a.addEventListener("touchend",f,!1);a.addEventListener("touchcancel",f,!1)};b._IOS_disable=function(b){var a=b.canvas;a&&(b=b.__touch.f,a.removeEventListener("touchstart",b,!1),a.removeEventListener("touchmove",b,!1),a.removeEventListener("touchend",b,!1),a.removeEventListener("touchcancel",b,!1))};b._IOS_handleEvent=function(b,a){if(b){b.__touch.preventDefault&&
a.preventDefault&&a.preventDefault();for(var f=a.changedTouches,e=a.type,d=0,g=f.length;d<g;d++){var h=f[d],k=h.identifier;h.target==b.canvas&&("touchstart"==e?this._handleStart(b,k,a,h.pageX,h.pageY):"touchmove"==e?this._handleMove(b,k,a,h.pageX,h.pageY):("touchend"==e||"touchcancel"==e)&&this._handleEnd(b,k,a))}}};b._IE_enable=function(c){var a=c.canvas,f=c.__touch.f=function(a){b._IE_handleEvent(c,a)};a.addEventListener("MSPointerDown",f,!1);window.addEventListener("MSPointerMove",f,!1);window.addEventListener("MSPointerUp",
f,!1);window.addEventListener("MSPointerCancel",f,!1);c.__touch.preventDefault&&(a.style.msTouchAction="none");c.__touch.activeIDs={}};b._IE_disable=function(b){var a=b.__touch.f;window.removeEventListener("MSPointerMove",a,!1);window.removeEventListener("MSPointerUp",a,!1);window.removeEventListener("MSPointerCancel",a,!1);b.canvas&&b.canvas.removeEventListener("MSPointerDown",a,!1)};b._IE_handleEvent=function(b,a){if(b){b.__touch.preventDefault&&a.preventDefault&&a.preventDefault();var f=a.type,
e=a.pointerId,d=b.__touch.activeIDs;if("MSPointerDown"==f)a.srcElement==b.canvas&&(d[e]=!0,this._handleStart(b,e,a,a.pageX,a.pageY));else if(d[e])if("MSPointerMove"==f)this._handleMove(b,e,a,a.pageX,a.pageY);else if("MSPointerUp"==f||"MSPointerCancel"==f)delete d[e],this._handleEnd(b,e,a)}};b._handleStart=function(b,a,f,e,d){var g=b.__touch;if(g.multitouch||!g.count){var h=g.pointers;h[a]||(h[a]=!0,g.count++,b._handlePointerDown(a,f,e,d))}};b._handleMove=function(b,a,f,e,d){b.__touch.pointers[a]&&
b._handlePointerMove(a,f,e,d)};b._handleEnd=function(b,a,f){var e=b.__touch,d=e.pointers;d[a]&&(e.count--,b._handlePointerUp(a,f,!0),delete d[a])};createjs.Touch=b})();(function(){var b=this.createjs=this.createjs||{},b=b.EaselJS=b.EaselJS||{};b.version="0.6.0";b.buildDate="Tue, 12 Feb 2013 21:12:22 GMT"})();this.createjs=this.createjs||{};
(function(){var b=function(){this.initialize()},c=b.prototype;b.initialize=function(a){a.addEventListener=c.addEventListener;a.removeEventListener=c.removeEventListener;a.removeAllEventListeners=c.removeAllEventListeners;a.hasEventListener=c.hasEventListener;a.dispatchEvent=c.dispatchEvent};c._listeners=null;c.initialize=function(){};c.addEventListener=function(a,b){var c=this._listeners;c?this.removeEventListener(a,b):c=this._listeners={};var d=c[a];d||(d=c[a]=[]);d.push(b);return b};c.removeEventListener=
function(a,b){var c=this._listeners;if(c){var d=c[a];if(d)for(var g=0,h=d.length;g<h;g++)if(d[g]==b){1==h?delete c[a]:d.splice(g,1);break}}};c.removeAllEventListeners=function(a){a?this._listeners&&delete this._listeners[a]:this._listeners=null};c.dispatchEvent=function(a,b){var c=!1,d=this._listeners;if(a&&d){"string"==typeof a&&(a={type:a});a.target=b||this;d=d[a.type];if(!d)return c;for(var d=d.slice(),g=0,h=d.length;g<h;g++){var k=d[g];k instanceof Function?c=c||k.apply(null,[a]):k.handleEvent&&
(c=c||k.handleEvent(a))}}return!!c};c.hasEventListener=function(a){var b=this._listeners;return!(!b||!b[a])};c.toString=function(){return"[EventDispatcher]"};createjs.EventDispatcher=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c){this.initialize(a,b,c)},c=b.prototype;b.NONE=0;b.LOOP=1;b.REVERSE=2;b.IGNORE={};b._tweens=[];b._plugins={};b.get=function(a,c,e,d){d&&b.removeTweens(a);return new b(a,c,e)};b.tick=function(a,c){for(var e=b._tweens.slice(),d=e.length-1;0<=d;d--){var g=e[d];c&&!g.ignoreGlobalPause||g._paused||g.tick(g._useTicks?1:a)}};createjs.Ticker&&createjs.Ticker.addListener(b,!1);b.removeTweens=function(a){if(a.tweenjs_count){for(var c=b._tweens,e=c.length-1;0<=e;e--)c[e]._target==
a&&(c[e]._paused=!0,c.splice(e,1));a.tweenjs_count=0}};b.hasActiveTweens=function(a){return a?a.tweenjs_count:b._tweens&&b._tweens.length};b.installPlugin=function(a,c){var e=a.priority;null==e&&(a.priority=e=0);for(var d=0,g=c.length,h=b._plugins;d<g;d++){var k=c[d];if(h[k]){for(var l=h[k],r=0,s=l.length;r<s&&!(e<l[r].priority);r++);h[k].splice(r,0,a)}else h[k]=[a]}};b._register=function(a,c){var e=a._target;c?(e&&(e.tweenjs_count=e.tweenjs_count?e.tweenjs_count+1:1),b._tweens.push(a)):(e&&e.tweenjs_count--,
e=b._tweens.indexOf(a),-1!=e&&b._tweens.splice(e,1))};c.addEventListener=null;c.removeEventListener=null;c.removeAllEventListeners=null;c.dispatchEvent=null;c.hasEventListener=null;c._listeners=null;createjs.EventDispatcher.initialize(c);c.ignoreGlobalPause=!1;c.loop=!1;c.duration=0;c.pluginData=null;c.onChange=null;c.change=null;c.target=null;c.position=null;c._paused=!1;c._curQueueProps=null;c._initQueueProps=null;c._steps=null;c._actions=null;c._prevPosition=0;c._stepPosition=0;c._prevPos=-1;c._target=
null;c._useTicks=!1;c.initialize=function(a,c,e){this.target=this._target=a;c&&(this._useTicks=c.useTicks,this.ignoreGlobalPause=c.ignoreGlobalPause,this.loop=c.loop,this.onChange=c.onChange,c.override&&b.removeTweens(a));this.pluginData=e||{};this._curQueueProps={};this._initQueueProps={};this._steps=[];this._actions=[];c&&c.paused?this._paused=!0:b._register(this,!0);c&&null!=c.position&&this.setPosition(c.position,b.NONE)};c.wait=function(a){if(null==a||0>=a)return this;var b=this._cloneProps(this._curQueueProps);
return this._addStep({d:a,p0:b,e:this._linearEase,p1:b})};c.to=function(a,b,c){if(isNaN(b)||0>b)b=0;return this._addStep({d:b||0,p0:this._cloneProps(this._curQueueProps),e:c,p1:this._cloneProps(this._appendQueueProps(a))})};c.call=function(a,b,c){return this._addAction({f:a,p:b?b:[this],o:c?c:this._target})};c.set=function(a,b){return this._addAction({f:this._set,o:this,p:[a,b?b:this._target]})};c.play=function(a){return this.call(a.setPaused,[!1],a)};c.pause=function(a){a||(a=this);return this.call(a.setPaused,
[!0],a)};c.setPosition=function(a,b){0>a&&(a=0);null==b&&(b=1);var c=a,d=!1;c>=this.duration&&(this.loop?c%=this.duration:(c=this.duration,d=!0));if(c==this._prevPos)return d;var g=this._prevPos;this.position=this._prevPos=c;this._prevPosition=a;if(this._target)if(d)this._updateTargetProps(null,1);else if(0<this._steps.length){for(var h=0,k=this._steps.length;h<k&&!(this._steps[h].t>c);h++);h=this._steps[h-1];this._updateTargetProps(h,(this._stepPosition=c-h.t)/h.d)}0!=b&&0<this._actions.length&&
(this._useTicks?this._runActions(c,c):1==b&&c<g?(g!=this.duration&&this._runActions(g,this.duration),this._runActions(0,c,!0)):this._runActions(g,c));d&&this.setPaused(!0);this.onChange&&this.onChange(this);this.dispatchEvent("change");return d};c.tick=function(a){this._paused||this.setPosition(this._prevPosition+a)};c.setPaused=function(a){this._paused=!!a;b._register(this,!a);return this};c.w=c.wait;c.t=c.to;c.c=c.call;c.s=c.set;c.toString=function(){return"[Tween]"};c.clone=function(){throw"Tween can not be cloned.";
};c._updateTargetProps=function(a,c){var e,d,g,h;!a&&1==c?e=d=this._curQueueProps:(a.e&&(c=a.e(c,0,1,1)),e=a.p0,d=a.p1);for(n in this._initQueueProps){if(null==(g=e[n]))e[n]=g=this._initQueueProps[n];if(null==(h=d[n]))d[n]=h=g;g=g==h||0==c||1==c||"number"!=typeof g?1==c?h:g:g+(h-g)*c;var k=!1;if(h=b._plugins[n])for(var l=0,r=h.length;l<r;l++){var s=h[l].tween(this,n,g,e,d,c,!!a&&e==d,!a);s==b.IGNORE?k=!0:g=s}k||(this._target[n]=g)}};c._runActions=function(a,b,c){var d=a,g=b,h=-1,k=this._actions.length,
l=1;for(a>b&&(d=b,g=a,h=k,k=l=-1);(h+=l)!=k;){b=this._actions[h];var r=b.t;(r==g||r>d&&r<g||c&&r==a)&&b.f.apply(b.o,b.p)}};c._appendQueueProps=function(a){var c,e,d,g,h,k;for(k in a){if(void 0===this._initQueueProps[k]){e=this._target[k];if(c=b._plugins[k]){d=0;for(g=c.length;d<g;d++)e=c[d].init(this,k,e)}this._initQueueProps[k]=void 0===e?null:e}else e=this._curQueueProps[k];if(c=b._plugins[k]){h=h||{};d=0;for(g=c.length;d<g;d++)c[d].step&&c[d].step(this,k,e,a[k],h)}this._curQueueProps[k]=a[k]}h&&
this._appendQueueProps(h);return this._curQueueProps};c._cloneProps=function(a){var b={},c;for(c in a)b[c]=a[c];return b};c._addStep=function(a){0<a.d&&(this._steps.push(a),a.t=this.duration,this.duration+=a.d);return this};c._addAction=function(a){a.t=this.duration;this._actions.push(a);return this};c._set=function(a,b){for(var c in a)b[c]=a[c]};createjs.Tween=b})();this.createjs=this.createjs||{};
(function(){var b=function(a,b,c){this.initialize(a,b,c)},c=b.prototype;c.ignoreGlobalPause=!1;c.duration=0;c.loop=!1;c.onChange=null;c.position=null;c._paused=!1;c._tweens=null;c._labels=null;c._prevPosition=0;c._prevPos=-1;c._useTicks=!1;c.initialize=function(a,b,c){this._tweens=[];c&&(this._useTicks=c.useTicks,this.loop=c.loop,this.ignoreGlobalPause=c.ignoreGlobalPause,this.onChange=c.onChange);a&&this.addTween.apply(this,a);this.setLabels(b);c&&c.paused?this._paused=!0:createjs.Tween._register(this,
!0);c&&null!=c.position&&this.setPosition(c.position,createjs.Tween.NONE)};c.addTween=function(a){var b=arguments.length;if(1<b){for(var c=0;c<b;c++)this.addTween(arguments[c]);return arguments[0]}if(0==b)return null;this.removeTween(a);this._tweens.push(a);a.setPaused(!0);a._paused=!1;a._useTicks=this._useTicks;a.duration>this.duration&&(this.duration=a.duration);0<=this._prevPos&&a.setPosition(this._prevPos,createjs.Tween.NONE);return a};c.removeTween=function(a){var b=arguments.length;if(1<b){for(var c=
!0,d=0;d<b;d++)c=c&&this.removeTween(arguments[d]);return c}if(0==b)return!1;b=this._tweens.indexOf(a);return-1!=b?(this._tweens.splice(b,1),a.duration>=this.duration&&this.updateDuration(),!0):!1};c.addLabel=function(a,b){this._labels[a]=b};c.setLabels=function(a){this._labels=a?a:{}};c.gotoAndPlay=function(a){this.setPaused(!1);this._goto(a)};c.gotoAndStop=function(a){this.setPaused(!0);this._goto(a)};c.setPosition=function(a,b){0>a&&(a=0);var c=this.loop?a%this.duration:a,d=!this.loop&&a>=this.duration;
if(c==this._prevPos)return d;this._prevPosition=a;this.position=this._prevPos=c;for(var g=0,h=this._tweens.length;g<h;g++)if(this._tweens[g].setPosition(c,b),c!=this._prevPos)return!1;d&&this.setPaused(!0);this.onChange&&this.onChange(this);return d};c.setPaused=function(a){this._paused=!!a;createjs.Tween._register(this,!a)};c.updateDuration=function(){for(var a=this.duration=0,b=this._tweens.length;a<b;a++)tween=this._tweens[a],tween.duration>this.duration&&(this.duration=tween.duration)};c.tick=
function(a){this.setPosition(this._prevPosition+a)};c.resolve=function(a){var b=parseFloat(a);isNaN(b)&&(b=this._labels[a]);return b};c.toString=function(){return"[Timeline]"};c.clone=function(){throw"Timeline can not be cloned.";};c._goto=function(a){a=this.resolve(a);null!=a&&this.setPosition(a)};createjs.Timeline=b})();this.createjs=this.createjs||{};
(function(){var b=function(){throw"Ease cannot be instantiated.";};b.linear=function(b){return b};b.none=b.linear;b.get=function(b){-1>b&&(b=-1);1<b&&(b=1);return function(a){return 0==b?a:0>b?a*(a*-b+1+b):a*((2-a)*b+(1-b))}};b.getPowIn=function(b){return function(a){return Math.pow(a,b)}};b.getPowOut=function(b){return function(a){return 1-Math.pow(1-a,b)}};b.getPowInOut=function(b){return function(a){return 1>(a*=2)?0.5*Math.pow(a,b):1-0.5*Math.abs(Math.pow(2-a,b))}};b.quadIn=b.getPowIn(2);b.quadOut=
b.getPowOut(2);b.quadInOut=b.getPowInOut(2);b.cubicIn=b.getPowIn(3);b.cubicOut=b.getPowOut(3);b.cubicInOut=b.getPowInOut(3);b.quartIn=b.getPowIn(4);b.quartOut=b.getPowOut(4);b.quartInOut=b.getPowInOut(4);b.quintIn=b.getPowIn(5);b.quintOut=b.getPowOut(5);b.quintInOut=b.getPowInOut(5);b.sineIn=function(b){return 1-Math.cos(b*Math.PI/2)};b.sineOut=function(b){return Math.sin(b*Math.PI/2)};b.sineInOut=function(b){return-0.5*(Math.cos(Math.PI*b)-1)};b.getBackIn=function(b){return function(a){return a*
a*((b+1)*a-b)}};b.backIn=b.getBackIn(1.7);b.getBackOut=function(b){return function(a){return--a*a*((b+1)*a+b)+1}};b.backOut=b.getBackOut(1.7);b.getBackInOut=function(b){b*=1.525;return function(a){return 1>(a*=2)?0.5*a*a*((b+1)*a-b):0.5*((a-=2)*a*((b+1)*a+b)+2)}};b.backInOut=b.getBackInOut(1.7);b.circIn=function(b){return-(Math.sqrt(1-b*b)-1)};b.circOut=function(b){return Math.sqrt(1- --b*b)};b.circInOut=function(b){return 1>(b*=2)?-0.5*(Math.sqrt(1-b*b)-1):0.5*(Math.sqrt(1-(b-=2)*b)+1)};b.bounceIn=
function(c){return 1-b.bounceOut(1-c)};b.bounceOut=function(b){return b<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+0.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375};b.bounceInOut=function(c){return 0.5>c?0.5*b.bounceIn(2*c):0.5*b.bounceOut(2*c-1)+0.5};b.getElasticIn=function(b,a){var f=2*Math.PI;return function(e){if(0==e||1==e)return e;var d=a/f*Math.asin(1/b);return-(b*Math.pow(2,10*(e-=1))*Math.sin((e-d)*f/a))}};b.elasticIn=b.getElasticIn(1,0.3);b.getElasticOut=
function(b,a){var f=2*Math.PI;return function(e){if(0==e||1==e)return e;var d=a/f*Math.asin(1/b);return b*Math.pow(2,-10*e)*Math.sin((e-d)*f/a)+1}};b.elasticOut=b.getElasticOut(1,0.3);b.getElasticInOut=function(b,a){var f=2*Math.PI;return function(e){var d=a/f*Math.asin(1/b);return 1>(e*=2)?-0.5*b*Math.pow(2,10*(e-=1))*Math.sin((e-d)*f/a):0.5*b*Math.pow(2,-10*(e-=1))*Math.sin((e-d)*f/a)+1}};b.elasticInOut=b.getElasticInOut(1,0.3*1.5);createjs.Ease=b})();this.createjs=this.createjs||{};
(function(){var b=function(){throw"MotionGuidePlugin cannot be instantiated.";};b.priority=0;b.install=function(){createjs.Tween.installPlugin(b,["guide","x","y","rotation"]);return createjs.Tween.IGNORE};b.init=function(b,a,f){b=b.target;b.hasOwnProperty("x")||(b.x=0);b.hasOwnProperty("y")||(b.y=0);b.hasOwnProperty("rotation")||(b.rotation=0);return"guide"==a?null:f};b.step=function(c,a,f,e,d){if("guide"!=a)return e;var g;e.hasOwnProperty("path")||(e.path=[]);c=e.path;e.hasOwnProperty("end")||(e.end=
1);e.hasOwnProperty("start")||(e.start=f&&f.hasOwnProperty("end")&&f.path===c?f.end:0);if(e.hasOwnProperty("_segments")&&e._length)return e;f=c.length;if(6<=f&&0==(f-2)%4){e._segments=[];e._length=0;for(a=2;a<f;a+=4){for(var h=c[a-2],k=c[a-1],l=c[a+0],r=c[a+1],s=c[a+2],x=c[a+3],v=h,w=k,F,m,E=0,A=[],z=1;10>=z;z++){m=z/10;var D=1-m;F=D*D*h+2*D*m*l+m*m*s;m=D*D*k+2*D*m*r+m*m*x;E+=A[A.push(Math.sqrt((g=F-v)*g+(g=m-w)*g))-1];v=F;w=m}e._segments.push(E);e._segments.push(A);e._length+=E}}else throw"invalid 'path' data, please see documentation for valid paths";
g=e.orient;e.orient=!1;b.calc(e,e.end,d);e.orient=g;return e};b.tween=function(c,a,f,e,d,g,h){d=d.guide;if(void 0==d||d===e.guide)return f;d.lastRatio!=g&&(b.calc(d,(d.end-d.start)*(h?d.end:g)+d.start,c.target),d.orient&&(c.target.rotation+=e.rotation||0),d.lastRatio=g);return!d.orient&&"rotation"==a?f:c.target[a]};b.calc=function(c,a,f){void 0==c._segments&&b.validate(c);void 0==f&&(f={x:0,y:0,rotation:0});var e=c._segments,d=c.path,g=c._length*a,h=e.length-2;for(a=0;g>e[a]&&a<h;)g-=e[a],a+=2;for(var e=
e[a+1],k=0,h=e.length-1;g>e[k]&&k<h;)g-=e[k],k++;g=k/++h+g/(h*e[k]);a=2*a+2;h=1-g;f.x=h*h*d[a-2]+2*h*g*d[a+0]+g*g*d[a+2];f.y=h*h*d[a-1]+2*h*g*d[a+1]+g*g*d[a+3];c.orient&&(f.rotation=57.2957795*Math.atan2((d[a+1]-d[a-1])*h+(d[a+3]-d[a+1])*g,(d[a+0]-d[a-2])*h+(d[a+2]-d[a+0])*g));return f};createjs.MotionGuidePlugin=b})();(function(){var b=this.createjs=this.createjs||{},b=b.TweenJS=b.TweenJS||{};b.version="0.4.0";b.buildDate="Tue, 12 Feb 2013 21:09:02 GMT"})();
var Stats=function(){var b=Date.now(),c=b,a=0,f=Infinity,e=0,d=0,g=Infinity,h=0,k=0,l=0,r=document.createElement("div");r.id="stats";r.addEventListener("mousedown",function(a){a.preventDefault();A(++l%2)},!1);r.style.cssText="width:80px;opacity:0.9;cursor:pointer";var s=document.createElement("div");s.id="fps";s.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";r.appendChild(s);var x=document.createElement("div");x.id="fpsText";x.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";
x.innerHTML="FPS";s.appendChild(x);var v=document.createElement("div");v.id="fpsGraph";v.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(s.appendChild(v);74>v.children.length;){var w=document.createElement("span");w.style.cssText="width:1px;height:30px;float:left;background-color:#113";v.appendChild(w)}var F=document.createElement("div");F.id="ms";F.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";r.appendChild(F);var m=document.createElement("div");
m.id="msText";m.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";m.innerHTML="MS";F.appendChild(m);var E=document.createElement("div");E.id="msGraph";E.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(F.appendChild(E);74>E.children.length;)w=document.createElement("span"),w.style.cssText="width:1px;height:30px;float:left;background-color:#131",E.appendChild(w);var A=function(a){l=a;switch(l){case 0:s.style.display=
"block";F.style.display="none";break;case 1:s.style.display="none",F.style.display="block"}};return{REVISION:11,domElement:r,setMode:A,begin:function(){b=Date.now()},end:function(){var l=Date.now();a=l-b;f=Math.min(f,a);e=Math.max(e,a);m.textContent=a+" MS ("+f+"-"+e+")";var r=Math.min(30,30-30*(a/200));E.appendChild(E.firstChild).style.height=r+"px";k++;l>c+1E3&&(d=Math.round(1E3*k/(l-c)),g=Math.min(g,d),h=Math.max(h,d),x.textContent=d+" FPS ("+g+"-"+h+")",r=Math.min(30,30-30*(d/100)),v.appendChild(v.firstChild).style.height=
r+"px",c=l,k=0);return l},update:function(){b=this.end()}}};
Box2D.Common.Separator=function(){var b=function(a,b,c,g,h,k){var l;if(l=(c+0.1>=a&&a>=h-0.1||c-0.1<=a&&a<=h+0.1)&&(g+0.1>=b&&b>=k-0.1||g-0.1<=b&&b<=k+0.1))0.1<h-c||0.1<c-h?(a=(k-g)/(h-c)*(a-c)+g,l=0.1>(a>b?a-b:b-a)):l=0.1>a-c||0.1>c-a;return l},c=function(a,b,c,g){return 0.1>(c>=a?c-a:a-c)&&0.1>(g>=b?g-b:b-g)},a=function(){throw Error("A problem has occurred. Use the Validate() method to see where the problem is.");};return{Separate:function(f,e,d,g){g=g||30;var h,k=d.length,l,r,s=[];for(h=0;h<k;h++)s.push(new Ses.b2Vec2(d[h].x*
g,d[h].y*g));var x,v,w,F,m,E,A,z,D,H,C,M,G,I,N=[];d=[];for(d.push(s);d.length;){h=d[0];k=h.length;I=!0;for(x=0;x<k;x++)if(s=x,A=x<k-1?x+1:x+1-k,w=x<k-2?x+2:x+2-k,z=h[s],D=h[A],w=h[w],w=z.x*D.y+D.x*w.y+w.x*z.y-z.y*D.x-D.y*w.x-w.y*z.x,0>w){I=!1;E=Number.MAX_VALUE;for(v=0;v<k;v++)if(v!=s&&v!=A){x=v;w=v<k-1?v+1:0;H=h[x];C=h[w];F=z.x;m=z.y;var L=D.x,q=D.y;M=H.x;H=H.y;var t=C.x;C=C.y;var B=L-F,y=q-m,K=t-M,P=C-H,O=void 0,O=(K*(H-m)-P*(M-F))/(y*K-B*P),B=F+O*B,y=m+O*y;F=b(L,q,F,m,B,y);M=b(B,y,M,H,t,C);if(M=
F&&M?new Ses.b2Vec2(B,y):null)F=D.x-M.x,m=D.y-M.y,F=F*F+m*m,F<E&&(r=x,l=w,G=M,E=F)}E==Number.MAX_VALUE&&a();v=[];E=[];x=r;w=l;H=h[x];C=h[w];c(G.x,G.y,C.x,C.y)||v.push(G);c(G.x,G.y,H.x,H.y)||E.push(G);r=-1;for(l=s;;){if(l!=w)v.push(h[l]);else{(0>r||r>=k)&&a();b(C.x,C.y,h[r].x,h[r].y,z.x,z.y)||v.push(h[l]);break}r=l;0>l-1?l=k-1:l--}v=v.reverse();r=-1;for(l=A;;){if(l!=x)E.push(h[l]);else{(0>r||r>=k)&&a();l==x&&!b(H.x,H.y,h[r].x,h[r].y,D.x,D.y)&&E.push(h[l]);break}r=l;l+1>k-1?l=0:l++}d.push(v,E);d.shift();
break}I&&N.push(d.shift())}k=N.length;for(h=0;h<k;h++){d=[];s=N[h];r=s.length;for(l=0;l<r;l++)d.push(new Ses.b2Vec2(s[l].x/g,s[l].y/g));l=new Ses.b2PolygonShape;l.SetAsVector(d);e.shape=l;f.CreateFixture(e)}},Validate:function(a){var c,d=a.length,g,h,k,l,r,s=0,x,v=!1;for(c=0;c<d;c++){k=c<d-1?c+1:0;l=0<c?c-1:d-1;x=!1;for(g=0;g<d;g++)if(g!=c&&g!=k&&(x||(r=a[c].x*a[k].y+a[k].x*a[g].y+a[g].x*a[c].y-a[c].y*a[k].x-a[k].y*a[g].x-a[g].y*a[c].x,0<r&&(x=!0)),g!=l)){h=g<d-1?g+1:0;var w=a[c].x,F=a[c].y,m=a[k].x,
E=a[k].y;r=a[g].x;var A=a[g].y,z=a[h].x;h=a[h].y;var D=m-w,H=E-F,C=z-r,M=h-A,G=void 0,G=(C*(A-F)-M*(r-w))/(H*C-D*M),D=w+G*D,H=F+G*H,w=b(D,H,w,F,m,E);r=b(D,H,r,A,z,h);r=w&&r?new Ses.b2Vec2(D,H):null;r&&(s=1)}x||(v=!0)}v&&(s=1==s?3:2);return s},validateToString:function(a){switch(a){case 0:return"0 if the vertices can be properly processed.";case 1:return"1 If there are overlapping lines.";case 2:return"2 if the points are <b>not</b> in clockwise order.";case 3:return"3 if there are overlapping lines <b>and</b> the points are <b>not</b> in clockwise order.";
default:return"Unkown reason"}}}}();
(function(){var b=!1,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(a){function f(){!b&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;b=!0;var d=new this;b=!1;for(var g in a)d[g]="function"==typeof a[g]&&"function"==typeof e[g]&&c.test(a[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);this._super=c;return d}}(g,a[g]):a[g];f.prototype=d;f.prototype.constructor=f;f.extend=arguments.callee;
return f}})();
Ses.Core.Entity=Class.extend({maxHitPoints:100,currentHitPoints:10,alive:!0,init:function(){},update:function(){this.body&&(this.shape.x=this.body.GetWorldCenter().x*Ses.Engine.Scale,this.shape.y=this.body.GetWorldCenter().y*Ses.Engine.Scale,this.shape.rotation=this.body.GetAngle()*(180/Math.PI))},draw:function(b){throw Error("This method should be overriden !");},getCustomDrawFunction:function(b,c){var a=this,f=b||0,e=c||0;return function(b){b.save();b.translate(f,e);a.draw(b);b.restore()}},hit:function(b){this.currentHitPoints-=
b;0>=this.currentHitPoints&&this.setDead()},setKillable:function(){if(this.body){var b=this;Ses.Physic.addOnPostSolveContactListener(this.body,function(c,a){3<a.normalImpulses[0]&&b.hit(a.normalImpulses[0])})}},getLifeInPrecetage:function(){return 1>this.currentHitPoints?0:this.currentHitPoints/this.maxHitPoints},setDead:function(){this.alive&&(this.alive=!1,this.onDieCallback&&this.onDieCallback.call())},setOnDieListener:function(b){this.onDieCallback=b},watch:function(b,c){if(void 0===this[b])throw Error("This entity doesnt have this property");
if(this[b+"_listeners"])this[b+"_listeners"].push(c);else{var a=this[b+"_listeners"]=[c],f=this[b+"_"]=this[b];this.__defineSetter__(b,function(b){for(var c=0;c<a.length;++c)a[c].call({},f,b);f=b});this.__defineGetter__(b,function(){return f})}}});
Ses.Core.EntityPool=Class.extend({init:function(b,c,a){this.pool=[];for(var f=0;f<c;++f){var e=function(){function c(){return b.apply(this,e)}var e=[],f;for(f in a)e.push(a[f]());c.prototype=b.prototype;return c}();this.pool.push(new e)}},getOne:function(){for(var b=0;b<this.pool.length;++b)if(this.pool[b].alive)return this.pool[b]}});Ses.Constans={SpaceShip:{Radious:44/30/2,Armour:100,Density:10,Rope:{Length:5,NumberOfLinks:8,Width:0.05,Density:0.5}}};
Ses.Engine={Maps:[],currentView:null,KeyBindings:{Esc:{code:27,callbacks:[]},Space:{code:32,callbacks:[]},D:{code:68,callbacks:[]},Q:{code:81,callbacks:[]},W:{code:87,callbacks:[]},E:{code:69,callbacks:[]},X:{code:88,callbacks:[]}},mouseScrollListeners:[],Graphics:"high",init:function(b){Ses.Engine.FPS=60;Ses.Engine.Scale=30;window.onkeydown=this.keyDispatcher;window.onkeyup=this.keyDispatcher;window.addEventListener&&window.addEventListener("DOMMouseScroll",this.mouseScrollHandler,!1);window.onmousewheel=
this.mouseScrollHandler;Ses.b2Vec2=Box2D.Common.Math.b2Vec2;Ses.b2AABB=Box2D.Collision.b2AABB;Ses.b2BodyDef=Box2D.Dynamics.b2BodyDef;Ses.b2Body=Box2D.Dynamics.b2Body;Ses.b2FixtureDef=Box2D.Dynamics.b2FixtureDef;Ses.b2Fixture=Box2D.Dynamics.b2Fixture;Ses.b2World=Box2D.Dynamics.b2World;Ses.b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape;Ses.b2CircleShape=Box2D.Collision.Shapes.b2CircleShape;Ses.b2DebugDraw=Box2D.Dynamics.b2DebugDraw;window.onresize=function(){b.width=window.innerWidth;b.height=
window.innerHeight;Ses.Engine.ScreenWidth=b.width;Ses.Engine.ScreenHeight=b.height;if(Ses.Engine.currentView)Ses.Engine.currentView.onWindowResize()};window.onresize();this.stage=new createjs.Stage(b);createjs.Touch.enable(this.stage,!0);createjs.Ticker.addEventListener("tick",this.updateStage);createjs.Ticker.setFPS(Ses.Engine.FPS);createjs.Ticker.useRAF=!0},updateStage:function(b){Ses.Engine.stats&&Ses.Engine.stats.begin();Ses.Engine.currentView&&Ses.Engine.currentView.update(b);Ses.Engine.stats&&
Ses.Engine.stats.end()},changeView:function(b){this.currentView&&this.currentView.remove();this.currentView=new b(this.stage)},addKeyListener:function(b,c){this.KeyBindings[b]?this.KeyBindings[b].callbacks.push(c):Ses.err("Key shouldnt be used")},keyDispatcher:function(b){for(var c in Ses.Engine.KeyBindings){var a=Ses.Engine.KeyBindings[c];if(a.code===b.keyCode)for(var f=0;f<a.callbacks.length;++f)b.preventDefault(),a.callbacks[f].call(Ses.Engine.currentView,b)}},mouseScrollHandler:function(b){var c=
0;if(c=b.wheelDelta?b.wheelDelta/120:-b.detail/3)for(var a=0;a<Ses.Engine.mouseScrollListeners.length;++a)Ses.Engine.mouseScrollListeners[a].call(Ses.Engine.currentView,c),b.preventDefault()},addMouseScrollListener:function(b){this.mouseScrollListeners.push(b)},clearInputListeners:function(){Ses.Engine.mouseScrollListeners=[];for(var b in Ses.Engine.KeyBindings)Ses.Engine.KeyBindings[b].callbacks=[]},loadMaps:function(){var b=new XMLHttpRequest;b.open("GET","maps/maps_0.2b.json",!1);b.onload=function(){Ses.Engine.processMaps(this.responseText)};
b.send()},processMaps:function(b){b=JSON.parse(b);for(var c=b.tilewidth,a=b.tileheight,f=0;f<b.layers.length;++f){var e=b.layers[f],d={name:e.name,width:e.width,height:e.height,objects:[]};this.flatProperties(e,d);for(var g=0;g<e.objects.length;++g){var h=e.objects[g],k={name:h.name,width:h.width/c,height:h.height/a,type:h.type,x:h.x/c+h.width/c/2,y:h.y/a+h.height/a/2};this.flatProperties(h,k);d.objects.push(k)}Ses.Engine.Maps.push(d);0<f&&Ses.Menu.addMap(d.name,function(a,b){return function(){Ses.Engine.changeView(Ses.Engine.GameView);
Ses.Engine.currentView.initMap(a);_gaq.push(["_trackEvent",b,"start"])}}(f,d.name))}},restartMap:function(){setTimeout(function(){var b=Ses.Engine.currentView.mapid;Ses.Engine.changeView(Ses.Engine.GameView);Ses.Engine.currentView.initMap(b);_gaq.push(["_trackEvent",Ses.Engine.Maps[b].name,"restart"])},60)},nextMap:function(){setTimeout(function(){var b=Ses.Engine.currentView.mapid;b<Ses.Engine.Maps.length-1&&(b+=1);Ses.Engine.changeView(Ses.Engine.GameView);Ses.Engine.currentView.initMap(b)},60)},
showDemo:function(){Ses.Engine.changeView(Ses.Engine.GameView);Ses.Engine.currentView.initMap(0)},flatProperties:function(b,c){if(!b.properties)return null;for(var a in b.properties)c[a]=b.properties[a]},showStats:function(){this.stats=new Stats;this.stats.setMode(0);this.stats.domElement.style.opacity=0.3;document.getElementById("game_div").appendChild(this.stats.domElement)}};
Ses.Physic={bodyDef:new Box2D.Dynamics.b2BodyDef,fixtureDef:new Box2D.Dynamics.b2FixtureDef,revoluteJointDef:new Box2D.Dynamics.Joints.b2RevoluteJointDef,weldJointDef:new Box2D.Dynamics.Joints.b2WeldJointDef,onBeginContactCallbacks:[],onEndContactCallbacks:[],onPostSolveContacCallbacks:[],jointsToCreate:[],jointsToRemove:[],CATEGORY_JET_PARTICLE:2,CATEGORY_WORLD:4,CATEGORY_SENSOR:8,CATEGORY_SHIP:16,CATEGORY_GRASPER:32,CATEGORY_BROKEN_SHIP:128,SHIP_MASK:-3,JET_PARTICLE_MASK:-19,SENSOR_MASK:16,WORLD_MASK:-9,
setupFixtureDef:function(b,c){c=c||{};for(var a in c)if("object"===typeof c[a])for(var f in c[a])b[a][f]=c[a][f];else b[a]=c[a];c.density?c.friction||(b.friction=0.5):b.density=1},createBody:function(b){var c=Ses.Physic.World.CreateBody(this.bodyDef);b&&c.CreateFixture(b);return c},createStaticBody:function(b,c){this.bodyDef.type=Box2D.Dynamics.b2Body.b2_staticBody;this.bodyDef.position.Set(c.x,c.y);return this.createBody(b)},createDynamicBody:function(b,c){this.bodyDef.type=Box2D.Dynamics.b2Body.b2_dynamicBody;
this.bodyDef.position.Set(c.x,c.y);return this.createBody(b)},createRectangleObject:function(b,c,a,f){var e=new Box2D.Dynamics.b2FixtureDef;this.setupFixtureDef(e,f);e.shape=new Box2D.Collision.Shapes.b2PolygonShape;e.shape.SetAsBox(b,c);return this.createDynamicBody(e,a)},createCircleObject:function(b,c,a){var f=new Box2D.Dynamics.b2FixtureDef;this.setupFixtureDef(f,a);f.shape=new Box2D.Collision.Shapes.b2CircleShape(b);return this.createDynamicBody(f,c)},createRevoluteJoint:function(b,c,a,f){this.revoluteJointDef.localAnchorA.Set(a.x,
a.y);this.revoluteJointDef.localAnchorB.Set(f.x,f.y);this.revoluteJointDef.bodyA=b;this.revoluteJointDef.bodyB=c;return Ses.Physic.World.CreateJoint(this.revoluteJointDef)},createRevoluteJoint2:function(b,c,a){var f=new Box2D.Dynamics.Joints.b2RevoluteJointDef;f.Initialize(b,c,a);return Ses.Physic.World.CreateJoint(f)},createWeldJoint:function(b,c,a){var f=new Box2D.Dynamics.Joints.b2WeldJointDef;f.Initialize(b,c,a);return Ses.Physic.World.CreateJoint(f)},createDistanceJoint:function(b,c,a,f){var e=
new Box2D.Dynamics.Joints.b2DistanceJointDef;e.Initialize(b,c,a,f);return Ses.Physic.World.CreateJoint(e)},initContactListener:function(){var b=new Box2D.Dynamics.b2ContactListener;b.BeginContact=this.createContactHandler(this.onBeginContactCallbacks);b.EndContact=this.createContactHandler(this.onEndContactCallbacks);b.PostSolve=this.createContactHandler(this.onPostSolveContacCallbacks);Ses.Physic.World.SetContactListener(b);this.contactListener=b},createContactHandler:function(b){return function(c,
a){for(var f=c.GetFixtureA().GetBody(),e=c.GetFixtureB().GetBody(),d=0;d<b.length;++d){var g=b[d].body,h=b[d].callback;f===g?h.call(void 0,e,a):e===g&&h.call(void 0,f,a)}}},addOnBeginContactListener:function(b,c){this.contactListener||this.initContactListener();this.onBeginContactCallbacks.push({body:b,callback:c})},addOnEndContactListener:function(b,c){this.contactListener||this.initContactListener();this.onEndContactCallbacks.push({body:b,callback:c})},addOnPostSolveContactListener:function(b,c){this.contactListener||
this.initContactListener();this.onPostSolveContacCallbacks.push({body:b,callback:c})},removeBodyListeners:function(b){[this.onPostSolveContacCallbacks,this.onEndContactCallbacks,this.onBeginContactCallbacks].forEach(function(c){for(var a=0;a<c.length;++a)if(c[a].body===b){c.splice(a,1);break}})},createRectangleSesnor:function(b,c,a,f,e){var d=new Box2D.Dynamics.b2FixtureDef;this.setupFixtureDef(d,e);d.shape=new Box2D.Collision.Shapes.b2PolygonShape;d.shape.SetAsBox(a,f);d.isSensor=!0;return this.createStaticBody(d,
new Ses.b2Vec2(b,c))},createCircleSesnor:function(b,c,a,f){var e=new Box2D.Dynamics.b2FixtureDef;this.setupFixtureDef(e,f);e.shape=new Box2D.Collision.Shapes.b2CircleShape(a);e.isSensor=!0;return this.createStaticBody(e,new Ses.b2Vec2(b,c))},destroyWorld:function(){this.onBeginContactCallbacks=[];this.onEndContactCallbacks=[];this.onPostSolveContacCallbacks=[];this.contactListener=null;var b=Ses.Physic.World.GetJointList(),c=0;if(b)for(c=0;c<b.length;++c)Ses.Physic.World.DestroyJoint(b[c]);if(b=Ses.Physic.World.GetBodyList()){0<
b.length&&Ses.err("While destroying world, there are bodies alive !");for(c=0;c<b.length;++c)Ses.Physic.World.DestroyBody(b[c])}},removeJoint:function(b){Ses.Physic.World.DestroyJoint(b)}};Ses.Engine.View=Class.extend({init:function(b){this.stage=b},update:function(){Ses.err("Method not overridden")},remove:function(){Ses.err("Method not overridden")}});
Ses.Engine.GameView=Ses.Engine.View.extend({useBox2dDebugDraw:!1,init:function(b){this._super(b);Ses.Engine.Factory.gameView=this;this.gameObjects=[];this.mapObjectives=[];this.conditionsFor2Stars=[];this.fakeStage=new createjs.Container;this.stage.addChild(this.fakeStage);var c=this;[this.stage,this.fakeStage].forEach(function(a){a.addGameObject=function(a){c.addGameObject(a)};a.removeGameObject=function(a){c.removeGameObject(a)};a.spaceShipOutOfMap=function(a){c.spaceShipOutOfMap(a)}});Ses.Physic.World=
new Ses.b2World(new Ses.b2Vec2(0,0),!0);this.navigator=new Ses.Engine.Navigator(this.fakeStage)},update:function(b){this.fakeStage.delta=b.delta;Ses.Physic.World.Step(b.delta/1E3,10,10);Ses.Physic.World.ClearForces();for(b=0;b<this.gameObjects.length;++b)this.gameObjects[b].update(this.fakeStage);this.updateCamera();this.navigator.update();this.stage.update()},onWindowResize:function(){this.updateUi();this.navigator.onWindowResize()},initMap:function(b){this.mapid=b;if(this.DemoMap=0===b)this.updateCamera=
function(){},this.fakeStage.scaleX=this.fakeStage.scaleY=0.5;Ses.Engine.Maps[b].scale&&(this.fakeStage.scaleX=parseFloat(Ses.Engine.Maps[b].scale),this.fakeStage.scaleY=parseFloat(Ses.Engine.Maps[b].scale));b=Ses.Engine.Maps[b].objects;for(var c=0;c<b.length;++c){var a=Ses.Engine.Factory.createObject(b[c]);this.addGameObject(a)}this.DemoMap||(this.showMapName(),this.initKeyListeners(),this.start=(new Date).getTime(),this.lastFrameTime=0)},initKeyListeners:function(){var b={Q:"StartEngine",W:"FireGrasper",
E:"RemoveGraspers"},c=this,a;for(a in b)(function(a){Ses.Engine.addKeyListener(a,function(e){"keydown"===e.type?c.fakeStage[b[a]]=!0:"keyup"===e.type&&(c.fakeStage[b[a]]=!1)})})(a);Ses.Engine.addKeyListener("Esc",function(a){if("keydown"===a.type)c.onGameOver()});Ses.Engine.addKeyListener("X",function(a){if("keydown"===a.type)c.onGameRestart()});this.stage.addEventListener("stagemousedown",function(a){0===a.nativeEvent.button&&(c.fakeStage.StartEngine=!0)});this.stage.addEventListener("stagemouseup",
function(a){0===a.nativeEvent.button&&(c.fakeStage.StartEngine=!1)});Ses.Engine.addMouseScrollListener(function(a){this.fakeStage.scaleX+=0.05*a;0.2>this.fakeStage.scaleX&&(this.fakeStage.scaleX=0.2);10<this.fakeStage.scaleX&&(this.fakeStage.scaleX=10);this.fakeStage.scaleY+=0.05*a;0.2>this.fakeStage.scaleY&&(this.fakeStage.scaleY=0.2);10<this.fakeStage.scaleY&&(this.fakeStage.scaleY=10)})},addGameObject:function(b){b.body&&this.gameObjects.push(b);b.shape&&this.fakeStage.addChild(b.shape);if(!this.DemoMap&&
b.body){var c=b.body.GetUserData();c&&c.SpaceShip?this.setupShipUiAndCamera(b):c&&c.BrokenShip&&this.setupTargetUi(b)}},removeGameObject:function(b){var c=this.gameObjects.indexOf(b);this.gameObjects.splice(c,1);b.shape&&this.fakeStage.removeChild(b.shape);Ses.Physic.World.DestroyBody(b.body)},setupUi:function(){this.ui=new Ses.Ui.ArmourBars(300,30);this.stage.addChild(this.ui.shape);this.updateUi()},updateUi:function(){this.ui&&(this.ui.shape.y=Ses.Engine.ScreenHeight-this.ui.height-10,this.ui.shape.x=
Ses.Engine.ScreenWidth/2-this.ui.width/2)},setupShipUiAndCamera:function(b){this.cameraFollowObject=b;this.navigator.setCenter(b.body.GetWorldCenter());this.ui||this.setupUi();this.ui.updateShipBar(b.getLifeInPrecetage());var c=this;b.watch("currentHitPoints",function(a,f){var e=0;0<f&&(e=f/b.maxHitPoints);c.ui.updateShipBar(e)})},setupTargetUi:function(b){this.ui||this.setupUi();this.ui.updateTargetBar(b.getLifeInPrecetage());var c=this;b.watch("currentHitPoints",function(a,f){var e=0;0<f&&(e=f/
b.maxHitPoints);c.ui.updateTargetBar(e)})},updateCamera:function(){if(this.cameraFollowObject){var b=this.cameraFollowObject.body.GetWorldCenter(),c=this.fakeStage;c.x=-b.x*Ses.Engine.Scale*c.scaleX;c.y=-b.y*Ses.Engine.Scale*c.scaleY;var a=this.stage.localToLocal(Ses.Engine.ScreenWidth/2,Ses.Engine.ScreenHeight/2,c),f=Ses.Engine.Scale;c.x+=(a.x-b.x*f)*c.scaleX;c.y+=(a.y-b.y*f)*c.scaleY}},addMapObjective:function(b,c){var a=this.mapObjectives,f=this,e={done:!1,isDone:function(){return this.done},setDone:function(){this.done=
!0;for(var b=0;b<a.length;++b)if(!a[b].isDone())return;f.onGameWin()}};a.push(e);switch(b){case "O_StopInHere":c.setOnObjectEnterListener(function(a){c.docking=a});c.setOnObjectLeaveListener(function(a){c.docking=null});c.watch("docked",function(a,b){b&&e.setDone()});break;case "O_MoveThrough":c.setOnObjectEnterListener(function(){e.setDone();c.fadeOut(function(){f.removeGameObject(c)})});break;case "O_CantDie":e.done=!0;c.setOnDieListener(function(){f.onGameOver()});break;case "O_Track":this.navigator.track(c),
e.done=!0}},addScoreCondition:function(b,c){var a=this;this.conditionsFor2Stars.push(!1);var f=this.conditionsFor2Stars.length-1;switch(b){case "SC_DeadFor2Stars":c.watch("alive",function(b,c){!1===c&&(a.conditionsFor2Stars[f]=!0)})}},onGameWin:function(){if(this.onGameEnd()){for(var b=2,c=0;c<this.conditionsFor2Stars.length;++c)if(!1===this.conditionsFor2Stars[c]){b-=1;break}var c=parseFloat(Ses.Engine.Maps[this.mapid].time),a=(new Date).getTime()-this.start;a<1E3*c&&(b+=1);Ses.Menu.showGameWin(Ses.Engine.Maps[this.mapid].name,
a,b)}},onGameOver:function(){var b=(new Date).getTime()-this.start,c=Ses.Engine.Maps[this.mapid].name;this.onGameEnd()&&Ses.Menu.showGameOver(c,b)},onGameRestart:function(){this.onGameEnd();Ses.Engine.restartMap()},onGameEnd:function(){if(this.fakeStage.gameOver)return!1;this.mapObjectives=[];this.stage.removeAllEventListeners();Ses.Engine.clearInputListeners();var b=this;this.fakeStage.gameOver=!0;this.update=function(){Ses.Physic.World.Step(1/(16*Ses.Engine.FPS),2,2);Ses.Physic.World.ClearForces();
for(var c=0;c<b.gameObjects.length;++c)b.gameObjects[c].update(b.fakeStage);b.stage.update()};this.navigator.hide();this.ui.hide();return!0},remove:function(){for(var b=0;b<this.gameObjects.length;++b)this.removeGameObject(this.gameObjects[b]);Ses.Physic.destroyWorld();this.stage.removeAllChildren();this.stage.clear()},initBox2dDebugDraw:function(){var b=new Ses.b2DebugDraw;b.SetDrawScale(Ses.Engine.Scale);b.SetSprite(this.stage.canvas.getContext("2d"));b.SetFillAlpha(0.5);b.SetLineThickness(1);b.SetFlags(Ses.b2DebugDraw.e_shapeBit|
Ses.b2DebugDraw.e_jointBit);Ses.Physic.World.SetDebugDraw(b)},showMapName:function(){var b=new createjs.Text(Ses.Engine.Maps[this.mapid].name,"40px TitilliumText25L400wt","#ffffff");b.x=Ses.Engine.ScreenWidth/2-b.getMeasuredWidth()/2;b.y=50;b.shadow=new createjs.Shadow("#0096ff",0,0,8);this.stage.addChild(b);var c=this;createjs.Tween.get(b,{loop:!1}).wait(1E3).to({alpha:0},3E3,createjs.Ease.Linear).call(function(){c.stage.removeChild(b)})},spaceShipOutOfMap:function(b){this.displayWarning=!0;if(!this.outOfMap){this.warning||
(b=new createjs.Text('You are flying through the endless space, please consider pressing "X" to restart the map.',"30px TitilliumText25L400wt","#ffffff"),b.y=50,b.shadow=new createjs.Shadow("#ff0000",0,0,8),this.warning=b,this.stage.addChild(this.warning));this.warning.lineWidth=Ses.Engine.ScreenWidth-100;this.warning.x=Ses.Engine.ScreenWidth/2-this.warning.lineWidth/2;this.warning.visible=!0;this.outOfMap=this.warning;var c=this;createjs.Tween.get(this.warning,{loop:!0}).to({alpha:0.7},500,createjs.Ease.Linear).to({alpha:1},
500,createjs.Ease.Linear).call(function(){c.displayWarning?c.displayWarning=!1:(createjs.Tween.removeTweens(c.warning),c.warning.visible=!1,c.outOfMap=null)})}}});
Ses.Engine.Navigator=Class.extend({init:function(b){this.fakeStage=b;this.layer=new createjs.Container;b.getStage().addChild(this.layer);this.trackedEntities=[];this.counter=0;this.onWindowResize()},setCenter:function(b){this.center=b},update:function(){if(this.center&&!(3>++this.counter))for(var b=this.counter=0;b<this.trackedEntities.length;++b){var c=this.trackedEntities[b],a=c.position.Copy();a.Subtract(this.center);var f=a.Length()*Ses.Engine.Scale;1*this.radious/this.fakeStage.scaleX>f-100?
c.shape.visible=!1:(c.shape.visible=!0,c.text.text=a.Length().toFixed(1)+"m",a=this.getMarkPosition(a),f={x:Ses.Engine.ScreenWidth/2,y:Ses.Engine.ScreenHeight/2},c.arrow.rotation=180*Math.atan2(a.y,a.x)/Math.PI+90,c.arrow.x=30*a.x,c.arrow.y=30*a.y,a.Multiply(this.radious),a.Add(f),c.shape.x=a.x,c.shape.y=a.y)}},track:function(b){b={color:b.trackColor||"rgba(0, 158, 255, 0.5)",position:b.body.GetWorldCenter(),shape:new createjs.Container};var c=new createjs.Text("dst","14px TitilliumText25L400wt",
b.color);c.x=-15;c.y=-5;b.text=c;b.shape.addChild(c);c=new createjs.Shape;c.graphics.f(b.color).mt(0,0).lt(-5,5).lt(0,-10).lt(5,5).lt(0,0).closePath();b.shape.addChild(c);b.arrow=c;this.layer.addChild(b.shape);this.trackedEntities.push(b)},getMarkPosition:function(b){var c=1/b.Length();b=b.Copy();b.Multiply(c);return b},hide:function(){this.layer.visible=!1},onWindowResize:function(){this.radious=(Math.min(Ses.Engine.ScreenHeight,Ses.Engine.ScreenWidth)-150)/2}});
Ses.Entities.SpaceShip=Ses.Core.Entity.extend({worldCenter:new Box2D.Common.Math.b2Vec2(50,50),frameCounter:0,init:function(b,c){this.currentHitPoints=this.maxHitPoints;this.jetParticlePool=new Ses.Core.EntityPool(Ses.Entities.JetExhaustParticle,60,{x:function(){return 0},y:function(){return 0},radious:function(){return 0.15*Math.random()+0.05}});this.body=Ses.Physic.createCircleObject(Ses.Constans.SpaceShip.Radious,{x:b,y:c},{density:Ses.Constans.SpaceShip.Density,filter:{maskBits:Ses.Physic.SHIP_MASK,
categoryBits:Ses.Physic.CATEGORY_SHIP}});this.body.SetBullet(!0);this.body.SetUserData({SpaceShip:!0});this.initShape();this.setKillable();this.makeAnchorOnShip()},initShape:function(){var b=new createjs.Graphics;b.beginStroke("#ffffff");b.setStrokeStyle(1);b.rect(-22,-21.5,44,43);this.shape=new createjs.Shape(b);b=this.shape.draw;this.shape.draw=this.getCustomDrawFunction(-22,-21.5);switch(Ses.Engine.Graphics){case "medium":case "low":this.shape.cache(-22,-21.5,44,43,2),this.shape.draw=b}},update:function(b){this._super();
if(!b.gameOver){var c=b.getStage(),a=c.mouseX,f=c.mouseY,f=c.localToLocal(a,f,b),c=this.body.GetWorldCenter(),a=f.x/Ses.Engine.Scale,f=f.y/Ses.Engine.Scale,a=a-c.x,f=f-c.y;this.body.SetAngle(Math.atan2(f,a)+Math.PI/2);this.updateCounterRotationMotor(b);b.StartEngine&&this.startEngine(b);0===++this.frameCounter%4&&(a=c.Copy(),a.Subtract(this.worldCenter),a=a.Length(),105<a&&b.spaceShipOutOfMap(a))}},startEngine:function(b){var c;c=60*(0.9*b.delta/1E3);c=new Ses.b2Vec2(Math.cos(this.body.GetAngle()-
Math.PI/2)*c,Math.sin(this.body.GetAngle()-Math.PI/2)*c);this.body.ApplyImpulse(c,this.body.GetWorldCenter());var a=this.body.GetLinearVelocity(),f=this.body.GetWorldCenter().Copy();c.NegativeSelf();c.Normalize();c.Multiply(0.5);f.Add(c);c.x*=0.03+0.05*Math.random();c.y*=0.03+0.05*Math.random();if(b=this.createJetParticle(f,b))b.body.SetLinearVelocity(a),b.body.ApplyImpulse(c,b.body.GetWorldCenter())},createJetParticle:function(b,c){var a=this.jetParticlePool.getOne();if(a)return a.shape.visible=
!0,a.body.SetActive(!0),a.body.SetPosition(new Ses.b2Vec2(b.x,b.y)),a.isOnStage||(c.addGameObject(a),a.isOnStage=!0),a.startFading(1E3),a},makeAnchorOnShip:function(){var b=this.body.GetWorldCenter(),c=Ses.Physic.createCircleObject(0.3,{x:b.x,y:b.y}),b=Ses.Physic.createCircleObject(0.2,{x:b.x,y:b.y});Ses.Physic.createRevoluteJoint(this.body,c,new Ses.b2Vec2(0,0),new Ses.b2Vec2(0,0));Ses.Physic.createRevoluteJoint(c,b,new Ses.b2Vec2(0,0),new Ses.b2Vec2(0,0));Ses.Physic.createRevoluteJoint(this.body,
b,new Ses.b2Vec2(0,0),new Ses.b2Vec2(0,0));this.anchors=[c,b]},getAnchor:function(){var b=null;this.anchors.forEach(function(c){null===c.GetJointList().next.next&&(b=c)});if(null===b)throw Error("No more free anchors on ship to fire a rope");return b},updateCounterRotationMotor:function(b){for(b=0;b<this.anchors.length;++b){var c=this.anchors[b],a=c.GetAngularVelocity();0.3<a||-0.3>a?c.SetAngularVelocity(30*-a):0.1<a||-0.1>a?c.SetAngularVelocity(90*-a):c.SetAngularVelocity(180*-a)}},draw:function(b){b.save();
b.beginPath();b.moveTo(0,0);b.lineTo(43.977,0);b.lineTo(43.977,42.616);b.lineTo(0,42.616);b.closePath();b.clip();b.strokeStyle="rgba(0,0,0,0)";b.lineCap="butt";b.lineJoin="miter";b.miterLimit=4;b.save();b.restore();b.save();b.fillStyle="rgba(0, 0, 0, 0)";b.strokeStyle="#ffffff";b.lineWidth=1;b.lineJoin="bevel";b.miterLimit=4;b.beginPath();b.moveTo(22,21.353);b.bezierCurveTo(17.118000000000002,21.461000000000002,12.599,17.481,12.08,12.627);b.bezierCurveTo(11.618,9.352,12.974,5.985,15.407,3.7827);b.bezierCurveTo(15.912,
2.8436000000000003,18.523,1.27,16.749,0.5429000000000004);b.bezierCurveTo(13.985999999999999,0.3338200000000004,11.54,2.0017000000000005,9.3441,3.4711000000000003);b.bezierCurveTo(3.0759999999999996,7.9451,-0.3846000000000007,15.9611,0.672699999999999,23.5921);b.bezierCurveTo(1.020719999999999,25.421999999999997,1.032369999999999,27.779799999999998,2.889699999999999,28.7941);b.bezierCurveTo(4.825599999999999,29.9509,6.368199999999999,27.6948,6.238099999999999,25.916);b.bezierCurveTo(6.977759999999999,
22.8525,10.9782,21.355600000000003,13.5926,23.0777);b.bezierCurveTo(16.2367,24.5635,16.8158,28.5402,14.700999999999999,30.7157);b.bezierCurveTo(13.0765,32.5841,9.983999999999998,32.9244,8.046799999999998,31.35111);b.bezierCurveTo(6.345499999999998,30.49017,4.781399999999998,32.36991,5.247899999999998,33.99511);b.bezierCurveTo(5.6933599999999975,35.63661,7.405999999999998,36.446009999999994,8.523899999999998,37.607409999999994);b.bezierCurveTo(11.447899999999997,39.966609999999996,15.017599999999998,
41.553509999999996,18.725899999999996,42.106109999999994);b.bezierCurveTo(20.864499999999996,42.111909999999995,20.015099999999997,39.665409999999994,19.113609999999994,38.67170999999999);b.bezierCurveTo(18.010609999999993,37.48170999999999,16.917609999999993,36.07570999999999,16.999609999999993,34.35270999999999);b.bezierCurveTo(16.946339999999992,31.659809999999986,19.304109999999994,29.299709999999987,21.999609999999993,29.352709999999988);b.fill();b.stroke();b.restore();b.save();b.transform(-1,
0,0,1,43.976714,0);b.translate(0,0);b.translate(0,0);b.save();b.fillStyle="rgba(0, 0, 0, 0)";b.strokeStyle="#ffffff";b.lineWidth=1;b.lineJoin="bevel";b.miterLimit=4;b.beginPath();b.moveTo(22,21.353);b.bezierCurveTo(17.118000000000002,21.461000000000002,12.599,17.481,12.08,12.627);b.bezierCurveTo(11.618,9.352,12.974,5.985,15.407,3.7827);b.bezierCurveTo(15.912,2.8436000000000003,18.523,1.27,16.749,0.5429000000000004);b.bezierCurveTo(13.985999999999999,0.3338200000000004,11.54,2.0017000000000005,9.3441,
3.4711000000000003);b.bezierCurveTo(3.0759999999999996,7.9451,-0.3846000000000007,15.9611,0.672699999999999,23.5921);b.bezierCurveTo(1.020719999999999,25.421999999999997,1.032369999999999,27.779799999999998,2.889699999999999,28.7941);b.bezierCurveTo(4.825599999999999,29.9509,6.368199999999999,27.6948,6.238099999999999,25.916);b.bezierCurveTo(6.977759999999999,22.8525,10.9782,21.355600000000003,13.5926,23.0777);b.bezierCurveTo(16.2367,24.5635,16.8158,28.5402,14.700999999999999,30.7157);b.bezierCurveTo(13.0765,
32.5841,9.983999999999998,32.9244,8.046799999999998,31.35111);b.bezierCurveTo(6.345499999999998,30.49017,4.781399999999998,32.36991,5.247899999999998,33.99511);b.bezierCurveTo(5.6933599999999975,35.63661,7.405999999999998,36.446009999999994,8.523899999999998,37.607409999999994);b.bezierCurveTo(11.447899999999997,39.966609999999996,15.017599999999998,41.553509999999996,18.725899999999996,42.106109999999994);b.bezierCurveTo(20.864499999999996,42.111909999999995,20.015099999999997,39.665409999999994,
19.113609999999994,38.67170999999999);b.bezierCurveTo(18.010609999999993,37.48170999999999,16.917609999999993,36.07570999999999,16.999609999999993,34.35270999999999);b.bezierCurveTo(16.946339999999992,31.659809999999986,19.304109999999994,29.299709999999987,21.999609999999993,29.352709999999988);b.fill();b.stroke();b.restore();b.restore();b.restore()}});
Ses.Entities.SpaceRock=Ses.Core.Entity.extend({init:function(b,c,a){this._super();var f=new Ses.b2FixtureDef;f.density=1;f.friction=0.5;f.friction=0.2;f.shape=new Ses.b2PolygonShape;f.filter.categoryBits=Ses.Physic.CATEGORY_WORLD;f.filter.maskBits=Ses.Physic.WORLD_MASK;var e=[];for(b=Ses.Physic.createDynamicBody(null,{x:b,y:c});;)try{e=3>a?this.createRandomConvexPolygon(a,0.6*a,16):this.createRandomConvexPolygon(a,0.75*a,18);Box2D.Common.Separator.Separate(b,f,e);break}catch(d){Box2D.Common.Separator.Validate(e)}this.body=
b;f.filter.categoryBits=Ses.Physic.CATEGORY_WORLD;this.initShape(e);this.body.SetUserData({hookAble:!0});a*=Ses.Engine.Scale;switch(Ses.Engine.Graphics){case "low":this.shape.cache(-a,-a,2*a,2*a)}},initShape:function(b){var c=this.body.GetLocalCenter(),a=function(a){return{x:(a.x-c.x)*Ses.Engine.Scale,y:(a.y-c.y)*Ses.Engine.Scale}},f=new createjs.Graphics;f.beginStroke("#FFFFFF");var e=a(b[0]);f.moveTo(e.x,e.y);for(var d=1;d<b.length;++d)e=a(b[d]),f.lineTo(e.x,e.y);f.closePath();f.endStroke();this.shape=
new createjs.Shape(f)},update:function(){this._super()},createRandomConvexPolygon:function(b,c,a){for(var f=2*Math.PI/a,e=[],d=0;d<a;++d){for(var g=d*f+f/3,h=(d+1)*f-f/3,k,l;;){k=Math.random()*b;k*=0.5<Math.random()?1:-1;l=Math.random()*b;l*=0.5<Math.random()?1:-1;var r=Math.sqrt(k*k+l*l);if(!(r<c||r>b))if(r=Math.atan2(l,k),g<Math.PI){if(r>g&&r<h)break}else{var s=-Math.PI+(g-Math.PI),x=s+f;if(r>s&&r<x)break}}e.push(new Ses.b2Vec2(k,l))}return e}});
Ses.Entities.SpaceShipWithDistanceStick=Ses.Core.Entity.extend({init:function(b){this.ship=b;this.shape=new createjs.Container;this.body=this.ship.body;this.graspers=[];var c=new createjs.Shape;this.background=c.graphics;this.shape.addChild(c);this.shape.addChild(b.shape)},update:function(b){this.ship.update(b);if(0<this.graspers.length){this.background.clear();for(var c=0;c<this.graspers.length;++c){var a=this.graspers[c];if(a.outOfRange)this.graspers.splice(c,1),b.removeGameObject(a);else{var f=
a.body.GetWorldCenter(),e=this.ship.body.GetWorldCenter();this.background.setStrokeStyle(1).beginStroke("#0096ff").moveTo(30*e.x,30*e.y).lineTo(30*f.x,30*f.y);a.update(b)}}}if(b.RemoveGraspers){for(c=0;c<this.graspers.length;++c)this.graspers[c].detach(),b.removeGameObject(this.graspers[c]);this.graspers=[];this.background.clear()}if(b.FireGrasper&&!(this.onCooldown||2===this.graspers.length)){c=b.getStage().mouseX;a=b.getStage().mouseY;a=b.getStage().localToLocal(c,a,b);c=a.x/Ses.Engine.Scale;a=
a.y/Ses.Engine.Scale;c-=this.ship.body.GetWorldCenter().x;a-=this.ship.body.GetWorldCenter().y;c=new Ses.Entities.StingGrasper(this.ship,new Ses.b2Vec2(c,a));this.graspers.push(c);b.addGameObject(c);var d=this;d.onCooldown=!0;setTimeout(function(){d.onCooldown=!1},600)}},setOnDieListener:function(b){this.ship.setOnDieListener(b)},watch:function(){this.ship.watch.apply(this.ship,arguments)},getLifeInPrecetage:function(){return this.ship.getLifeInPrecetage()}});
Ses.Entities.Grasper=Ses.Core.Entity.extend({init:function(b){var c=b.GetWorldCenter();this.body=Ses.Physic.createCircleObject(0.3,{x:c.x,y:c.y});c=Ses.Physic.createCircleObject(0.2,{x:c.x,y:c.y});Ses.Physic.createRevoluteJoint(c,this.body,new Ses.b2Vec2(0,0),new Ses.b2Vec2(0,0));Ses.Physic.createRevoluteJoint(b,c,new Ses.b2Vec2(0,0.25),new Ses.b2Vec2(0,-0.5));var a=this;Ses.Physic.addOnBeginContactListener(this.body,function(b){b.GetUserData()&&(b.GetUserData().hookAble&&!a.joint)&&(a.joint=Ses.Physic.createWeldJoint(a.body,
b,a.body.GetWorldCenter()))});this.initShape()},initShape:function(){var b=new createjs.Graphics;b.beginStroke("#ffffff");b.setStrokeStyle(1);b.drawCircle(0,0,9);this.shape=new createjs.Shape(b)},detach:function(){this.joint&&(Ses.log("remove joint"),Ses.Physic.removeJoint(this.joint),this.joint=null)}});
Ses.Entities.StingGrasper=Ses.Core.Entity.extend({init:function(b,c){this.ship=b;var a=b.body.GetWorldCenter().Copy();c.Normalize();c.Multiply(1.2);a.Add(c);this.body=Ses.Physic.createCircleObject(0.2,a,{filter:{maskBits:~Ses.Physic.CATEGORY_GRASPER,categoryBits:Ses.Physic.CATEGORY_GRASPER}});this.body.SetBullet(!0);c.Multiply(16);a=b.body.GetLinearVelocity().Copy();a.Add(c);this.body.SetLinearVelocity(a);var f=this;Ses.Physic.addOnBeginContactListener(this.body,function(a){a.GetUserData()&&a.GetUserData().hookAble&&
(f.attach=!0)});Ses.Physic.addOnPostSolveContactListener(this.body,function(a){f.attach&&(f.toObjectJoint=Ses.Physic.createRevoluteJoint2(f.body,a,f.body.GetWorldCenter()),f.toShipJoint=Ses.Physic.createWeldJoint(f.body,f.ship.getAnchor(),f.body.GetWorldCenter()),f.attach=!1,Ses.Physic.removeBodyListeners(f.body))});this.initShape()},initShape:function(){this.shape=new createjs.Shape;this.shape.graphics.beginStroke("#00ff00").drawCircle(0,0,0.1*Ses.Engine.Scale)},update:function(){this._super();if(!this.toShipJoint&&
!this.toObjectJoint){var b=this.ship.body.GetWorldCenter(),c=this.body.GetWorldCenter().Copy();c.Subtract(b);144<c.LengthSquared()&&(this.outOfRange=!0)}},detach:function(){this.toObjectJoint&&this.toShipJoint&&(Ses.Physic.World.DestroyJoint(this.toObjectJoint),Ses.Physic.World.DestroyJoint(this.toShipJoint))}});
Ses.Entities.Sensor=Ses.Core.Entity.extend({setOnObjectLeaveListener:function(b){if(!this.body)throw Error("Sensor doesn't have body");Ses.Physic.addOnEndContactListener(this.body,b)},setOnObjectEnterListener:function(b){if(!this.body)throw Error("Sensor doesn't have body");Ses.Physic.addOnBeginContactListener(this.body,b)}});
Ses.Entities.CircleSensor=Ses.Entities.Sensor.extend({init:function(b,c,a){this.radious=a;this.body=Ses.Physic.createCircleSesnor(b,c,a,{filter:{maskBits:Ses.Physic.SENSOR_MASK,categoryBits:Ses.Physic.CATEGORY_SENSOR}});var f=new createjs.Graphics;f.setStrokeStyle(1);f.beginStroke("#ffff00");f.drawCircle(0,0,a*Ses.Engine.Scale);this.shape=new createjs.Shape(f);this.shape.x=b;this.shape.y=c;createjs.Tween.get(this.shape,{loop:!0}).to({scaleX:0.95,scaleY:0.95},300,createjs.Ease.linear).to({scaleX:1,
scaleY:1},300,createjs.Ease.linear);switch(Ses.Engine.Graphics){case "high":this.shape.shadow=new createjs.Shadow("#ffff00",0,0,8)}},fadeOut:function(b){this.alive=!1;createjs.Tween.removeTweens(this.shape);createjs.Tween.get(this.shape,{loop:!1}).to({alpha:0,scaleX:2,scaleY:2},300,createjs.Ease.linear).call(b)},notCheckpoint:function(){this.shape.graphics.clear().s("#ffa800").dc(0,0,this.radious*Ses.Engine.Scale);var b=this;this.setOnObjectEnterListener(function(){b.fadeOut(function(){b.shape.getStage().removeGameObject(b)})})}});
Ses.Entities.RectangleSensor=Ses.Entities.Sensor.extend({Texts:["Dock area. Place here broken ships.","Come closer ...","Good. Dock in ","Broken ship are safety now."],currentText:0,docked:!1,trackColor:"rgba(0, 255, 0, 0.5)",init:function(b,c,a,f){this.body=Ses.Physic.createRectangleSesnor(b,c,a,f,{filter:{maskBits:Ses.Physic.CATEGORY_BROKEN_SHIP}});b=new createjs.Graphics;b.beginFill("rgba(0,255,0,0.1)");b.beginStroke("rgba(0,255,0,0.51)");a=2*a*Ses.Engine.Scale;f=2*f*Ses.Engine.Scale;b.rect(-a/
2,-f/2,a,f);b=new createjs.Shape(b);this.shape=new createjs.Container;this.shape.addChild(b);this.text=new createjs.Text(this.Texts[this.currentText],"12px TitilliumText25L400wt","#00ff00");this.text.x=-a/2;this.text.y=-f/2-this.text.getMeasuredHeight()-2;this.text.cache(0,0,a+10,50,3);this.shape.addChild(this.text)},update:function(b){this._super();this.docking?(b=this.docking.GetWorldCenter().Copy(),b.Subtract(this.body.GetWorldCenter()),b=b.Length(),2<b?(this.stopCounting(),this.setText(1)):this.startCounting()):
this.docked?this.setText(3):this.setText(0)},setText:function(b){this.currentText!==b&&(this.text.text=this.Texts[b],this.currentText=b,this.text.updateCache())},startCounting:function(){this.start||(this.start=(new Date).getTime());this.elapsed=(new Date).getTime()-this.start;this.elapsed/=1E3;this.text.text=this.Texts[2]+(5-this.elapsed).toFixed(2);this.text.updateCache();this.currentText=2;5<this.elapsed&&(this.docked=!0,this.docking=null)},stopCounting:function(){this.start=null}});
Ses.Entities.JetExhaustParticle=Ses.Core.Entity.extend({init:function(b,c,a){this.body=Ses.Physic.createCircleObject(a,{x:b,y:c},{density:0.1,filter:{maskBits:Ses.Physic.JET_PARTICLE_MASK,categoryBits:Ses.Physic.CATEGORY_JET_PARTICLE}});this.body.SetBullet(!0);b=new createjs.Graphics;b.beginStroke("#0096ff");b.setStrokeStyle(1);b.drawCircle(0,0,a*Ses.Engine.Scale);this.shape=new createjs.Shape(b);switch(Ses.Engine.Graphics){case "high":this.shape.shadow=new createjs.Shadow("#0096ff",0,0,8)}},startFading:function(b){var c=
this;c.alive=!1;createjs.Tween.get(this.shape,{loop:!1}).to({alpha:1},0,createjs.Ease.linear).to({alpha:0},b,createjs.Ease.linear).call(function(){c.alive=!0;c.body.SetActive(!1);c.shape.visible=!1})}});
Ses.Entities.BrokenShip=Ses.Core.Entity.extend({init:function(b,c){this.currentHitPoints=30;this.body=Ses.Physic.createRectangleObject(66/Ses.Engine.Scale/2,113/Ses.Engine.Scale/2,{x:b,y:c},{filter:{categoryBits:Ses.Physic.CATEGORY_WORLD&&Ses.Physic.CATEGORY_BROKEN_SHIP,maskBits:Ses.Physic.WORLD_MASK}});var a=new createjs.Shape;a.graphics.beginFill("#FF0000").rect(0,0,75,100);var f=a.draw;a.draw=this.getCustomDrawFunction(-33,-56.5);this.shape=a;this.body.SetUserData({hookAble:!0,BrokenShip:!0});
this.setKillable();switch(Ses.Engine.Graphics){case "low":case "medium":this.shape.cache(-33,-56.5,66,113,1),a.draw=f}},draw:function(b){b.save();b.beginPath();b.moveTo(0,0);b.lineTo(66.161,0);b.lineTo(66.161,113.06);b.lineTo(0,113.06);b.closePath();b.clip();b.strokeStyle="rgba(0,0,0,0)";b.lineCap="butt";b.lineJoin="miter";b.miterLimit=4;b.save();b.restore();b.save();b.fillStyle="rgba(0, 0, 0, 0)";b.strokeStyle="#ffffff";b.translate(0.14570164,-0.28014181);b.save();b.lineWidth=1;b.beginPath();b.moveTo(33.938,
0.84934);b.bezierCurveTo(12.542000000000002,-0.60006,-5.1739999999999995,22.693340000000003,1.951000000000004,42.923339999999996);b.bezierCurveTo(4.6185000000000045,54.51434,16.139000000000003,61.866339999999994,25.500000000000004,65.73133999999999);b.bezierCurveTo(25.507300000000004,67.34593999999998,25.956500000000002,69.21083999999999,23.924000000000003,69.67053999999999);b.bezierCurveTo(21.116000000000003,71.35553999999999,18.308000000000003,73.04054,15.500000000000004,74.72453999999999);b.bezierCurveTo(15.241000000000003,
70.47554,16.642000000000003,65.16654,12.608000000000004,62.25453999999999);b.bezierCurveTo(8.286400000000004,58.91153999999999,0.7440000000000033,61.643539999999994,0.5430000000000046,67.41054);b.bezierCurveTo(0.4430400000000046,82.71154,0.5283300000000046,98.01653999999999,0.4999700000000046,113.32054);b.bezierCurveTo(0.04649000000000458,107.74054,6.676670000000005,104.10054,11.400970000000004,106.55054);b.bezierCurveTo(14.210970000000005,107.04223999999999,15.733070000000005,112.29834,15.499770000000005,
112.79303999999999);b.lineTo(15.499770000000005,80.56804);b.bezierCurveTo(18.833070000000006,78.56804,22.166470000000004,76.56804,25.499770000000005,74.56804);b.bezierCurveTo(25.587060000000005,79.08633999999999,25.316480000000006,83.63083999999999,25.651620000000005,88.13104);b.bezierCurveTo(27.293920000000004,94.98913999999999,38.70562,94.98913999999999,40.347620000000006,88.13104);b.bezierCurveTo(40.67985000000001,83.65124,40.414190000000005,79.12804,40.49947000000001,74.63004);b.bezierCurveTo(43.83277000000001,
76.63004,47.16617000000001,78.63004,50.49947000000001,80.63004);b.lineTo(50.49947000000001,113.31804);b.bezierCurveTo(50.04599000000001,107.74444,56.67617000000001,104.09754,61.40047000000001,106.55044);b.bezierCurveTo(64.21047000000002,107.04213999999999,65.73257000000001,112.29823999999999,65.49927000000001,112.79293999999999);b.bezierCurveTo(65.47027000000001,97.66893999999999,65.55627000000001,82.53893999999998,65.45627,67.41293999999999);b.bezierCurveTo(65.24827,61.051939999999995,56.29227,58.60493999999999,
52.33827,63.19393999999999);b.bezierCurveTo(49.547270000000005,66.42594,50.773270000000004,70.89793999999999,50.49927,74.78993999999999);b.bezierCurveTo(47.16597,72.78993999999999,43.832570000000004,70.78993999999999,40.49927,68.78993999999999);b.bezierCurveTo(40.81219,66.65033999999999,39.183370000000004,63.05303999999999,43.618770000000005,64.00823999999999);b.bezierCurveTo(63.359770000000005,57.97623999999999,72.11277000000001,31.576239999999984,59.81177000000001,14.97323999999999);b.bezierCurveTo(54.07977000000001,
6.489539999999989,44.172770000000014,1.0832399999999893,33.93677000000001,0.8522399999999895);b.closePath();b.fill();b.stroke();b.restore();b.save();b.lineWidth=1.0808545351028442;b.lineJoin="round";b.miterLimit=4;b.beginPath();b.moveTo(47.023,32.362);b.bezierCurveTo(47.38241,41.623000000000005,37.095400000000005,48.979,28.448000000000004,45.645);b.bezierCurveTo(19.886300000000006,43.0642,16.082000000000004,31.628000000000004,21.400700000000004,24.436000000000003);b.bezierCurveTo(26.333200000000005,
16.589600000000004,38.97670000000001,16.326600000000003,44.231700000000004,23.961130000000004);b.bezierCurveTo(46.0352,26.364030000000003,47.029700000000005,29.357930000000003,47.02310000000001,32.36193);b.closePath();b.fill();b.stroke();b.restore();b.restore();b.restore()}});
Ses.Entities.TextField=Class.extend({init:function(b,c,a){this.shape=new createjs.Text(a,"16px TitilliumText25L400wt","rgba(255,255,255,0.5)");this.shape.lineWidth=300;this.shape.cache(0,0,this.shape.getMeasuredWidth()+10,this.shape.getMeasuredHeight()+10,3);this.shape.x=b*Ses.Engine.Scale;this.shape.y=c*Ses.Engine.Scale}});
Ses.Engine.Factory={factoryMethod:{SpaceRock:function(b){var c=new Ses.Entities.SpaceRock(b.x,b.y,b.width/2);if(b.fx||b.fy){var a=parseFloat(b.fx)||0;b=parseFloat(b.fy)||0;c.body.SetLinearVelocity(new Ses.b2Vec2(a,b))}return c},SpaceShip:function(b){return new Ses.Entities.SpaceShip(b.x,b.y)},SpaceShipWithRope:function(b){return new Ses.Entities.SpaceShipWithRope(this.SpaceShip(b))},SpaceShipWithDistanceStick:function(b){return new Ses.Entities.SpaceShipWithDistanceStick(this.SpaceShip(b))},CircleSensor:function(b){var c=
new Ses.Entities.CircleSensor(b.x,b.y,b.width/2);void 0===b.O_MoveThrough&&(c.notCheckpoint(),b.SC_DeadFor2Stars=!0);return c},RectangleSensor:function(b){return new Ses.Entities.RectangleSensor(b.x,b.y,b.width/2,b.height/2)},BrokenShip:function(b){return new Ses.Entities.BrokenShip(b.x,b.y)},TextField:function(b){return new Ses.Entities.TextField(b.x,b.y,b.text)}},createObject:function(b){var c=this.factoryMethod[b.type](b),a=/O_.*/,f=/SC_.*/,e;for(e in b)a.test(e)&&this.gameView.addMapObjective(e,
c),f.test(e)&&this.gameView.addScoreCondition(e,c);return c}};
Ses.Ui.ArmourBars=Class.extend({init:function(b,c){this.width=b||100;this.height=c||30;this.barWidth=this.width/2;this.barHeigth=this.height/2;this.shape=new createjs.Container;this.shipBar=new createjs.Shape;this.targetBar=new createjs.Shape;this.shipText=new createjs.Text("Ship Armour",this.barHeigth+"px TitilliumText25L400wt","#ffffff");this.targetText=new createjs.Text("",this.barHeigth+"px TitilliumText25L400wt","#ffffff");this.setTargetText("Target Armour");this.targetBar.visible=!1;this.targetText.visible=
!1;this.shape.addChild(this.shipText);this.shape.addChild(this.shipBar);this.shipBar.y=this.barHeigth;this.shape.addChild(this.targetBar);this.targetBar.x=this.barWidth;this.targetBar.y=this.barHeigth;this.shape.addChild(this.targetText)},drawBar:function(b,c,a,f){f.graphics.clear().beginFill(c).rect(0,0,this.barWidth,this.barHeigth).beginFill(b).rect(0,0,this.barWidth*a,this.barHeigth)},updateShipBar:function(b){this.shipBar.scaleX=this.targetBar.visible?1:2;this.drawBar("rgba(0, 153, 255, 0.2)",
"rgba(0, 153, 255, 0.1)",b,this.shipBar)},updateTargetBar:function(b){this.targetBar.visible=!0;this.targetText.visible=!0;this.shipBar.scaleX=1;this.drawBar("rgba(255, 153, 0, 0.2)","rgba(255, 153, 0, 0.1)",b,this.targetBar)},setShipText:function(b){this.shipText.text=b},setTargetText:function(b){this.targetText.text=b;b=this.targetText.getMeasuredWidth();this.targetText.x=this.width-b},hide:function(){this.shape.visible=!1}});
Ses.Menu=function(){var b=document.getElementById("main-menu"),c=document.getElementById("level-entries"),a=document.getElementById("game-end");document.getElementById("canvas");var f=document.getElementById("restart"),e=document.getElementById("graphics-quality"),d=document.getElementById("back-to-menu");e.innerHTML="graphics: high";e.type=2;e.onclick=function(){this.type=++this.type%3;switch(e.type){case 0:e.innerHTML="graphics: low";Ses.Engine.Graphics="low";break;case 1:e.innerHTML="graphics: medium";
Ses.Engine.Graphics="medium";break;case 2:e.innerHTML="graphics: high",Ses.Engine.Graphics="high"}};f.onclick=function(){a.style.display="none";Ses.Engine.restartMap()};d.onclick=function(){a.style.display="none";b.style.display="block"};return{addMap:function(a,d){var e=document.createElement("div");e.className="ui button";e.innerHTML=a;e.onclick=function(){b.style.display="none";d.call()};c.appendChild(e)},showGameOver:function(b,c){a.querySelector("h1").innerHTML="mission fail";a.querySelector("img").style.display=
"none";a.querySelector("p").innerHTML="";a.querySelector("#next-map").style.display="none";a.style.display="block";_gaq.push(["_trackEvent",b,"fail","time",c/1E3])},showGameWin:function(b,c,d){a.querySelector("h1").innerHTML="mission succes";var e=a.querySelector("img");e.src="img/stars"+d+".png";e.style.display="inline";var e=Math.floor(c/6E4),f=Math.floor((c-6E4*e)/1E3);a.querySelector("p").innerHTML="Time: "+(9<e?e:"0"+e)+":"+(9<f?f:"0"+f)+"."+c%1E3;e=a.querySelector("#next-map");e.onclick=function(){a.style.display=
"none";Ses.Engine.nextMap()};e.style.display="block";a.style.display="block";_gaq.push(["_trackEvent",b,"win","stars",d]);_gaq.push(["_trackEvent",b,"win","time",c/1E3])}}}();
